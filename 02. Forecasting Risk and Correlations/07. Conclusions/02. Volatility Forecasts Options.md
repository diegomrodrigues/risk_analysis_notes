## Conclus√µes: Modelos Hist√≥ricos vs. Impl√≠citos e Implica√ß√µes para o VAR

### Introdu√ß√£o
Em continuidade √† discuss√£o sobre modelagem de risco vari√°vel no tempo, este cap√≠tulo aprofunda a compara√ß√£o entre **modelos hist√≥ricos** e **modelos impl√≠citos** (derivados de pre√ßos de op√ß√µes), com √™nfase em suas aplica√ß√µes e limita√ß√µes na previs√£o de risco e no c√°lculo do *Value at Risk* (VAR). Como vimos anteriormente, modelos de s√©ries temporais como m√©dias m√≥veis, GARCH e EWMA adaptam-se √†s mudan√ßas nas condi√ß√µes de mercado com diferentes velocidades [^240]. No entanto, sua depend√™ncia de dados hist√≥ricos intr√≠nsecamente limita sua capacidade de antecipar mudan√ßas abruptas ou eventos sem precedentes [^240]. Exploraremos como a incorpora√ß√£o de informa√ß√µes prospectivas de mercados de op√ß√µes pode mitigar essas limita√ß√µes e melhorar a precis√£o das avalia√ß√µes de risco.

### Conceitos Fundamentais
A principal desvantagem dos modelos hist√≥ricos reside em sua natureza *reativa* [^240]. Eles tendem a reagir aos eventos *ap√≥s* sua ocorr√™ncia, o que pode levar a subestima√ß√µes do risco em per√≠odos de transi√ß√£o ou durante eventos extremos [^240]. Em contrapartida, **modelos baseados em dados de op√ß√µes** (especificamente, volatilidade impl√≠cita) incorporam as expectativas do mercado sobre a volatilidade *futura* do ativo subjacente [^237]. Isso permite uma resposta mais r√°pida e precisa a mudan√ßas nas condi√ß√µes de mercado, especialmente durante per√≠odos de incerteza ou turbul√™ncia.

**Proposi√ß√£o 2:** *Modelos VAR que incorporam volatilidades impl√≠citas derivadas de pre√ßos de op√ß√µes tendem a apresentar maior precis√£o preditiva do que modelos baseados exclusivamente em dados hist√≥ricos, especialmente em cen√°rios de alta volatilidade ou transi√ß√µes de regime.*

*Prova:* A volatilidade impl√≠cita reflete o consenso do mercado sobre a volatilidade futura, incorporando informa√ß√µes que podem n√£o estar presentes em dados hist√≥ricos. Isso inclui expectativas sobre eventos futuros, mudan√ßas nas pol√≠ticas econ√¥micas e outros fatores que podem afetar a volatilidade. Ao incorporar essas expectativas, os modelos VAR podem fornecer uma avalia√ß√£o de risco mais precisa, capturando o potencial para grandes perdas com maior efic√°cia.

> üí° **Exemplo Num√©rico:** Suponha que uma empresa utilize um modelo VAR baseado em dados hist√≥ricos para gerenciar o risco de sua carteira de a√ß√µes. O modelo estima uma volatilidade anualizada de 15% para o √≠ndice S&P 500. No entanto, devido a um evento geopol√≠tico iminente, o mercado de op√ß√µes est√° precificando uma volatilidade impl√≠cita de 25% para op√ß√µes com vencimento em tr√™s meses. Se a empresa utilizar apenas a volatilidade hist√≥rica, seu modelo VAR subestimar√° o risco potencial, deixando-a vulner√°vel a perdas inesperadas se o evento geopol√≠tico causar uma queda significativa no mercado. Ao incorporar a volatilidade impl√≠cita, o modelo VAR refletir√° com mais precis√£o o risco aumentado e permitir√° que a empresa tome medidas apropriadas para proteger sua carteira.

A **volatilidade impl√≠cita (ISD - Implied Standard Deviation)** pode ser extra√≠da dos pre√ßos das op√ß√µes, invertendo a f√≥rmula de precifica√ß√£o de op√ß√µes (e.g., Black-Scholes) [^237]. Dado o pre√ßo de mercado de uma op√ß√£o, a data de vencimento, o pre√ßo de exerc√≠cio e outros par√¢metros observ√°veis, a ISD √© a volatilidade que, quando inserida na f√≥rmula, iguala o pre√ßo do modelo ao pre√ßo de mercado [^237]. A ISD representa, portanto, a *volatilidade esperada* pelo mercado durante a vida √∫til da op√ß√£o.

$$C_{market} = f(\sigma_{ISD})$$ [^237]

onde *f* representa a fun√ß√£o de precifica√ß√£o da op√ß√£o (e.g., Black-Scholes) e $C_{market}$ √© o pre√ßo de mercado da op√ß√£o.

> üí° **Exemplo Num√©rico:** Considere uma op√ß√£o de compra (call) sobre uma a√ß√£o com as seguintes caracter√≠sticas:
> *   Pre√ßo de mercado da op√ß√£o ($C_{market}$): R\$5,00
> *   Pre√ßo de exerc√≠cio (K): R\$100,00
> *   Pre√ßo da a√ß√£o (S): R\$100,00
> *   Taxa de juros livre de risco (r): 5% ao ano
> *   Tempo at√© o vencimento (T): 0,5 anos (6 meses)
>
> Usando um solver num√©rico (e.g., no Excel ou Python) para inverter a f√≥rmula de Black-Scholes, encontramos que a volatilidade impl√≠cita ($\sigma_{ISD}$) que iguala o pre√ßo do modelo ao pre√ßo de mercado da op√ß√£o √© de aproximadamente 22% ao ano.
>
> ```python
> import scipy.stats as si
> import numpy as np
>
> def black_scholes_merton(S, K, T, r, sigma, option_type = 'call'):
>     d1 = (np.log(S / K) + (r + 0.5 * sigma ** 2) * T) / (sigma * np.sqrt(T))
>     d2 = d1 - sigma * np.sqrt(T)
>
>     if option_type == "call":
>         result = S * si.norm.cdf(d1) - K * np.exp(-r * T) * si.norm.cdf(d2)
>     elif option_type == "put":
>         result = K * np.exp(-r * T) * si.norm.cdf(-d2) - S * si.norm.cdf(-d1)
>     else:
>         raise ValueError("Option type not supported.")
>     return result
>
> def implied_volatility(C_market, S, K, T, r, option_type = 'call', tol = 0.0001,
>                         max_iterations = 100):
>     sigma_low = 0.0001
>     sigma_high = 5
>     for i in range(max_iterations):
>         sigma_mid = (sigma_low + sigma_high) / 2
>         C_model = black_scholes_merton(S, K, T, r, sigma_mid, option_type)
>         diff = C_market - C_model
>         if abs(diff) < tol:
>             return sigma_mid
>         elif diff > 0:
>             sigma_low = sigma_mid
>         else:
>             sigma_high = sigma_mid
>     return None
>
> # Example values
> C_market = 5.00
> S = 100.00
> K = 100.00
> r = 0.05
> T = 0.5
>
> # Calculate implied volatility
> implied_vol = implied_volatility(C_market, S, K, T, r)
> print(f"Implied Volatility: {implied_vol:.4f}")
> ```
>
> A interpreta√ß√£o √© que o mercado est√° precificando uma volatilidade de 22% para a a√ß√£o durante os pr√≥ximos 6 meses, com base no pre√ßo da op√ß√£o.

No entanto, as ISDs representam *distribui√ß√µes neutras ao risco* (RN - Risk Neutral), e n√£o distribui√ß√µes reais (ou f√≠sicas) [^238]. Uma corre√ß√£o sistem√°tica pode ser necess√°ria para compensar o pr√™mio de risco embutido nos pre√ßos das op√ß√µes [^238]. Ou seja, a volatilidade impl√≠cita pode ser *sistematicamente* mais alta do que a volatilidade realizada devido √† demanda dos investidores por prote√ß√£o contra riscos.

**Proposi√ß√£o 2.1:** *A diferen√ßa entre a volatilidade impl√≠cita e a volatilidade realizada pode ser utilizada como um indicador do pr√™mio de risco de volatilidade.*

*Prova:* A volatilidade impl√≠cita reflete a expectativa do mercado sobre a volatilidade futura, enquanto a volatilidade realizada reflete a volatilidade efetivamente observada. Se a volatilidade impl√≠cita √© consistentemente maior que a volatilidade realizada, isso sugere que os investidores est√£o dispostos a pagar um pr√™mio para se proteger contra a incerteza da volatilidade. A magnitude dessa diferen√ßa pode fornecer uma medida do pr√™mio de risco de volatilidade.

> üí° **Exemplo Num√©rico:** Suponha que a volatilidade impl√≠cita m√©dia do √≠ndice Ibovespa para op√ß√µes com vencimento em 30 dias seja de 25% ao ano. No entanto, a volatilidade realizada do Ibovespa nos √∫ltimos 30 dias foi de apenas 18% ao ano.
>
> A diferen√ßa de 7% (25% - 18%) pode ser interpretada como uma estimativa do pr√™mio de risco de volatilidade que os investidores est√£o exigindo para se proteger contra potenciais flutua√ß√µes no mercado. Essa diferen√ßa pode variar ao longo do tempo, refletindo mudan√ßas no apetite por risco e nas expectativas do mercado.

A escolha entre modelos hist√≥ricos e modelos impl√≠citos depende dos seguintes fatores:

1.  **Horizonte de tempo:** Para horizontes de tempo curtos, as ISDs podem ser mais precisas devido √† sua natureza *forward-looking*. Para horizontes de tempo longos, modelos hist√≥ricos podem ser mais confi√°veis, especialmente se forem calibrados com dados suficientes para capturar regimes de volatilidade diferentes.
2.  **Disponibilidade e liquidez dos mercados de op√ß√µes:** A precis√£o dos modelos impl√≠citos depende da disponibilidade e liquidez dos mercados de op√ß√µes. Se as op√ß√µes n√£o forem negociadas ativamente ou se houver pouca liquidez, as ISDs podem n√£o refletir com precis√£o as expectativas do mercado.
3.  **Presen√ßa de pr√™mios de risco:** A presen√ßa de pr√™mios de risco nos pre√ßos das op√ß√µes pode distorcer as ISDs, levando a sobreestima√ß√µes do risco. A aplica√ß√£o de corre√ß√µes para esses pr√™mios pode melhorar a precis√£o dos modelos impl√≠citos.

**Lema 2:** *Modelos que combinam dados hist√≥ricos com volatilidades impl√≠citas (modelos h√≠bridos) podem oferecer melhor desempenho preditivo do que modelos baseados em uma √∫nica fonte de informa√ß√£o.*

*Prova:*
I. Modelos hist√≥ricos capturam tend√™ncias passadas e padr√µes estat√≠sticos baseados em dados observados.
II. Volatilidades impl√≠citas incorporam as expectativas do mercado sobre a volatilidade futura, refletindo informa√ß√µes que os dados hist√≥ricos podem n√£o conter (e.g., eventos futuros esperados).
III. Ao combinar essas duas fontes de informa√ß√£o, o modelo pode se beneficiar tanto das tend√™ncias hist√≥ricas quanto das expectativas futuras.
IV. Um modelo h√≠brido pode, portanto, ajustar suas previs√µes com base nas expectativas do mercado (via volatilidade impl√≠cita), ao mesmo tempo em que permanece ancorado nas tend√™ncias hist√≥ricas (via dados hist√≥ricos).
V. Isso resulta em uma previs√£o mais precisa e robusta, especialmente em cen√°rios de mudan√ßa de regime ou eventos inesperados.
VI. Portanto, modelos h√≠bridos podem oferecer um melhor desempenho preditivo do que modelos baseados em uma √∫nica fonte de informa√ß√£o. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere um modelo h√≠brido que pondera a volatilidade prevista por um modelo GARCH(1,1) com a volatilidade impl√≠cita extra√≠da de op√ß√µes ATM sobre o √≠ndice Bovespa.
>
> Seja $\sigma_{GARCH, t+1}$ a previs√£o de volatilidade para o dia *t+1* gerada pelo modelo GARCH(1,1) e $\sigma_{ISD, t}$ a volatilidade impl√≠cita observada no dia *t* para op√ß√µes com vencimento em um m√™s. O modelo h√≠brido combina essas duas previs√µes usando um fator de pondera√ß√£o $\lambda$:
>
> $\sigma_{Hibrido, t+1} = \lambda \cdot \sigma_{GARCH, t+1} + (1 - \lambda) \cdot \sigma_{ISD, t}$
>
> Onde $\lambda$ varia entre 0 e 1. Se $\lambda = 0$, o modelo h√≠brido usa apenas a volatilidade impl√≠cita. Se $\lambda = 1$, o modelo h√≠brido usa apenas a previs√£o do GARCH(1,1). Um valor de $\lambda = 0.5$ atribui pesos iguais a ambas as fontes de informa√ß√£o.
>
> A escolha do valor de $\lambda$ pode ser otimizada por meio de backtesting, comparando o desempenho do modelo h√≠brido com diferentes valores de $\lambda$ em dados hist√≥ricos. Por exemplo, podemos avaliar o erro quadr√°tico m√©dio (MSE) das previs√µes do modelo h√≠brido em rela√ß√£o √† volatilidade realizada e escolher o valor de $\lambda$ que minimiza o MSE.

**Lema 2.1:** *A pondera√ß√£o √≥tima entre dados hist√≥ricos e volatilidades impl√≠citas em um modelo h√≠brido pode ser determinada por retroteste (backtesting) e otimiza√ß√£o do desempenho preditivo em diferentes cen√°rios de mercado.*

*Prova:*
I. A pondera√ß√£o entre dados hist√≥ricos e volatilidades impl√≠citas determina a import√¢ncia relativa de cada fonte de informa√ß√£o na previs√£o do modelo.
II. Diferentes pondera√ß√µes podem levar a diferentes desempenhos preditivos em diferentes cen√°rios de mercado, dependendo da relev√¢ncia das informa√ß√µes hist√≥ricas e das expectativas do mercado em cada cen√°rio.
III. O retroteste envolve a avalia√ß√£o do desempenho do modelo em dados hist√≥ricos, usando diferentes pondera√ß√µes entre dados hist√≥ricos e volatilidades impl√≠citas.
IV. A otimiza√ß√£o envolve a busca pela pondera√ß√£o que maximiza o desempenho preditivo do modelo em um conjunto de dados espec√≠fico, usando m√©tricas como erro quadr√°tico m√©dio ou *likelihood*.
V. Ao realizar o retroteste e a otimiza√ß√£o em diferentes cen√°rios de mercado, √© poss√≠vel identificar a pondera√ß√£o √≥tima que oferece o melhor desempenho preditivo em geral.
VI. Portanto, a pondera√ß√£o √≥tima entre dados hist√≥ricos e volatilidades impl√≠citas em um modelo h√≠brido pode ser determinada por retroteste e otimiza√ß√£o do desempenho preditivo em diferentes cen√°rios de mercado. ‚ñ†

**Teorema 3:** *Em mercados eficientes, a volatilidade impl√≠cita (ISD) deve fornecer a melhor estimativa da volatilidade futura, uma vez que os pre√ßos das op√ß√µes refletem o consenso do mercado sobre a volatilidade.* [^238]

*Prova (por contradi√ß√£o):*
I. Suponha que um modelo alternativo (e.g., um modelo hist√≥rico) possa prever a volatilidade futura com maior precis√£o do que a ISD.
II. Os traders poderiam explorar essa vantagem comprando ou vendendo op√ß√µes com base na diferen√ßa entre a previs√£o do modelo alternativo e a ISD.
III. Essa atividade de *arbitragem* exerceria press√£o sobre os pre√ßos das op√ß√µes, levando a ISD a convergir para a previs√£o do modelo alternativo.
IV. No equil√≠brio, a ISD refletiria a melhor estimativa da volatilidade futura, tornando a suposi√ß√£o inicial falsa.
V. Portanto, em mercados eficientes, a ISD deve fornecer a melhor estimativa da volatilidade futura.

No entanto, √© importante notar que a efici√™ncia do mercado √© uma simplifica√ß√£o, e pode n√£o se sustentar em todos os momentos.

> üí° **Exemplo Num√©rico:** Suponha que um analista acredite que um modelo GARCH(1,1) pode prever a volatilidade do √≠ndice S&P 500 com mais precis√£o do que a volatilidade impl√≠cita das op√ß√µes. Se o modelo GARCH prev√™ uma volatilidade de 15%, enquanto a volatilidade impl√≠cita das op√ß√µes ATM com vencimento em um m√™s √© de 20%, o analista poderia vender op√ß√µes e simultaneamente comprar o √≠ndice para se proteger contra movimentos adversos. Se a volatilidade realizada for de fato menor que 20%, o analista lucrar√° com a diferen√ßa. No entanto, essa atividade de arbitragem pressionar√° os pre√ßos das op√ß√µes, diminuindo a volatilidade impl√≠cita at√© que ela se alinhe mais estreitamente com a previs√£o do modelo GARCH. Em um mercado eficiente, essa arbitragem eliminaria a diferen√ßa entre a volatilidade impl√≠cita e a previs√£o do modelo alternativo.

**Teorema 4:** *A utiliza√ß√£o da *smile* ou *skew* da volatilidade impl√≠cita, em vez de apenas a volatilidade impl√≠cita at-the-money, pode melhorar a precis√£o da modelagem de risco, especialmente para eventos extremos.*

*Prova:*
I. A volatilidade impl√≠cita *at-the-money* (ATM) fornece uma estimativa da volatilidade esperada no pre√ßo de exerc√≠cio atual do ativo.
II. A *smile* ou *skew* da volatilidade impl√≠cita descreve como a volatilidade impl√≠cita varia para diferentes pre√ßos de exerc√≠cio (strike prices).
III. A assimetria (skew) indica a inclina√ß√£o da distribui√ß√£o de probabilidade impl√≠cita, sugerindo se o mercado precifica um risco maior de quedas (downside risk) ou de altas (upside risk).
IV. A curvatura (smile) indica o grau de caudas grossas (fat tails) da distribui√ß√£o, sugerindo a probabilidade de eventos extremos.
V. Ao usar essas informa√ß√µes, √© poss√≠vel capturar nuances na avalia√ß√£o de risco que n√£o s√£o aparentes ao usar apenas a volatilidade impl√≠cita ATM.
VI. Modelar a distribui√ß√£o de probabilidade de forma mais precisa, especialmente nas caudas, melhora a precis√£o da modelagem de risco para eventos extremos.
VII. Portanto, a utiliza√ß√£o da *smile* ou *skew* da volatilidade impl√≠cita, em vez de apenas a volatilidade impl√≠cita *at-the-money*, pode melhorar a precis√£o da modelagem de risco, especialmente para eventos extremos. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere o seguinte cen√°rio para op√ß√µes sobre o √≠ndice Ibovespa:
>
> *   Volatilidade impl√≠cita ATM (pre√ßo de exerc√≠cio pr√≥ximo ao pre√ßo atual do Ibovespa): 20%
> *   Volatilidade impl√≠cita para op√ß√µes de venda (puts) com pre√ßo de exerc√≠cio 10% abaixo do pre√ßo atual: 25%
> *   Volatilidade impl√≠cita para op√ß√µes de compra (calls) com pre√ßo de exerc√≠cio 10% acima do pre√ßo atual: 18%
>
> Neste caso, a *skew* da volatilidade impl√≠cita √© negativa, indicando que as op√ß√µes de venda (puts) com pre√ßo de exerc√≠cio abaixo do pre√ßo atual t√™m volatilidade impl√≠cita mais alta do que as op√ß√µes de compra (calls) com pre√ßo de exerc√≠cio acima do pre√ßo atual. Isso sugere que o mercado est√° precificando um risco maior de queda (downside risk) do que de alta (upside risk) para o Ibovespa. Um modelo de risco que apenas utiliza a volatilidade impl√≠cita ATM de 20% n√£o capturaria essa assimetria e, portanto, subestimaria o risco de perdas significativas. Um modelo que incorpora a *skew* da volatilidade impl√≠cita forneceria uma avalia√ß√£o de risco mais precisa, refletindo a preocupa√ß√£o do mercado com potenciais quedas no Ibovespa.
>
>  ```mermaid
>   graph LR
>       A[Pre√ßo de Exerc√≠cio Baixo] --> B(Volatilidade Impl√≠cita Alta)
>       C[Pre√ßo de Exerc√≠cio ATM] --> D(Volatilidade Impl√≠cita M√©dia)
>       E[Pre√ßo de Exerc√≠cio Alto] --> F(Volatilidade Impl√≠cita Baixa)
>       style A fill:#f9f,stroke:#333,stroke-width:2px
>       style B fill:#ccf,stroke:#333,stroke-width:2px
>       style C fill:#f9f,stroke:#333,stroke-width:2px
>       style D fill:#ccf,stroke:#333,stroke-width:2px
>       style E fill:#f9f,stroke:#333,stroke-width:2px
>       style F fill:#ccf,stroke:#333,stroke-width:2px
>  ```

### Conclus√£o
A escolha entre modelos hist√≥ricos e modelos impl√≠citos para prever o risco e calcular o VAR depende das caracter√≠sticas espec√≠ficas do ativo, do horizonte de tempo e das condi√ß√µes de mercado. Modelos hist√≥ricos s√£o adequados para capturar tend√™ncias de longo prazo, enquanto modelos impl√≠citos s√£o mais eficazes na resposta a mudan√ßas de curto prazo e expectativas do mercado. Modelos h√≠bridos que combinam dados hist√≥ricos com informa√ß√µes impl√≠citas podem oferecer o melhor de ambos os mundos, fornecendo uma avalia√ß√£o de risco mais precisa e robusta. A decis√£o final deve ser baseada em uma an√°lise cuidadosa das vantagens e desvantagens de cada abordagem, bem como em uma compreens√£o profunda das caracter√≠sticas do mercado e dos objetivos da modelagem.
### Refer√™ncias
[^240]: p.240
[^237]: p.237
[^238]: p.238
<!-- END -->