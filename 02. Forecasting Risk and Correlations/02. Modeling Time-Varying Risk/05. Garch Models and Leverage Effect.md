## Modeling Time-Varying Risk

### Introdu√ß√£o

Em continuidade √† discuss√£o sobre a modelagem GARCH(1,1) e a sua estima√ß√£o, esta se√ß√£o aprofunda-se nas extens√µes do modelo para acomodar o efeito de alavancagem (*leverage effect*), onde grandes retornos negativos t√™m um impacto maior no risco do que retornos positivos de magnitude semelhante [^9]. Esta assimetria no impacto dos retornos √© uma caracter√≠stica comum em muitas s√©ries financeiras, particularmente em mercados de a√ß√µes.
![This plot demonstrates the impact of positive and negative shocks on volatility](./../images/positive_negative_shocks_volatility.png)
*This plot demonstrates the impact of positive and negative shocks on volatility*

### Conceitos Fundamentais

Como discutido anteriormente, o modelo GARCH(1,1) b√°sico assume que a vari√¢ncia condicional depende apenas da magnitude dos retornos passados (ao quadrado), e n√£o do seu sinal. No entanto, a evid√™ncia emp√≠rica sugere que, em muitos mercados, grandes retornos negativos tendem a aumentar a volatilidade mais do que retornos positivos de tamanho similar. Este fen√¥meno √© conhecido como *leverage effect* e tem sido amplamente documentado na literatura financeira.

> üí° **O Efeito Alavancagem:**
>
> O efeito alavancagem (leverage effect) √© um fen√¥meno observado em mercados financeiros, particularmente no mercado de a√ß√µes, onde grandes retornos negativos est√£o associados a um aumento maior na volatilidade do que retornos positivos de magnitude semelhante.
>
> Intuitivamente, isso pode ser explicado pela din√¢mica da alavancagem nas empresas. Uma queda no pre√ßo das a√ß√µes aumenta a rela√ß√£o d√≠vida/capital pr√≥prio (alavancagem), o que aumenta o risco percebido da empresa e, consequentemente, a volatilidade de suas a√ß√µes [^9]. Por outro lado, um aumento no pre√ßo das a√ß√µes diminui a alavancagem, o que tem um impacto menor no risco percebido e na volatilidade [^9].

Para capturar o efeito de alavancagem, o modelo GARCH pode ser adaptado utilizando termos separados para choques positivos e negativos [^9].

*Modelo GARCH Assim√©trico*:

Uma forma comum de estender o modelo GARCH(1,1) para acomodar o efeito de alavancagem √© introduzir termos separados para choques positivos e negativos:

$$
h_t = \alpha_0 + \alpha_1 r_{t-1}^2 + \gamma I_{t-1} r_{t-1}^2 + \beta h_{t-1}
$$

Onde:

*   $I_{t-1} = 1$ se $r_{t-1} < 0$ (choque negativo)
*   $I_{t-1} = 0$ se $r_{t-1} \geq 0$ (choque positivo)
*   $\gamma$ √© o coeficiente que captura o efeito de alavancagem. Se $\gamma > 0$, choques negativos aumentam a volatilidade mais do que choques positivos de mesma magnitude.

Este modelo √© frequentemente referido como o modelo **EGARCH (Exponential GARCH)** ou **TGARCH (Threshold GARCH)**. No caso do TGARCH, o modelo especifica que a volatilidade depende do sinal dos retornos defasados, enquanto o EGARCH utiliza uma especifica√ß√£o exponencial para garantir que a volatilidade permane√ßa positiva.

> üí° **EGARCH (Exponential GARCH):**
>
> $$
> \log(h_t) = \alpha_0 + \beta \log(h_{t-1}) + \gamma \frac{r_{t-1}}{\sqrt{h_{t-1}}} + \alpha \left[ \frac{|r_{t-1}|}{\sqrt{h_{t-1}}} - E\left(\frac{|r_{t-1}|}{\sqrt{h_{t-1}}}\right) \right]
> $$
>
> Onde $\gamma$ captura o efeito de alavancagem, $\alpha$ captura o tamanho do choque, e $\frac{r_{t-1}}{\sqrt{h_{t-1}}}$ √© o choque padronizado.

> üí° **TGARCH (Threshold GARCH):**
>
> $$
> h_t = \alpha_0 + \alpha_1 r_{t-1}^2 + \gamma I_{t-1} r_{t-1}^2 + \beta h_{t-1}
> $$
>
> Onde $I_{t-1} = 1$ se $r_{t-1} < 0$ (choque negativo) e $I_{t-1} = 0$ se $r_{t-1} \geq 0$ (choque positivo).

> üí° **Exemplo Num√©rico:**
>
> Vamos considerar um modelo TGARCH(1,1) com os seguintes par√¢metros:
>
> *   $\alpha_0 = 0.00001$
> *   $\alpha_1 = 0.1$
> *   $\gamma = 0.05$
> *   $\beta = 0.8$
>
> Suponha que a vari√¢ncia condicional do dia anterior ($h_{t-1}$) seja 0.0001 (1%) e vamos considerar dois cen√°rios:
>
> *   Cen√°rio 1: O retorno do dia anterior ($r_{t-1}$) √© -0.015 (-1.5%) (choque negativo).
> *   Cen√°rio 2: O retorno do dia anterior ($r_{t-1}$) √© 0.015 (1.5%) (choque positivo).
>
> **Cen√°rio 1 (Choque Negativo):**
>
> $h_t = 0.00001 + 0.1 * (-0.015)^2 + 0.05 * 1 * (-0.015)^2 + 0.8 * 0.0001$
>
> $h_t = 0.00001 + 0.0000225 + 0.00001125 + 0.00008 = 0.00012375$
>
> A volatilidade para o dia *t* √© $\sqrt{0.00012375} \approx 0.01112$ ou 1.112%.
>
> **Cen√°rio 2 (Choque Positivo):**
>
> $h_t = 0.00001 + 0.1 * (0.015)^2 + 0.05 * 0 * (0.015)^2 + 0.8 * 0.0001$
>
> $h_t = 0.00001 + 0.0000225 + 0 + 0.00008 = 0.0001125$
>
> A volatilidade para o dia *t* √© $\sqrt{0.0001125} \approx 0.01061$ ou 1.061%.
>
> Neste exemplo, um choque negativo resulta em uma volatilidade maior (1.112%) do que um choque positivo (1.061%), demonstrando o efeito de alavancagem capturado pelo modelo TGARCH.

> üí° **Exemplo Num√©rico:**
>
> Para ilustrar o EGARCH, considere os seguintes par√¢metros:
>
> *   $\alpha_0 = -0.1$
> *   $\beta = 0.9$
> *   $\gamma = -0.2$  (note o sinal negativo para indicar efeito de alavancagem)
> *   $\alpha = 0.1$
>
> Assuma que $\log(h_{t-1}) = -6$ (o que implica $h_{t-1} \approx 0.0025$). Considere tamb√©m que $E\left(\frac{|r_{t-1}|}{\sqrt{h_{t-1}}}\right) \approx 0.8$ (valor esperado da distribui√ß√£o normal).
>
> **Cen√°rio 1: Retorno negativo, $r_{t-1} = -0.02$**
>
> $\log(h_t) = -0.1 + 0.9(-6) - 0.2 \frac{-0.02}{\sqrt{0.0025}} + 0.1 \left[ \frac{|-0.02|}{\sqrt{0.0025}} - 0.8 \right]$
>
> $\log(h_t) = -0.1 - 5.4 + 0.2(0.4) + 0.1(0.4 - 0.8)$
>
> $\log(h_t) = -5.5 + 0.08 - 0.04 = -5.46$
>
> Assim, $h_t = e^{-5.46} \approx 0.00425$
>
> **Cen√°rio 2: Retorno positivo, $r_{t-1} = 0.02$**
>
> $\log(h_t) = -0.1 + 0.9(-6) - 0.2 \frac{0.02}{\sqrt{0.0025}} + 0.1 \left[ \frac{|0.02|}{\sqrt{0.0025}} - 0.8 \right]$
>
> $\log(h_t) = -0.1 - 5.4 - 0.2(0.4) + 0.1(0.4 - 0.8)$
>
> $\log(h_t) = -5.5 - 0.08 - 0.04 = -5.62$
>
> Assim, $h_t = e^{-5.62} \approx 0.00361$
>
> Observe que o retorno negativo leva a uma volatilidade maior ($0.00425$) do que o retorno positivo ($0.00361$), capturando o efeito alavancagem. O par√¢metro $\gamma < 0$ √© crucial para este resultado.

*Estimando um GARCH Assim√©trico:*

A estima√ß√£o de modelos GARCH assim√©tricos segue um processo semelhante ao do modelo GARCH(1,1) b√°sico, envolvendo a maximiza√ß√£o da fun√ß√£o de verossimilhan√ßa [^6]. No entanto, a fun√ß√£o de verossimilhan√ßa agora inclui o par√¢metro adicional $\gamma$, que deve ser estimado juntamente com os demais par√¢metros [^6].

> üí° **Fun√ß√£o de Verossimilhan√ßa para o Modelo GARCH Assim√©trico:**
>
> Assumindo que os res√≠duos escalonados $\epsilon_t = \frac{r_t}{\sqrt{h_t}}$ seguem uma distribui√ß√£o normal, a fun√ß√£o de log-verossimilhan√ßa condicional para o modelo GARCH assim√©trico √©:
>
> $$
> \mathcal{L}(\theta) = -\frac{T}{2}\log(2\pi) - \frac{1}{2}\sum_{t=1}^{T} \left(\log(h_t) + \frac{r_t^2}{h_t}\right)
> $$
>
> Onde $\theta = (\alpha_0, \alpha_1, \beta, \gamma)$ √© o vetor de par√¢metros a serem estimados, e $h_t$ √© a vari√¢ncia condicional no tempo *t*, definida pela Equa√ß√£o (9.6) [^5]:
>
> $$
> h_t = \alpha_0 + \alpha_1 r_{t-1}^2 + \gamma I_{t-1} r_{t-1}^2 + \beta h_{t-1}
> $$

**Prova da fun√ß√£o de log-verossimilhan√ßa condicional para o modelo GARCH assim√©trico:**

I.  Assumimos que os res√≠duos escalonados $\epsilon_t = \frac{r_t}{\sqrt{h_t}}$ seguem uma distribui√ß√£o normal padr√£o. Portanto, a fun√ß√£o de densidade de probabilidade (PDF) de $\epsilon_t$ √©:

    $$
    f(\epsilon_t) = \frac{1}{\sqrt{2\pi}} e^{-\frac{\epsilon_t^2}{2}}
    $$

II. Substitu√≠mos $\epsilon_t$ por $\frac{r_t}{\sqrt{h_t}}$ na PDF:

    $$
    f(r_t | h_t) = \frac{1}{\sqrt{2\pi h_t}} e^{-\frac{r_t^2}{2h_t}}
    $$

    Aqui, $f(r_t | h_t)$ √© a densidade condicional de $r_t$ dado $h_t$.

III. A fun√ß√£o de verossimilhan√ßa (Likelihood) para a amostra de tamanho $T$ √© o produto das densidades condicionais:

    $$
    L(\theta) = \prod_{t=1}^{T} f(r_t | h_t) = \prod_{t=1}^{T} \frac{1}{\sqrt{2\pi h_t}} e^{-\frac{r_t^2}{2h_t}}
    $$

IV. Tomamos o logaritmo da fun√ß√£o de verossimilhan√ßa para obter a fun√ß√£o de log-verossimilhan√ßa:

    $$
    \mathcal{L}(\theta) = \log(L(\theta)) = \sum_{t=1}^{T} \log\left(\frac{1}{\sqrt{2\pi h_t}} e^{-\frac{r_t^2}{2h_t}}\right)
    $$

V. Simplificamos a express√£o:

    $$
    \mathcal{L}(\theta) = \sum_{t=1}^{T} \left[ \log\left(\frac{1}{\sqrt{2\pi}}\right) - \frac{1}{2}\log(h_t) - \frac{r_t^2}{2h_t} \right]
    $$

VI. Expandimos a soma:

    $$
    \mathcal{L}(\theta) = \sum_{t=1}^{T} \log\left(\frac{1}{\sqrt{2\pi}}\right) - \frac{1}{2}\sum_{t=1}^{T} \log(h_t) - \frac{1}{2}\sum_{t=1}^{T} \frac{r_t^2}{h_t}
    $$

VII. Como $\sum_{t=1}^{T} \log\left(\frac{1}{\sqrt{2\pi}}\right) = T \log\left(\frac{1}{\sqrt{2\pi}}\right) = -\frac{T}{2}\log(2\pi)$, temos:

    $$
    \mathcal{L}(\theta) = -\frac{T}{2}\log(2\pi) - \frac{1}{2}\sum_{t=1}^{T} \left(\log(h_t) + \frac{r_t^2}{h_t}\right)
    $$

Portanto, a fun√ß√£o de log-verossimilhan√ßa condicional para o modelo GARCH assim√©trico √©:

$$
\mathcal{L}(\theta) = -\frac{T}{2}\log(2\pi) - \frac{1}{2}\sum_{t=1}^{T} \left(\log(h_t) + \frac{r_t^2}{h_t}\right)
$$

‚ñ†

> üí° **Exemplo Num√©rico:**
>
> Ilustrando a diferen√ßa no impacto do choque positivo e negativo no valor estimado.
>
> Suponha que os par√¢metros sejam estimados em 0.03, 0.1, 0.05, 0.8 e a volatilidade seja 0.001.
>
> *   Um choque de 0.01 positivo √© estimado em 0.03 + 0.1(0.01)^2 + 0.8(0.001) = 0.00081.
> *   Um choque de -0.01 √© estimado em 0.03 + 0.1(0.01)^2 + 0.05(0.01)^2+ 0.8(0.001) = 0.000815

> üí° **Fun√ß√£o de Visualiza√ß√£o no Python:**
>
> ```python
> import numpy as np
> import pandas as pd
> import yfinance as yf
> from arch import arch_model
> import matplotlib.pyplot as plt
>
> # Fun√ß√£o para calcular a volatilidade condicional GARCH assim√©trica
> def asymmetric_garch(returns, alpha0, alpha1, gamma, beta):
>     T = len(returns)
>     h = np.zeros(T)
>     h[0] = np.var(returns)  # Inicializa com a vari√¢ncia amostral
>     I = (returns < 0).astype(int)  # Indicador para retornos negativos
>
>     for t in range(1, T):
>         h[t] = alpha0 + alpha1 * returns[t-1]**2 + gamma * I[t-1] * returns[t-1]**2 + beta * h[t-1]
>
>     return h
>
> # Dados de exemplo (S&P 500)
> ticker = "^GSPC"
> start_date = "2020-01-01"
> end_date = "2024-01-01"
> data = yf.download(ticker, start=start_date, end=end_date)
> data['Returns'] = 100 * data['Adj Close'].pct_change().dropna()
> returns = data['Returns'].values
>
> # Par√¢metros estimados (ap√≥s otimiza√ß√£o)
> alpha0_hat = 0.01
> alpha1_hat = 0.08
> gamma_hat = 0.05
> beta_hat = 0.85
>
> # Calcula a volatilidade condicional
> h_hat = asymmetric_garch(returns, alpha0_hat, alpha1_hat, gamma_hat, beta_hat)
>
> # Plota a volatilidade condicional
> plt.figure(figsize=(12, 6))
> plt.plot(h_hat)
> plt.title('Volatilidade Condicional Estimada (GARCH Assim√©trico)')
> plt.xlabel('Tempo')
> plt.ylabel('Volatilidade')
> plt.show()
> ```
>
> Esta fun√ß√£o pode ser ajustada para calcular os TGARCH ou EGARCH.

> üí° **Exemplo Num√©rico:**
>
> Utilizando a fun√ß√£o Python acima e os dados do S&P 500, podemos estimar os par√¢metros do modelo TGARCH usando a biblioteca `arch` e comparar os resultados com a fun√ß√£o `asymmetric_garch`.
>
> ```python
> import numpy as np
> import pandas as pd
> import yfinance as yf
> from arch import arch_model
> import matplotlib.pyplot as plt
> from scipy.optimize import minimize
>
> # Fun√ß√£o para calcular a volatilidade condicional GARCH assim√©trica (TGARCH)
> def asymmetric_garch(returns, alpha0, alpha1, gamma, beta):
>     T = len(returns)
>     h = np.zeros(T)
>     h[0] = np.var(returns)  # Inicializa com a vari√¢ncia amostral
>     I = (returns < 0).astype(int)  # Indicador para retornos negativos
>
>     for t in range(1, T):
>         h[t] = alpha0 + alpha1 * returns[t-1]**2 + gamma * I[t-1] * returns[t-1]**2 + beta * h[t-1]
>
>     return h
>
> # Fun√ß√£o para calcular a log-verossimilhan√ßa negativa
> def negative_log_likelihood(params, returns):
>     alpha0, alpha1, gamma, beta = params
>     h = asymmetric_garch(returns, alpha0, alpha1, gamma, beta)
>     log_likelihood = -0.5 * (np.log(h[1:]) + (returns[1:]**2) / h[1:])
>     return -np.sum(log_likelihood)
>
> # Dados de exemplo (S&P 500)
> ticker = "^GSPC"
> start_date = "2020-01-01"
> end_date = "2024-01-01"
> data = yf.download(ticker, start=start_date, end=end_date)
> data['Returns'] = 100 * data['Adj Close'].pct_change().dropna()
> returns = data['Returns'].values
>
> # Otimiza√ß√£o dos par√¢metros
> initial_params = [0.01, 0.05, 0.05, 0.9]
> bounds = ((0, 1), (0, 1), (0, 1), (0, 1))
# Restri√ß√£o de n√£o negatividade e soma menor que 1 (opcional)
> constraints = ({'type': 'ineq', 'fun': lambda x: 1 - x[1] - x[2] - x[3]})
> result = minimize(negative_log_likelihood, initial_params, args=(returns,),
>                    bounds=bounds, constraints=constraints)
>
> alpha0_hat, alpha1_hat, gamma_hat, beta_hat = result.x
>
> print("Par√¢metros Estimados:")
> print(f"alpha0: {alpha0_hat:.6f}")
> print(f"alpha1: {alpha1_hat:.6f}")
> print(f"gamma: {gamma_hat:.6f}")
> print(f"beta: {beta_hat:.6f}")
>
> # Calcula a volatilidade condicional com os par√¢metros estimados
> h_hat = asymmetric_garch(returns, alpha0_hat, alpha1_hat, gamma_hat, beta_hat)
>
> # Plota a volatilidade condicional
> plt.figure(figsize=(12, 6))
> plt.plot(h_hat)
> plt.title('Volatilidade Condicional Estimada (TGARCH)')
> plt.xlabel('Tempo')
> plt.ylabel('Volatilidade')
> plt.show()
>
> # Usando a biblioteca arch
> am = arch_model(data['Returns'], vol="TGARCH", p=1, o=1, q=1)
> res = am.fit(disp="off")
> print(res.summary())
> ```
>
> Este c√≥digo demonstra como estimar os par√¢metros de um modelo TGARCH usando otimiza√ß√£o num√©rica e como usar a biblioteca `arch` para obter resultados similares. A compara√ß√£o dos resultados obtidos por ambos os m√©todos permite validar a implementa√ß√£o da fun√ß√£o `asymmetric_garch` e entender como as bibliotecas estat√≠sticas facilitam a modelagem de volatilidade.

Al√©m da distribui√ß√£o normal, outras distribui√ß√µes podem ser utilizadas para modelar os res√≠duos escalonados, como a distribui√ß√£o *t* de Student, que acomoda caudas mais pesadas e pode ser mais apropriada para dados financeiros [^7].

> üí° **Fun√ß√£o de Verossimilhan√ßa com Distribui√ß√£o *t* de Student:**
>
> Se assumirmos que os res√≠duos escalonados $\epsilon_t = \frac{r_t}{\sqrt{h_t}}$ seguem uma distribui√ß√£o *t* de Student com $\nu$ graus de liberdade, a fun√ß√£o de log-verossimilhan√ßa condicional para o modelo GARCH assim√©trico √© dada por:
>
> $$
> \mathcal{L}(\theta) = \sum_{t=1}^{T} \left[ \log\left(\frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)}\Gamma\left(\frac{\nu}{2}\right)}\right) - \frac{1}{2}\log(h_t) - \frac{\nu+1}{2}\log\left(1 + \frac{r_t^2}{h_t(\nu-2)}\right) \right]
> $$
>
> Onde $\theta = (\alpha_0, \alpha_1, \beta, \gamma, \nu)$ √© o vetor de par√¢metros a serem estimados, incluindo os graus de liberdade $\nu$, e $\Gamma(\cdot)$ √© a fun√ß√£o gama. Estimar $\nu$ permite que o modelo capture melhor a n√£o-normalidade dos dados [^7].

**Prova da fun√ß√£o de log-verossimilhan√ßa condicional com distribui√ß√£o *t* de Student:**

I. Assumimos que os res√≠duos escalonados $\epsilon_t = \frac{r_t}{\sqrt{h_t}}$ seguem uma distribui√ß√£o *t* de Student com $\nu$ graus de liberdade. A fun√ß√£o de densidade de probabilidade (PDF) da distribui√ß√£o *t* de Student √©:

    $$
    f(\epsilon_t; \nu) = \frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)}\Gamma\left(\frac{\nu}{2}\right)} \left(1 + \frac{\epsilon_t^2}{\nu-2}\right)^{-\frac{\nu+1}{2}}
    $$

    Onde $\Gamma(\cdot)$ √© a fun√ß√£o gama e $\nu > 2$.

II. Substitu√≠mos $\epsilon_t$ por $\frac{r_t}{\sqrt{h_t}}$ na PDF:

    $$
    f(r_t | h_t; \nu) = \frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)h_t}\Gamma\left(\frac{\nu}{2}\right)} \left(1 + \frac{r_t^2}{h_t(\nu-2)}\right)^{-\frac{\nu+1}{2}}
    $$

III. A fun√ß√£o de verossimilhan√ßa para a amostra de tamanho $T$ √© o produto das densidades condicionais:

    $$
    L(\theta) = \prod_{t=1}^{T} f(r_t | h_t; \nu) = \prod_{t=1}^{T} \frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)h_t}\Gamma\left(\frac{\nu}{2}\right)} \left(1 + \frac{r_t^2}{h_t(\nu-2)}\right)^{-\frac{\nu+1}{2}}
    $$

IV. Tomamos o logaritmo da fun√ß√£o de verossimilhan√ßa para obter a fun√ß√£o de log-verossimilhan√ßa:

    $$
    \mathcal{L}(\theta) = \log(L(\theta)) = \sum_{t=1}^{T} \log\left[ \frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)h_t}\Gamma\left(\frac{\nu}{2}\right)} \left(1 + \frac{r_t^2}{h_t(\nu-2)}\right)^{-\frac{\nu+1}{2}} \right]
    $$

V. Simplificamos a express√£o:

    $$
    \mathcal{L}(\theta) = \sum_{t=1}^{T} \left[ \log\left(\frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)}\Gamma\left(\frac{\nu}{2}\right)}\right) - \frac{1}{2}\log(h_t) - \frac{\nu+1}{2}\log\left(1 + \frac{r_t^2}{h_t(\nu-2)}\right) \right]
    $$

Portanto, a fun√ß√£o de log-verossimilhan√ßa condicional para o modelo GARCH assim√©trico com distribui√ß√£o *t* de Student √©:

$$
\mathcal{L}(\theta) = \sum_{t=1}^{T} \left[ \log\left(\frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi(\nu-2)}\Gamma\left(\frac{\nu}{2}\right)}\right) - \frac{1}{2}\log(h_t) - \frac{\nu+1}{2}\log\left(1 + \frac{r_t^2}{h_t(\nu-2)}\right) \right]
$$

‚ñ†

> üí° **Exemplo Num√©rico:**
>
> Para demonstrar o impacto da escolha da distribui√ß√£o dos res√≠duos, podemos comparar os resultados da estima√ß√£o de um modelo TGARCH com distribui√ß√£o normal e com distribui√ß√£o *t* de Student usando a biblioteca `arch`.
>
> ```python
> import numpy as np
> import pandas as pd
> import yfinance as yf
> from arch import arch_model
>
> # Dados de exemplo (S&P 500)
> ticker = "^GSPC"
> start_date = "2020-01-01"
> end_date = "2024-01-01"
> data = yf.download(ticker, start=start_date, end=end_date)
> data['Returns'] = 100 * data['Adj Close'].pct_change().dropna()
> returns = data['Returns'].values
>
> # Modelo TGARCH com distribui√ß√£o normal
> am_normal = arch_model(data['Returns'], vol="TGARCH", p=1, o=1, q=1, dist="normal")
> res_normal = am_normal.fit(disp="off")
> print("Resultados com distribui√ß√£o normal:")
> print(res_normal.summary())
>
> # Modelo TGARCH com distribui√ß√£o t de Student
> am_studentt = arch_model(data['Returns'], vol="TGARCH", p=1, o=1, q=1, dist="StudentsT")
> res_studentt = am_studentt.fit(disp="off")
> print("\nResultados com distribui√ß√£o t de Student:")
> print(res_studentt.summary())
>
> # Compara√ß√£o dos par√¢metros
> df_comparison = pd.DataFrame({
# 'Normal': res_normal.params,
# 'StudentT': res_studentt.params
> })
> print("\nCompara√ß√£o dos par√¢metros:")
> print(df_comparison)
> ```
>
> Este c√≥digo estima os par√¢metros do modelo TGARCH com ambas as distribui√ß√µes e imprime um resumo dos resultados, incluindo os valores dos par√¢metros estimados, seus erros padr√£o e os valores de log-verossimilhan√ßa. A compara√ß√£o dos resultados permite avaliar se a distribui√ß√£o *t* de Student oferece um melhor ajuste aos dados, o que pode ser indicado por um maior valor de log-verossimilhan√ßa e par√¢metros estimados mais precisos. A an√°lise dos res√≠duos dos modelos tamb√©m pode ajudar a determinar qual distribui√ß√£o √© mais apropriada.

A escolha da distribui√ß√£o dos res√≠duos escalonados pode impactar significativamente a estima√ß√£o dos par√¢metros e as previs√µes de volatilidade.

### Conclus√£o

A adapta√ß√£o do modelo GARCH para incorporar o efeito de alavancagem √© essencial para modelar com precis√£o a din√¢mica da volatilidade em mercados financeiros onde choques negativos t√™m um impacto maior no risco do que choques positivos [^9]. A inclus√£o de termos separados para choques positivos e negativos permite capturar esta assimetria e melhorar a precis√£o das previs√µes de risco e a gest√£o de portf√≥lio [^5]. A escolha entre modelos sim√©tricos e assim√©tricos deve ser baseada em testes de diagn√≥stico e na an√°lise das caracter√≠sticas espec√≠ficas da s√©rie temporal em quest√£o.

### Refer√™ncias
[^5]: Se√ß√£o 9.2.2 introduz a estima√ß√£o GARCH como uma alternativa aos modelos de m√©dias m√≥veis e descreve a Equa√ß√£o (9.2).
[^6]: Se√ß√£o 9.2.2 detalha o processo de estima√ß√£o de par√¢metros GARCH, incluindo a maximiza√ß√£o da fun√ß√£o de verossimilhan√ßa e a import√¢ncia da estacionariedade, e apresenta a Equa√ß√£o (9.3).
[^7]: Discuss√£o sobre a utiliza√ß√£o da distribui√ß√£o t de Student na modelagem de s√©ries financeiras.
[^9]: Se√ß√£o 9.2.3 menciona que modelos GARCH podem ser adaptados para acomodar o efeito de alavancagem usando termos separados para choques positivos e negativos.
<!-- END -->