O Modelo de Correla√ß√£o Condicional Constante (CCC)

### Introdu√ß√£o
Este cap√≠tulo explora o modelagem de risco e correla√ß√µes, com foco em **modelos GARCH multivariados** [^1]. Dando continuidade √† discuss√£o sobre a modelagem da din√¢mica temporal das vari√¢ncias e covari√¢ncias condicionais em sistemas financeiros, e tendo em vista as simplifica√ß√µes impostas para contornar o problema da dimensionalidade [^1, 2], esta se√ß√£o se concentra no Modelo de Correla√ß√£o Condicional Constante (CCC), uma abordagem que combina a modelagem individual das volatilidades com uma estrutura de correla√ß√£o fixa.

### Conceitos Fundamentais

O **Modelo de Correla√ß√£o Condicional Constante (CCC)**, introduzido por Bollerslev (1990), imp√µe correla√ß√µes fixas enquanto permite que as volatilidades variem ao longo do tempo [^2]. O modelo CCC combina a modelagem univariada de cada s√©rie individual com uma estrutura de correla√ß√£o fixa, simplificando significativamente o processo de estima√ß√£o e infer√™ncia [^2].
![Ilustra√ß√£o da estrutura do modelo CCC (Constant Conditional Correlation), mostrando como as volatilidades individuais s√£o modeladas com GARCH univariado e combinadas com uma matriz de correla√ß√£o constante para formar a matriz de covari√¢ncia condicional.](./../images/ccc_model_structure.png)

No modelo CCC, a matriz de covari√¢ncia condicional $H_t$ √© decomposta da seguinte forma [^2]:

$$H_t = D_t R D_t$$

onde:

*   $H_t$ √© a matriz de covari√¢ncia condicional no tempo $t$.
*   $D_t$ √© uma matriz diagonal contendo os desvios padr√£o condicionais na diagonal principal, obtidos a partir de modelos GARCH univariados para cada s√©rie individual.
*   $R$ √© a matriz de correla√ß√£o condicional constante.

Essa decomposi√ß√£o implica que a varia√ß√£o temporal na matriz de covari√¢ncia condicional √© inteiramente impulsionada pelas varia√ß√µes nas volatilidades condicionais das s√©ries individuais, enquanto as correla√ß√µes condicionais permanecem constantes ao longo do tempo [^2].

> üí° **Exemplo Num√©rico:** Considere um cen√°rio onde estamos analisando dois ativos, A e B. Ap√≥s modelar as volatilidades de cada ativo usando modelos GARCH univariados, obtemos os seguintes desvios padr√£o condicionais para o dia $t$: $\sigma_{A,t} = 0.02$ (2%) e $\sigma_{B,t} = 0.03$ (3%).  A matriz $D_t$ seria:

$$
D_t = \begin{bmatrix}
0.02 & 0 \\
0 & 0.03
\end{bmatrix}
$$

> Suponha que a matriz de correla√ß√£o constante $R$, estimada a partir dos res√≠duos padronizados hist√≥ricos dos ativos A e B, seja:

$$
R = \begin{bmatrix}
1 & 0.6 \\
0.6 & 1
\end{bmatrix}
$$

> Isso indica uma correla√ß√£o positiva de 0.6 entre os retornos dos ativos A e B. A matriz de covari√¢ncia condicional $H_t$ para o dia $t$ seria ent√£o calculada como:

$$
H_t = D_t R D_t = \begin{bmatrix}
0.02 & 0 \\
0 & 0.03
\end{bmatrix} \begin{bmatrix}
1 & 0.6 \\
0.6 & 1
\end{bmatrix} \begin{bmatrix}
0.02 & 0 \\
0 & 0.03
\end{bmatrix} = \begin{bmatrix}
0.0004 & 0.000072 \\
0.000072 & 0.0009
\end{bmatrix}
$$

> A matriz $H_t$ nos fornece as vari√¢ncias condicionais dos ativos A e B (0.0004 e 0.0009, respectivamente) e a covari√¢ncia condicional entre eles (0.000072).  Podemos interpretar a covari√¢ncia como uma medida de como os retornos dos dois ativos se movem juntos. No contexto de gest√£o de portf√≥lio, esta informa√ß√£o √© crucial para avaliar e gerir o risco.

Para estimar o modelo CCC, primeiro, modelos GARCH univariados s√£o estimados para cada s√©rie individual para obter as volatilidades condicionais. Em seguida, os res√≠duos padronizados s√£o calculados como:

$$ \epsilon_{i,t} = \frac{r_{i,t}}{\sqrt{h_{i,t}}} $$

onde $r_{i,t}$ √© o retorno da s√©rie *i* no tempo *t*, e $h_{i,t}$ √© a vari√¢ncia condicional obtida do modelo GARCH univariado [^2]. Finalmente, a matriz de correla√ß√£o constante $R$ √© estimada a partir dos res√≠duos padronizados [^2]:

$$ R = E[\epsilon_t \epsilon_t'] $$

onde $\epsilon_t$ √© o vetor de res√≠duos padronizados no tempo *t*. Na pr√°tica, $R$ √© estimada como a matriz de correla√ß√£o amostral dos res√≠duos padronizados.

> üí° **Exemplo Num√©rico:** Suponha que temos retornos di√°rios para dois ativos, X e Y, durante 5 dias. Ap√≥s ajustar modelos GARCH univariados, obtivemos as seguintes vari√¢ncias condicionais:

| Dia (t) | h<sub>X,t</sub> | h<sub>Y,t</sub> |
|---|---|---|
| 1 | 0.0001 | 0.0004 |
| 2 | 0.00012 | 0.00038 |
| 3 | 0.00015 | 0.00042 |
| 4 | 0.00013 | 0.00045 |
| 5 | 0.00016 | 0.00041 |

> E os retornos di√°rios observados foram:

| Dia (t) | r<sub>X,t</sub> | r<sub>Y,t</sub> |
|---|---|---|
| 1 | 0.01 | 0.02 |
| 2 | -0.005 | 0.015 |
| 3 | 0.012 | -0.008 |
| 4 | 0.008 | 0.022 |
| 5 | -0.015 | -0.01 |

> **Passo 1: Calcular os Res√≠duos Padronizados**
> Usamos a f√≥rmula $\epsilon_{i,t} = \frac{r_{i,t}}{\sqrt{h_{i,t}}}$ para calcular os res√≠duos padronizados.

| Dia (t) | Œµ<sub>X,t</sub> | Œµ<sub>Y,t</sub> |
|---|---|---|
| 1 | 1.00 | 1.00 |
| 2 | -0.456 | 0.770 |
| 3 | 0.980 | -0.390 |
| 4 | 0.700 | 1.037 |
| 5 | -1.186 | -0.494 |

> **Passo 2: Estimar a Matriz de Correla√ß√£o R**
> Calculamos a matriz de correla√ß√£o amostral dos res√≠duos padronizados. Podemos usar Python com NumPy para isso:
```python
import numpy as np

epsilon_X = np.array([1.00, -0.456, 0.980, 0.700, -1.186])
epsilon_Y = np.array([1.00, 0.770, -0.390, 1.037, -0.494])

# Matriz de res√≠duos padronizados
epsilon = np.vstack([epsilon_X, epsilon_Y]).T

# Calcular a matriz de correla√ß√£o
R = np.corrcoef(epsilon.T)

print("Matriz de Correla√ß√£o R:\n", R)
```

> A sa√≠da do c√≥digo acima ser√° algo pr√≥ximo de:
```
Matriz de Correla√ß√£o R:
[[ 1.          0.046]
 [ 0.046       1.        ]]
```
> Neste exemplo, a matriz de correla√ß√£o R indica uma correla√ß√£o muito fraca (0.046) entre os res√≠duos padronizados dos ativos X e Y. Isso sugere que, ap√≥s ajustar os modelos GARCH para as volatilidades individuais, a depend√™ncia linear restante entre os ativos √© m√≠nima. Na pr√°tica, √© importante avaliar se essa correla√ß√£o √© estatisticamente significativa. Al√©m disso, este exemplo ilustra como o modelo CCC pode ser implementado em um cen√°rio pr√°tico, permitindo que os analistas capturem a din√¢mica de covari√¢ncia entre ativos financeiros.

> üí° **An√°lise de Res√≠duos:** Ap√≥s a estima√ß√£o do modelo CCC, √© crucial analisar os res√≠duos padronizados para verificar a adequa√ß√£o do modelo. Podemos fazer alguns testes:
>
> *   **Teste de Autocorrela√ß√£o:** Aplicar o teste de Ljung-Box aos res√≠duos padronizados e seus quadrados para verificar se h√° autocorrela√ß√£o serial remanescente. Se houver, o modelo GARCH univariado pode n√£o estar capturando toda a depend√™ncia temporal na volatilidade.
> *   **Teste de Normalidade:** Verificar se os res√≠duos padronizados seguem uma distribui√ß√£o normal. Podemos usar o teste de Jarque-Bera. Se os res√≠duos n√£o forem normais, isso pode indicar a necessidade de usar uma distribui√ß√£o diferente para modelar os erros.

**Teorema 4:** *A matriz de covari√¢ncia condicional $H_t$ no modelo CCC √© positiva definida se a matriz de correla√ß√£o constante $R$ for positiva definida.*

*Demonstra√ß√£o:*

I.  Dado que $D_t$ √© uma matriz diagonal contendo os desvios padr√£o condicionais, todos os elementos diagonais s√£o positivos. Portanto, $D_t$ √© uma matriz n√£o-singular.

II. A matriz de covari√¢ncia condicional √© dada por $H_t = D_t R D_t$.

III. Para que $H_t$ seja positiva definida, precisamos mostrar que para qualquer vetor n√£o nulo $x$, $x'H_t x > 0$.

IV. Considere $x'H_t x$:
$$ x'H_t x = x'(D_t R D_t)x = (D_t x)'R(D_t x) $$

V.  Seja $y = D_t x$. Como $D_t$ √© n√£o-singular e $x$ √© n√£o nulo, $y$ tamb√©m √© n√£o nulo. Ent√£o, $x'H_t x = y'Ry$.

VI. Se a matriz de correla√ß√£o $R$ √© positiva definida, ent√£o $y'Ry > 0$ para qualquer vetor n√£o nulo $y$.

VII. Portanto, se $R$ √© positiva definida, ent√£o $x'H_t x > 0$ para qualquer vetor n√£o nulo $x$, o que significa que $H_t$ √© positiva definida. $\blacksquare$

**Corol√°rio 4.1:** *No modelo CCC, a condi√ß√£o para a matriz de covari√¢ncia condicional $H_t$ ser positiva definida √© que a matriz de correla√ß√£o constante $R$ seja uma matriz de correla√ß√£o v√°lida, ou seja, que seja sim√©trica, tenha todos os elementos diagonais iguais a 1 e todos os seus autovalores sejam positivos.*

*Demonstra√ß√£o:* A condi√ß√£o de *R* ser uma matriz de correla√ß√£o v√°lida garante que ela seja positiva definida. As condi√ß√µes de simetria e elementos diagonais iguais a 1 s√£o caracter√≠sticas de uma matriz de correla√ß√£o. Se todos os autovalores de *R* forem positivos, ent√£o *R* √© positiva definida. Portanto, se *R* satisfaz essas condi√ß√µes, $H_t$ √© positiva definida. $\blacksquare$

Uma importante consequ√™ncia da estrutura do modelo CCC √© a rela√ß√£o entre as covari√¢ncias condicionais e as volatilidades condicionais. Podemos expressar essa rela√ß√£o formalmente:

**Proposi√ß√£o 5:** *No modelo CCC, a covari√¢ncia condicional entre os ativos i e j no tempo t, denotada por $h_{ij,t}$, √© dada por:*

$$ h_{ij,t} = \rho_{ij} \sqrt{h_{i,t} h_{j,t}} $$

*onde $\rho_{ij}$ √© o elemento (i, j) da matriz de correla√ß√£o constante R, e $h_{i,t}$ e $h_{j,t}$ s√£o as vari√¢ncias condicionais dos ativos i e j no tempo t, respectivamente.*

*Demonstra√ß√£o:*

I.  A matriz de covari√¢ncia condicional $H_t$ √© dada por $H_t = D_t R D_t$.

II. O elemento (i, j) de $H_t$, denotado por $h_{ij,t}$, representa a covari√¢ncia condicional entre os ativos i e j no tempo t.

III. A matriz $D_t$ √© uma matriz diagonal com os desvios padr√£o condicionais na diagonal principal, ou seja, $D_{ii,t} = \sqrt{h_{i,t}}$.

IV. Portanto, $h_{ij,t}$ √© calculado como:

$$ h_{ij,t} = \sum_{k=1}^{N} \sum_{l=1}^{N} D_{ik,t} R_{kl} D_{lj,t} $$

onde N √© o n√∫mero de ativos.

V.  Como $D_t$ √© uma matriz diagonal, $D_{ik,t} = 0$ se $i \neq k$ e $D_{lj,t} = 0$ se $l \neq j$. Portanto, a soma dupla se reduz a um √∫nico termo:

$$ h_{ij,t} = D_{ii,t} R_{ij} D_{jj,t} = \sqrt{h_{i,t}} \rho_{ij} \sqrt{h_{j,t}} = \rho_{ij} \sqrt{h_{i,t} h_{j,t}} $$

VI. Assim, a covari√¢ncia condicional entre os ativos i e j no tempo t √© dada por $h_{ij,t} = \rho_{ij} \sqrt{h_{i,t} h_{j,t}}$. $\blacksquare$

> üí° **Exemplo Num√©rico:**  Considere dois ativos, ouro (i) e a√ß√µes de tecnologia (j). Suponha que, ap√≥s modelar as volatilidades usando GARCH, estimamos as seguintes vari√¢ncias condicionais no tempo t: $h_{i,t} = 0.0001$ (ouro) e $h_{j,t} = 0.0004$ (a√ß√µes de tecnologia). A correla√ß√£o constante entre esses ativos, estimada a partir dos res√≠duos padronizados hist√≥ricos, √© $\rho_{ij} = -0.2$.

> Usando a Proposi√ß√£o 5, calculamos a covari√¢ncia condicional entre ouro e a√ß√µes de tecnologia no tempo t:
> $$h_{ij,t} = \rho_{ij} \sqrt{h_{i,t} h_{j,t}} = -0.2 \sqrt{0.0001 \times 0.0004} = -0.2 \times 0.0002 = -0.00004$$

> A covari√¢ncia negativa sugere que, em m√©dia, quando o pre√ßo do ouro aumenta, o pre√ßo das a√ß√µes de tecnologia tende a diminuir, e vice-versa. Essa informa√ß√£o √© crucial para diversifica√ß√£o de portf√≥lio.  Se um investidor j√° possui uma grande posi√ß√£o em a√ß√µes de tecnologia, adicionar ouro ao portf√≥lio pode ajudar a reduzir o risco geral, j√° que os dois ativos t√™m uma covari√¢ncia negativa. √â importante notar que este √© apenas um exemplo simplificado e a rela√ß√£o entre ouro e a√ß√µes de tecnologia pode mudar ao longo do tempo.

Adicionalmente, √© importante notar que a estimativa da matriz de correla√ß√£o constante $R$ pode ser afetada por outliers nos dados. Para mitigar este problema, podemos considerar o uso de estimadores robustos para a matriz de correla√ß√£o.

**Observa√ß√£o 6:** *A matriz de correla√ß√£o constante $R$ pode ser estimada usando estimadores robustos, como a matriz de correla√ß√£o de Spearman ou Kendall, para reduzir a influ√™ncia de outliers.*

*Justificativa:* Os estimadores de correla√ß√£o de Spearman e Kendall s√£o menos sens√≠veis a valores extremos em compara√ß√£o com o estimador de correla√ß√£o de Pearson, que √© usado no c√°lculo da matriz de correla√ß√£o amostral. Ao usar esses estimadores robustos, podemos obter uma matriz de correla√ß√£o mais est√°vel e menos influenciada por outliers, o que pode melhorar a precis√£o do modelo CCC.

> üí° **Exemplo Num√©rico:** Considere que estamos estimando a matriz de correla√ß√£o entre dois ativos. Em um determinado per√≠odo, um outlier extremo afeta o retorno de um dos ativos.
>
> | Dia   | Ativo 1 Retorno | Ativo 2 Retorno |
> |-------|-----------------|-----------------|
> | 1     | 0.01            | 0.015           |
> | 2     | -0.005          | -0.002          |
> | 3     | 0.02            | 0.025           |
> | 4     | 0.015           | 0.018           |
> | 5     | 0.1             | 0.02            | <!-- Outlier -->
>
> Usando a correla√ß√£o de Pearson:
> ```python
> import numpy as np
> from scipy.stats import spearmanr, kendalltau
>
> ativo1 = np.array([0.01, -0.005, 0.02, 0.015, 0.1])
> ativo2 = np.array([0.015, -0.002, 0.025, 0.018, 0.02])
>
> pearson_corr = np.corrcoef(ativo1, ativo2)[0, 1]
> print(f"Correla√ß√£o de Pearson: {pearson_corr:.3f}")
>
> spearman_corr, _ = spearmanr(ativo1, ativo2)
> print(f"Correla√ß√£o de Spearman: {spearman_corr:.3f}")
>
> kendall_corr, _ = kendalltau(ativo1, ativo2)
> print(f"Correla√ß√£o de Kendall: {kendall_corr:.3f}")
> ```
>
> Sa√≠da:
> ```
> Correla√ß√£o de Pearson: 0.389
> Correla√ß√£o de Spearman: 0.800
> Correla√ß√£o de Kendall: 0.600
> ```
>
> Observamos que a correla√ß√£o de Pearson √© muito sens√≠vel ao outlier.  A correla√ß√£o de Spearman e Kendall, sendo baseadas em ranks, s√£o menos afetadas, fornecendo uma estimativa mais robusta da rela√ß√£o entre os ativos. Ao usar a correla√ß√£o de Spearman ou Kendall na estimativa da matriz R no modelo CCC, podemos reduzir a influ√™ncia de outliers e obter resultados mais est√°veis, especialmente em dados financeiros onde outliers s√£o comuns.

### Vantagens e Desvantagens

| Modelo | Vantagens                                                                                                                                           | Desvantagens                                                                                                                                                                                   |
|--------|-----------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CCC    | Simples de implementar; reduz significativamente o n√∫mero de par√¢metros em compara√ß√£o com o modelo VEC; garante a positividade da matriz de covari√¢ncia. | Assume que as correla√ß√µes s√£o constantes ao longo do tempo, o que pode n√£o ser realista em muitos cen√°rios financeiros; n√£o captura a din√¢mica de depend√™ncia em diferentes condi√ß√µes de mercado. |

### Conclus√£o
O modelo CCC oferece uma abordagem simples e computacionalmente eficiente para modelar a matriz de covari√¢ncia condicional em sistemas de alta dimens√£o [^2]. Ao combinar modelos GARCH univariados com uma estrutura de correla√ß√£o constante, o modelo reduz significativamente o n√∫mero de par√¢metros a serem estimados, tornando-o mais trat√°vel em aplica√ß√µes pr√°ticas [^2]. No entanto, a premissa de correla√ß√µes constantes pode ser uma limita√ß√£o significativa em muitos cen√°rios financeiros, especialmente em per√≠odos de turbul√™ncia ou mudan√ßas estruturais [^2]. Modelos mais avan√ßados, como o modelo DCC (Dynamic Conditional Correlation), relaxam essa premissa e permitem que as correla√ß√µes variem ao longo do tempo.

### Refer√™ncias
[^1]: Cap√≠tulo 9: Forecasting Risk and Correlations.
[^2]: Se√ß√£o 9.A: Multivariate GARCH Models.
<!-- END -->