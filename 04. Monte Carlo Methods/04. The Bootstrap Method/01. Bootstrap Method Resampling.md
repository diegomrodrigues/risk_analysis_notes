### Introdu√ß√£o
No contexto da an√°lise de risco financeiro, os m√©todos de Monte Carlo representam uma ferramenta poderosa para a avalia√ß√£o de Value at Risk (VAR) [^1]. Conforme discutido anteriormente, a simula√ß√£o de pre√ßos e cen√°rios futuros √© fundamental para a estima√ß√£o do VAR [^1]. Este cap√≠tulo explora o m√©todo *bootstrap* como uma alternativa √† gera√ß√£o de n√∫meros aleat√≥rios a partir de distribui√ß√µes hipot√©ticas, focando em sua aplica√ß√£o na simula√ß√£o de dados hist√≥ricos e suas vantagens [^7].

### Conceitos Fundamentais
O m√©todo *bootstrap* √© uma t√©cnica de reamostragem que permite estimar a distribui√ß√£o de uma estat√≠stica amostral atrav√©s da reamostragem repetida dos dados observados [^7]. Ao inv√©s de assumir uma distribui√ß√£o te√≥rica para os retornos dos ativos, o *bootstrap* utiliza os dados hist√≥ricos dispon√≠veis para simular poss√≠veis trajet√≥rias futuras dos pre√ßos [^7].

**Procedimento Bootstrap:**
1. **Coleta de Dados Hist√≥ricos:** Re√∫ne-se uma s√©rie hist√≥rica de retornos $R = \Delta S/S$, onde $\{R\} = (R_1, R_2, ..., R_M)$ representa os retornos observados ao longo de $M$ per√≠odos [^7].
2. **Reamostragem com Reposi√ß√£o:** Seleciona-se aleatoriamente um retorno da s√©rie hist√≥rica, com reposi√ß√£o. Isso significa que o mesmo retorno pode ser selecionado mais de uma vez em uma mesma simula√ß√£o [^7].
3. **Constru√ß√£o de Pseudoretornos:** Utiliza-se o retorno selecionado para simular o pr√≥ximo pre√ßo do ativo, atrav√©s da f√≥rmula $S_{t+1} = S_t(1 + R_{m(i)})$, onde $m(i)$ √© um √≠ndice aleat√≥rio entre 1 e $M$ [^7, 8].

> üí° **Exemplo Num√©rico:**
>
> Suponha que temos os seguintes retornos hist√≥ricos di√°rios para uma a√ß√£o:
>
> $R = \{0.01, -0.005, 0.002, 0.008, -0.012\}$
>
> Onde $M = 5$. Assumindo que o pre√ßo atual da a√ß√£o √© $S_t = 100$, vamos simular o pr√≥ximo pre√ßo $S_{t+1}$ usando o *bootstrap*.
>
> Primeiro, selecionamos aleatoriamente um retorno da s√©rie hist√≥rica. Suponha que selecionamos $R_{m(i)} = -0.005$.
>
> Ent√£o, o pr√≥ximo pre√ßo simulado ser√°:
>
> $S_{t+1} = S_t(1 + R_{m(i)}) = 100(1 - 0.005) = 100(0.995) = 99.5$
>
> Portanto, o pre√ßo simulado da a√ß√£o para o pr√≥ximo per√≠odo √© $99.5$. Este processo √© repetido v√°rias vezes para gerar uma trajet√≥ria de pre√ßos simulada.

![Bootstrap simulation process](./../images/figure7.jpg)

4. **Repeti√ß√£o:** Repete-se os passos 2 e 3 por um n√∫mero suficiente de vezes para gerar uma trajet√≥ria de pre√ßos simulada ao longo do horizonte de tempo desejado [^8].
5. **C√°lculo do VAR:** Repete-se os passos 1 a 4 um grande n√∫mero de vezes (K vezes) para gerar uma distribui√ß√£o de poss√≠veis valores futuros do portf√≥lio. O VAR √© ent√£o estimado a partir dos quantis dessa distribui√ß√£o [^8].

> üí° **Exemplo Num√©rico:**
>
> Vamos supor que simulamos 10000 trajet√≥rias de pre√ßos usando o *bootstrap*. No final do horizonte de tempo (e.g., 10 dias), temos 10000 valores simulados para o nosso portf√≥lio. Para calcular o VAR a 95%, precisamos encontrar o 5¬∫ percentil (ou quantil 0.05) desta distribui√ß√£o.
>
> Suponha que, ap√≥s ordenar os 10000 valores do portf√≥lio, o 500¬∫ menor valor seja $90$. Isso significa que em 5% dos cen√°rios simulados, o valor do portf√≥lio √© menor ou igual a $90$. Se o valor inicial do portf√≥lio era $100$, ent√£o o VAR a 95% √©:
>
> $VAR_{95\%} = 100 - 90 = 10$
>
> Isso significa que temos 95% de confian√ßa de que a perda m√°xima do portf√≥lio n√£o exceder√° $10$ no horizonte de tempo considerado.

**Proposi√ß√£o 1** [Converg√™ncia do Bootstrap]: √Ä medida que o n√∫mero de reamostragens $K$ tende ao infinito, a distribui√ß√£o emp√≠rica dos valores do portf√≥lio simulados pelo *bootstrap* converge para a verdadeira distribui√ß√£o dos poss√≠veis valores futuros do portf√≥lio, sob certas condi√ß√µes de regularidade da s√©rie hist√≥rica de retornos.

*Estrat√©gia da Demonstra√ß√£o:* A demonstra√ß√£o envolve mostrar que a distribui√ß√£o emp√≠rica constru√≠da pelo *bootstrap* se aproxima da distribui√ß√£o te√≥rica √† medida que $K$ aumenta. Isso pode ser feito usando teoremas de converg√™ncia, como a Lei Forte dos Grandes N√∫meros ou o Teorema Central do Limite, adaptados para o contexto de reamostragem *bootstrap*. Condi√ß√µes de regularidade na s√©rie hist√≥rica garantem que os momentos da distribui√ß√£o amostral convergir para os momentos da distribui√ß√£o populacional.

*Prova da Proposi√ß√£o 1:*
Para provar a converg√™ncia do Bootstrap, precisamos demonstrar que a distribui√ß√£o emp√≠rica dos valores do portf√≥lio simulados converge para a verdadeira distribui√ß√£o, quando $K \rightarrow \infty$.

I. Seja $F_K(x)$ a distribui√ß√£o emp√≠rica dos valores do portf√≥lio obtidos atrav√©s do *bootstrap* com $K$ reamostragens, e $F(x)$ a verdadeira distribui√ß√£o dos valores futuros do portf√≥lio. Queremos mostrar que $F_K(x)$ converge para $F(x)$ quando $K$ tende ao infinito.

II. Pela Lei Forte dos Grandes N√∫meros, para qualquer fun√ß√£o $g(R)$ integr√°vel, a m√©dia amostral converge para a esperan√ßa populacional:
   $$\frac{1}{K} \sum_{i=1}^{K} g(R_i^*) \xrightarrow{a.s.} E[g(R)]$$
   onde $R_i^*$ s√£o os retornos reamostrados pelo *bootstrap*.

III.  Seja $g(R) = \mathbb{I}(S_t(1+R) \leq x)$, onde $\mathbb{I}$ √© a fun√ß√£o indicadora e $x$ √© um valor espec√≠fico do portf√≥lio. Ent√£o, $E[g(R)] = P(S_{t+1} \leq x) = F(x)$.

IV. Aplicando a Lei Forte dos Grandes N√∫meros:
    $$F_K(x) = \frac{1}{K} \sum_{i=1}^{K} \mathbb{I}(S_t(1+R_i^*) \leq x) \xrightarrow{a.s.} F(x)$$

V. Portanto, a distribui√ß√£o emp√≠rica $F_K(x)$ converge quase certamente para a verdadeira distribui√ß√£o $F(x)$ quando $K \rightarrow \infty$, sob condi√ß√µes de regularidade que garantem a integrabilidade de $g(R)$. ‚ñ†

**Vantagens do M√©todo Bootstrap:**
*   **N√£o Param√©trico:** O *bootstrap* n√£o requer a especifica√ß√£o de uma distribui√ß√£o te√≥rica para os retornos dos ativos, tornando-o robusto a desvios da normalidade [^7].
*   **Captura de Caracter√≠sticas Emp√≠ricas:** O m√©todo consegue capturar caracter√≠sticas importantes dos dados hist√≥ricos, como *fat tails*, *jumps*, e depend√™ncias n√£o lineares, que podem ser cruciais para uma an√°lise de risco precisa [^8].
*   **Correla√ß√µes:** O *bootstrap* pode capturar correla√ß√µes entre diferentes ativos, simplesmente amostrando os retornos simult√¢neos de diferentes ativos em um dado per√≠odo [^8].
*   **Flexibilidade:** Pode ser combinado com outros modelos, como modelos GARCH, para incorporar din√¢micas de volatilidade e depend√™ncia temporal [^8].

**Limita√ß√µes do M√©todo Bootstrap:**
*   **Tamanho da Amostra:** O *bootstrap* requer uma quantidade razo√°vel de dados hist√≥ricos para gerar uma distribui√ß√£o simulada confi√°vel [^8]. Pequenas amostras podem levar a uma representa√ß√£o pobre da distribui√ß√£o real [^8].
*   **Independ√™ncia:** O m√©todo assume que os retornos s√£o independentes e identicamente distribu√≠dos (i.i.d.) [^7]. Reamostrar aleatoriamente quebra qualquer padr√£o de varia√ß√£o ao longo do tempo [^8].

Para contornar a limita√ß√£o da independ√™ncia, podemos considerar uma varia√ß√£o do bootstrap que leva em conta a depend√™ncia temporal.

**Aprimoramentos do M√©todo Bootstrap:**

*   **Bootstrap em Blocos (Block Bootstrap):** Uma t√©cnica para lidar com depend√™ncia temporal √© o *bootstrap* em blocos, onde blocos consecutivos de retornos s√£o reamostrados em vez de retornos individuais. Isso preserva a estrutura de depend√™ncia dentro de cada bloco.

**Procedimento Block Bootstrap:**

1. **Defini√ß√£o do Tamanho do Bloco:** Escolhe-se um tamanho de bloco $b$, que representa o n√∫mero de retornos consecutivos a serem reamostrados juntos.

2. **Reamostragem de Blocos:** Seleciona-se aleatoriamente um bloco de tamanho $b$ da s√©rie hist√≥rica de retornos, com reposi√ß√£o.

3. **Constru√ß√£o de Pseudoretornos:** Utiliza-se os retornos do bloco selecionado para simular os pr√≥ximos $b$ pre√ßos do ativo.

4. **Repeti√ß√£o:** Repete-se os passos 2 e 3 at√© gerar uma trajet√≥ria de pre√ßos simulada ao longo do horizonte de tempo desejado.

5. **C√°lculo do VAR:** Repete-se os passos 1 a 4 um grande n√∫mero de vezes (K vezes) para gerar uma distribui√ß√£o de poss√≠veis valores futuros do portf√≥lio. O VAR √© ent√£o estimado a partir dos quantis dessa distribui√ß√£o.

> üí° **Exemplo Num√©rico:**
>
> Suponha que temos a seguinte s√©rie hist√≥rica de retornos di√°rios por 10 dias:
>
> $R = \{0.01, -0.005, 0.002, 0.008, -0.012, 0.005, -0.001, 0.015, -0.007, 0.003\}$
>
> Vamos usar o Block Bootstrap com um tamanho de bloco $b = 3$. Isso significa que reamostraremos blocos de 3 retornos consecutivos.
>
> Poss√≠veis blocos:
>
> *   Bloco 1: $\{0.01, -0.005, 0.002\}$
> *   Bloco 2: $\{-0.005, 0.002, 0.008\}$
> *   Bloco 3: $\{0.002, 0.008, -0.012\}$
> *   Bloco 4: $\{0.008, -0.012, 0.005\}$
> *   Bloco 5: $\{-0.012, 0.005, -0.001\}$
> *   Bloco 6: $\{0.005, -0.001, 0.015\}$
> *   Bloco 7: $\{-0.001, 0.015, -0.007\}$
> *   Bloco 8: $\{0.015, -0.007, 0.003\}$
>
> Suponha que aleatoriamente selecionemos o Bloco 3: $\{0.002, 0.008, -0.012\}$.
>
> Se o pre√ßo atual da a√ß√£o √© $S_t = 100$, ent√£o os pr√≥ximos tr√™s pre√ßos simulados ser√£o:
>
> $S_{t+1} = 100(1 + 0.002) = 100.2$
>
> $S_{t+2} = 100.2(1 + 0.008) = 101.0016$
>
> $S_{t+3} = 101.0016(1 - 0.012) = 99.7895$
>
> Este processo √© repetido v√°rias vezes, selecionando diferentes blocos aleatoriamente, para gerar uma trajet√≥ria de pre√ßos simulada.

**Lema 1.1** [Escolha do Tamanho do Bloco]: A escolha do tamanho do bloco $b$ no *block bootstrap* √© crucial. Um $b$ muito pequeno n√£o captura adequadamente a depend√™ncia temporal, enquanto um $b$ muito grande reduz a variabilidade da reamostragem e pode levar a estimativas viesadas.

*Estrat√©gia da Demonstra√ß√£o:* A demonstra√ß√£o envolve analisar o trade-off entre vi√©s e vari√¢ncia na escolha de $b$. M√©todos como valida√ß√£o cruzada podem ser usados para otimizar a escolha de $b$ com base em crit√©rios de desempenho.

*Prova do Lema 1.1:*
A escolha do tamanho do bloco $b$ √© crucial no Block Bootstrap. Vamos analisar o trade-off entre vi√©s e vari√¢ncia.

I. Se $b$ √© muito pequeno, a depend√™ncia temporal n√£o √© capturada adequadamente. Isso significa que a estrutura de autocorrela√ß√£o dos dados √© perdida, levando a um vi√©s na estimativa da distribui√ß√£o dos retornos.

II. Formalmente, seja $\rho(k)$ a fun√ß√£o de autocorrela√ß√£o dos retornos a um lag $k$. Se $b < k$ tal que $\rho(k) \neq 0$, ent√£o o Block Bootstrap com tamanho $b$ n√£o capturar√° essa depend√™ncia. Isso resulta em uma subestima√ß√£o da variabilidade dos retornos, levando a um vi√©s.

III. Por outro lado, se $b$ √© muito grande, a variabilidade da reamostragem √© reduzida, e as simula√ß√µes se tornam muito semelhantes entre si. Isso pode levar a uma superestima√ß√£o da precis√£o das estimativas.

IV. Al√©m disso, um $b$ muito grande diminui o n√∫mero efetivo de blocos reamostrados, aumentando a vari√¢ncia das estimativas. Seja $M$ o tamanho da amostra hist√≥rica. O n√∫mero de blocos reamostrados √© aproximadamente $M/b$. Se $b$ √© grande, $M/b$ √© pequeno, resultando em alta vari√¢ncia.

V. Portanto, existe um trade-off entre vi√©s e vari√¢ncia. Um $b$ pequeno leva a vi√©s devido √† n√£o captura da depend√™ncia temporal, enquanto um $b$ grande leva a alta vari√¢ncia devido ao pequeno n√∫mero de blocos reamostrados.

VI. A escolha √≥tima de $b$ minimiza o erro quadr√°tico m√©dio (MSE), que √© a soma do quadrado do vi√©s e da vari√¢ncia. M√©todos como valida√ß√£o cruzada podem ser usados para estimar o MSE para diferentes valores de $b$ e escolher o valor que minimiza o MSE. ‚ñ†

*   **Depend√™ncia Temporal:** A reamostragem aleat√≥ria pode n√£o capturar depend√™ncias temporais importantes, como autocorrela√ß√£o ou efeitos de *clustering* de volatilidade [^8].

Para mitigar a limita√ß√£o da independ√™ncia, o *bootstrap* pode ser aplicado aos res√≠duos normalizados de um modelo GARCH [^8]. Nesse caso, os res√≠duos normalizados $\epsilon_t = r_t / \sigma_t$, onde $r_t$ √© o retorno atual e $\sigma_t$ √© o desvio padr√£o condicional estimado pelo modelo GARCH, s√£o reamostrados para criar pseudoretornos, reconstruindo a vari√¢ncia condicional e os pseudoretornos [^8].

> üí° **Exemplo Num√©rico:**
>
> Suponha que ajustamos um modelo GARCH(1,1) aos retornos de uma a√ß√£o e obtivemos os seguintes res√≠duos normalizados para os √∫ltimos 5 dias:
>
> $\epsilon = \{0.5, -0.8, 1.2, -0.3, 0.9\}$
>
> E as seguintes volatilidades condicionais estimadas pelo modelo GARCH:
>
> $\sigma = \{0.01, 0.012, 0.009, 0.011, 0.01\}$
>
> Para usar o *bootstrap*, reamostramos os res√≠duos normalizados. Suponha que reamostramos o seguinte conjunto:
>
> $\epsilon^* = \{-0.8, 1.2, 0.9, 0.5, -0.3\}$
>
> Agora, podemos usar esses res√≠duos reamostrados para simular os pr√≥ximos retornos. Se o √∫ltimo retorno observado foi $r_t$, ent√£o o pr√≥ximo retorno simulado ser√°:
>
> $r_{t+1} = \epsilon_{1}^* \cdot \sigma_{t+1}$
>
> Onde $\sigma_{t+1}$ √© a volatilidade condicional estimada pelo modelo GARCH para o pr√≥ximo per√≠odo, dado os dados hist√≥ricos e os par√¢metros do modelo. Suponha que o modelo GARCH estime $\sigma_{t+1} = 0.011$.
>
> Ent√£o, $r_{t+1} = -0.8 \cdot 0.011 = -0.0088$
>
> Portanto, o pr√≥ximo retorno simulado √© $-0.0088$ ou $-0.88\%$. Este processo √© repetido para simular uma trajet√≥ria completa de retornos, levando em conta a depend√™ncia temporal modelada pelo GARCH.

**Bootstrap e Valor em Risco (VaR):**
O c√°lculo do VaR usando o m√©todo *bootstrap* envolve simular um grande n√∫mero de poss√≠veis cen√°rios futuros para o valor do portf√≥lio. Ap√≥s simular as trajet√≥rias de pre√ßos, o valor do portf√≥lio √© calculado para cada cen√°rio [^8]. O VaR √© ent√£o estimado como o quantil da distribui√ß√£o dos valores simulados do portf√≥lio [^8].

**Teorema 2** [Consist√™ncia do Estimador Bootstrap do VaR]: Sob condi√ß√µes de regularidade adequadas, o estimador *bootstrap* do VaR converge em probabilidade para o verdadeiro VaR √† medida que o tamanho da amostra hist√≥rica aumenta e o n√∫mero de simula√ß√µes *bootstrap* tende ao infinito.

*Estrat√©gia da Demonstra√ß√£o:* A demonstra√ß√£o pode envolver o uso da teoria da converg√™ncia de processos emp√≠ricos e resultados sobre a consist√™ncia de estimadores de quantis. As condi√ß√µes de regularidade garantem que a distribui√ß√£o emp√≠rica dos retornos convirja para a distribui√ß√£o verdadeira e que o estimador de quantil seja consistente.

*Prova do Teorema 2:*
Para demonstrar a consist√™ncia do estimador Bootstrap do VaR, precisamos mostrar que o estimador Bootstrap converge em probabilidade para o verdadeiro VaR.

I. Seja $VaR_{\alpha}$ o verdadeiro Valor em Risco ao n√≠vel $\alpha$, definido como o quantil $\alpha$ da distribui√ß√£o dos valores do portf√≥lio. Seja $\widehat{VaR}_{\alpha, K}$ o estimador Bootstrap do VaR baseado em $K$ simula√ß√µes Bootstrap.

II. O estimador Bootstrap $\widehat{VaR}_{\alpha, K}$ √© o quantil $\alpha$ da distribui√ß√£o emp√≠rica dos valores do portf√≥lio simulados pelo Bootstrap. Seja $F_K(x)$ a distribui√ß√£o emp√≠rica dos valores do portf√≥lio simulados.

III. Pela defini√ß√£o de consist√™ncia, queremos mostrar que para qualquer $\epsilon > 0$,
$$P(|\widehat{VaR}_{\alpha, K} - VaR_{\alpha}| > \epsilon) \rightarrow 0 \quad \text{quando } M \rightarrow \infty \text{ e } K \rightarrow \infty$$
onde $M$ √© o tamanho da amostra hist√≥rica.

IV. Sob condi√ß√µes de regularidade (por exemplo, a fun√ß√£o de distribui√ß√£o acumulada dos retornos √© cont√≠nua e estritamente crescente perto do verdadeiro VaR), o quantil amostral (estimador Bootstrap) √© um estimador consistente do quantil populacional (verdadeiro VaR). Isso segue da teoria da converg√™ncia de processos emp√≠ricos.

V. Formalmente, seja $F(x)$ a verdadeira distribui√ß√£o dos valores do portf√≥lio. Como $F(x)$ √© cont√≠nua e estritamente crescente perto de $VaR_{\alpha}$, existe um $\delta > 0$ tal que para todo $x \in (VaR_{\alpha} - \delta, VaR_{\alpha} + \delta)$, $F'(x) > 0$.

VI. Pela Proposi√ß√£o 1, a distribui√ß√£o emp√≠rica $F_K(x)$ converge para $F(x)$ quando $K \rightarrow \infty$. Al√©m disso, como o tamanho da amostra hist√≥rica $M$ aumenta, a distribui√ß√£o emp√≠rica dos retornos hist√≥ricos converge para a verdadeira distribui√ß√£o dos retornos (sob condi√ß√µes de regularidade).

VII. Combinando esses resultados, temos que $\widehat{VaR}_{\alpha, K}$ converge em probabilidade para $VaR_{\alpha}$ quando $M \rightarrow \infty$ e $K \rightarrow \infty$. Isso significa que o estimador Bootstrap do VaR √© consistente. ‚ñ†

### Conclus√£o
O m√©todo *bootstrap* oferece uma alternativa valiosa aos m√©todos tradicionais de Monte Carlo, especialmente quando as premissas de distribui√ß√µes param√©tricas s√£o question√°veis. Ao permitir a simula√ß√£o de cen√°rios de risco baseados em dados hist√≥ricos, o *bootstrap* proporciona uma ferramenta flex√≠vel e robusta para a an√°lise de risco financeiro [^7, 8]. A combina√ß√£o do *bootstrap* com outros modelos estat√≠sticos, como modelos GARCH, pode aprimorar ainda mais a precis√£o e a relev√¢ncia das estimativas de risco [^8].

### Refer√™ncias
[^1]: Cap√≠tulo 12: Monte Carlo Methods.
[^7]: Se√ß√£o 12.2.3: The Bootstrap.
[^8]: Se√ß√£o 12.2.4: Computing VAR.
<!-- END -->