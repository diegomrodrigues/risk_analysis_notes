### Modelos Estoc√°sticos em M√©todos de Monte Carlo: Movimento Browniano Geom√©trico e Processos de Revers√£o √† M√©dia

### Introdu√ß√£o

Em continuidade aos cap√≠tulos anteriores sobre m√©todos de Monte Carlo [^1], este cap√≠tulo explora em profundidade a crucial etapa de escolha de modelos estoc√°sticos para simular a evolu√ß√£o de pre√ßos de ativos financeiros, com foco especial no Movimento Browniano Geom√©trico (GBM) e em modelos que incorporam revers√£o √† m√©dia [^3]. A sele√ß√£o do modelo estoc√°stico apropriado √© fundamental para garantir a precis√£o e a relev√¢ncia das simula√ß√µes de Monte Carlo, e por conseguinte, para a tomada de decis√µes de gest√£o de risco e avalia√ß√£o de ativos [^1, 2]. Como visto anteriormente, as simula√ß√µes de Monte Carlo s√£o baseadas em sorteios aleat√≥rios de vari√°veis com a distribui√ß√£o de probabilidade desejada [^1, 6, 7]. A escolha do modelo estoc√°stico dita a forma como esses sorteios aleat√≥rios s√£o interpretados e como os pre√ßos dos ativos evoluem ao longo do tempo [^1, 2, 3, 4, 6, 7]. Complementando a introdu√ß√£o podemos dizer tamb√©m que a escolha de modelos estoc√°sticos mais precisos e apropriados pode melhorar significativamente a validade das simula√ß√µes, e com isso, a an√°lise de risco e a avalia√ß√£o de ativos no contexto do m√©todos de Monte Carlo [^1, 2, 3, 4, 6, 7].

### Conceitos Fundamentais

**Movimento Browniano Geom√©trico (GBM)**

Como mencionado anteriormente, o Movimento Browniano Geom√©trico (GBM) √© um modelo amplamente utilizado para simular a evolu√ß√£o de pre√ßos de ativos, especialmente a√ß√µes e outras classes de ativos com comportamento semelhante [^3]. O modelo assume que as varia√ß√µes no pre√ßo do ativo s√£o independentes e identicamente distribu√≠das (i.i.d.) ao longo do tempo, e que o logaritmo do pre√ßo do ativo segue um processo de Wiener (movimento Browniano) com *drift* [^3].

A equa√ß√£o diferencial estoc√°stica que descreve o GBM √© dada por:

$$ dS_t = \mu S_t dt + \sigma S_t dz \quad (12.1) $$

onde:

*   $dS_t$ √© a varia√ß√£o infinitesimal no pre√ßo do ativo no instante $t$.
*   $S_t$ √© o pre√ßo do ativo no instante $t$.
*   $\mu$ √© a taxa de retorno esperada (drift) do ativo.
*   $\sigma$ √© a volatilidade do ativo.
*   $dz$ √© um incremento de um processo de Wiener (movimento Browniano padr√£o), que √© uma vari√°vel aleat√≥ria normalmente distribu√≠da com m√©dia zero e vari√¢ncia $dt$.

> üí° **Exemplo Num√©rico:**
>
> Simular uma trajet√≥ria de pre√ßos usando o modelo GBM com os seguintes par√¢metros:
>
> *   Pre√ßo inicial do ativo ($S_0$): 100
> *   Taxa de retorno esperada ($\mu$): 0.1 (10% ao ano)
> *   Volatilidade ($\sigma$): 0.2 (20% ao ano)
> *   Horizonte de tempo (T): 1 ano
> *   N√∫mero de passos de tempo (N): 252 (simulando dias √∫teis)
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> S0 = 100        # Pre√ßo inicial do ativo
> mu = 0.1        # Taxa de retorno esperada
> sigma = 0.2     # Volatilidade
> T = 1           # Horizonte de tempo (anos)
> N = 252         # N√∫mero de passos de tempo
> dt = T / N      # Tamanho do passo de tempo
>
> # Simula√ß√£o
> def simulate_gbm(S0, mu, sigma, dt, N):
>     S = np.zeros(N + 1)
>     S[0] = S0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))  # Incremento do processo de Wiener
>         S[t] = S[t-1] * np.exp((mu - 0.5 * sigma**2) * dt + sigma * dz)
>     return S
>
> # Executar a simula√ß√£o
> S = simulate_gbm(S0, mu, sigma, dt, N)
>
> # Plotar a trajet√≥ria de pre√ßos
> plt.plot(S)
> plt.xlabel('Tempo')
> plt.ylabel('Pre√ßo do Ativo')
> plt.title('Simula√ß√£o de Movimento Browniano Geom√©trico')
> plt.grid(True)
> plt.show()
> ```
![Simula√ß√£o do Modelo GBM](./../images/figure_gbm.png)

> üí° **Exemplo Num√©rico:** An√°lise da distribui√ß√£o dos pre√ßos simulados.
>
> Ap√≥s simular v√°rias trajet√≥rias de pre√ßos usando o modelo GBM, podemos analisar a distribui√ß√£o dos pre√ßos no final do horizonte de tempo (T). Isso nos permite estimar a probabilidade de o pre√ßo do ativo estar acima ou abaixo de um determinado n√≠vel.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros (os mesmos do exemplo anterior)
> S0 = 100
> mu = 0.1
> sigma = 0.2
> T = 1
> N = 252
> dt = T / N
> num_simulations = 1000  # N√∫mero de simula√ß√µes
>
> # Fun√ß√£o de simula√ß√£o (a mesma do exemplo anterior)
> def simulate_gbm(S0, mu, sigma, dt, N):
>     S = np.zeros(N + 1)
>     S[0] = S0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         S[t] = S[t-1] * np.exp((mu - 0.5 * sigma**2) * dt + sigma * dz)
>     return S
>
> # Simular v√°rias trajet√≥rias
> final_prices = []
> for _ in range(num_simulations):
>     S = simulate_gbm(S0, mu, sigma, dt, N)
>     final_prices.append(S[-1])
>
> # An√°lise da distribui√ß√£o
> final_prices = np.array(final_prices)
> mean_final_price = np.mean(final_prices)
> std_final_price = np.std(final_prices)
>
> # Plotar o histograma dos pre√ßos finais
> plt.hist(final_prices, bins=30, density=True, alpha=0.6, color='g')
> plt.xlabel('Pre√ßo Final do Ativo')
> plt.ylabel('Densidade')
> plt.title('Distribui√ß√£o dos Pre√ßos Finais (GBM)')
> plt.grid(True)
> plt.show()
>
> # Calcular a probabilidade de o pre√ßo estar acima de um certo valor (ex: 120)
> prob_above_120 = np.mean(final_prices > 120)
> print(f"Pre√ßo m√©dio final: {mean_final_price:.2f}")
> print(f"Desvio padr√£o dos pre√ßos finais: {std_final_price:.2f}")
> print(f"Probabilidade de o pre√ßo final ser maior que 120: {prob_above_120:.2f}")
> ```
>
> Este c√≥digo simula 1000 trajet√≥rias e mostra um histograma dos pre√ßos finais. Ele tamb√©m calcula a probabilidade de o pre√ßo final ser maior que 120, fornecendo uma medida de risco. A an√°lise da distribui√ß√£o permite entender a incerteza associada √† evolu√ß√£o do pre√ßo do ativo e quantificar o risco de diferentes cen√°rios.

**Teorema 1** (Solu√ß√£o Exata do GBM).
A solu√ß√£o da equa√ß√£o diferencial estoc√°stica do GBM √© dada por:

$$ S_t = S_0 \exp\left( (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t \right) $$

onde $S_0$ √© o pre√ßo inicial do ativo e $W_t$ √© um processo de Wiener padr√£o no tempo $t$.

*Prova*.
I. Aplique o lema de Ito √† fun√ß√£o $f(S) = \ln(S)$.

II. As derivadas de $f(S)$ s√£o:
$$\frac{\partial f}{\partial S} = \frac{1}{S}, \quad \frac{\partial^2 f}{\partial S^2} = -\frac{1}{S^2}$$

III. Pelo lema de Ito, temos:
$$d(\ln(S_t)) = \left(\mu - \frac{1}{2}\sigma^2\right)dt + \sigma dW_t$$

IV. Integrando ambos os lados de 0 a t, obtemos:
$$\int_0^t d(\ln(S_u)) = \int_0^t \left(\mu - \frac{1}{2}\sigma^2\right)du + \int_0^t \sigma dW_u$$

V. Resolvendo as integrais, temos:
$$\ln(S_t) - \ln(S_0) = \left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma W_t$$

VI. Exponenciando ambos os lados, obtemos:
$$S_t = S_0 \exp\left( \left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma W_t \right)$$

VII. Esta √© a solu√ß√£o exata do GBM. $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> C√°lculo do pre√ßo do ativo em um tempo espec√≠fico usando a solu√ß√£o exata do GBM.
>
> Usando os mesmos par√¢metros do exemplo anterior ($S_0 = 100$, $\mu = 0.1$, $\sigma = 0.2$, $T = 1$), calcule o pre√ßo do ativo no final do ano (t = 1) para uma √∫nica simula√ß√£o onde o processo de Wiener $W_t$ resulta em um valor de 0.1.
>
> $$ S_t = S_0 \exp\left( (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t \right) $$
>
> $$ S_1 = 100 \exp\left( (0.1 - \frac{1}{2}(0.2)^2)(1) + 0.2 \times 0.1 \right) $$
>
> $$ S_1 = 100 \exp\left( (0.1 - 0.02) + 0.02 \right) $$
>
> $$ S_1 = 100 \exp\left( 0.08 + 0.02 \right) $$
>
> $$ S_1 = 100 \exp\left( 0.1 \right) $$
>
> $$ S_1 = 100 \times 1.10517 $$
>
> $$ S_1 = 110.52 $$
>
> Este c√°lculo mostra que, para uma √∫nica trajet√≥ria onde $W_t = 0.1$, o pre√ßo do ativo no final do ano √© aproximadamente 110.52. Este valor √© uma √∫nica realiza√ß√£o de muitas poss√≠veis, refletindo a natureza estoc√°stica do modelo.

**Teorema 1.1** (Distribui√ß√£o de $S_t$ sob o GBM). Dado o Teorema 1, o pre√ßo do ativo $S_t$ no tempo $t$, condicional ao pre√ßo inicial $S_0$, segue uma distribui√ß√£o log-normal.

*Prova*.
I. Do Teorema 1, temos $S_t = S_0 \exp\left( (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t \right)$.
II. Tomando o logaritmo natural de ambos os lados, obtemos $\ln(S_t) = \ln(S_0) + (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t$.
III. Como $W_t \sim N(0, t)$, ent√£o $\ln(S_t)$ √© uma vari√°vel normal com m√©dia $\ln(S_0) + (\mu - \frac{1}{2}\sigma^2)t$ e vari√¢ncia $\sigma^2 t$.
IV. Portanto, $S_t$ segue uma distribui√ß√£o log-normal. $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> Verifica√ß√£o da distribui√ß√£o log-normal dos pre√ßos simulados.
>
> Para verificar que os pre√ßos simulados no exemplo anterior (distribui√ß√£o dos pre√ßos simulados) seguem uma distribui√ß√£o log-normal, podemos ajustar uma distribui√ß√£o log-normal aos dados simulados e comparar os par√¢metros.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from scipy.stats import lognorm
>
> # Par√¢metros (os mesmos do exemplo anterior)
> S0 = 100
> mu = 0.1
> sigma = 0.2
> T = 1
> N = 252
> dt = T / N
> num_simulations = 1000
>
> # Fun√ß√£o de simula√ß√£o (a mesma do exemplo anterior)
> def simulate_gbm(S0, mu, sigma, dt, N):
>     S = np.zeros(N + 1)
>     S[0] = S0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         S[t] = S[t-1] * np.exp((mu - 0.5 * sigma**2) * dt + sigma * dz)
>     return S
>
> # Simular v√°rias trajet√≥rias
> final_prices = []
> for _ in range(num_simulations):
>     S = simulate_gbm(S0, mu, sigma, dt, N)
>     final_prices.append(S[-1])
>
> # Ajustar a distribui√ß√£o log-normal aos dados
> final_prices = np.array(final_prices)
> shape, loc, scale = lognorm.fit(final_prices)
>
> # Par√¢metros estimados da distribui√ß√£o log-normal
> print(f"Shape (sigma estimado): {shape:.2f}")
> print(f"Scale (exp(mu) estimado): {scale:.2f}")
>
> # Plotar o histograma dos pre√ßos finais e a distribui√ß√£o log-normal ajustada
> x = np.linspace(min(final_prices), max(final_prices), 100)
> pdf = lognorm.pdf(x, shape, loc, scale)
>
> plt.hist(final_prices, bins=30, density=True, alpha=0.6, color='g', label='Pre√ßos Simulados')
> plt.plot(x, pdf, 'k', linewidth=2, label='Distribui√ß√£o Log-Normal Ajustada')
> plt.xlabel('Pre√ßo Final do Ativo')
> plt.ylabel('Densidade')
> plt.title('Ajuste da Distribui√ß√£o Log-Normal aos Pre√ßos Finais (GBM)')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este c√≥digo ajusta uma distribui√ß√£o log-normal aos pre√ßos finais simulados e imprime os par√¢metros estimados. Comparando esses par√¢metros com os par√¢metros de entrada do modelo GBM, podemos verificar se a distribui√ß√£o dos pre√ßos simulados √© consistente com a teoria. O gr√°fico tamb√©m compara visualmente o histograma dos pre√ßos simulados com a fun√ß√£o densidade de probabilidade (PDF) da distribui√ß√£o log-normal ajustada.

**Modelos de Revers√£o √† M√©dia para Taxas de Juros**

Embora o GBM seja adequado para modelar a evolu√ß√£o de pre√ßos de ativos, ele n√£o √© apropriado para modelar taxas de juros [^2, 3, 21]. As taxas de juros tendem a exibir um comportamento de *revers√£o √† m√©dia*, ou seja, elas tendem a retornar para um n√≠vel m√©dio de longo prazo ap√≥s desvios [^21].

Um modelo comum para capturar essa caracter√≠stica √© o modelo de Vasicek, que √© uma extens√£o do modelo de Ornstein-Uhlenbeck. A equa√ß√£o diferencial estoc√°stica que descreve o modelo de Vasicek √© dada por:

$$ dr_t = \kappa (\theta - r_t) dt + \sigma dz \quad (12.10) $$

onde:

*   $dr_t$ √© a varia√ß√£o infinitesimal na taxa de juros no instante $t$.
*   $r_t$ √© a taxa de juros no instante $t$.
*   $\kappa$ √© a velocidade de revers√£o √† m√©dia.
*   $\theta$ √© o n√≠vel de revers√£o √† m√©dia de longo prazo.
*   $\sigma$ √© a volatilidade da taxa de juros.
*   $dz$ √© um incremento de um processo de Wiener (movimento Browniano padr√£o).

> üí° **Exemplo Num√©rico:**
>
> An√°lise do impacto da velocidade de revers√£o √† m√©dia ($\kappa$) no modelo de Vasicek.
>
> Simule trajet√≥rias de taxas de juros usando o modelo de Vasicek com diferentes valores de $\kappa$ (0.1, 0.3, 0.5) e compare como a velocidade de revers√£o afeta o comportamento das taxas.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros base
> r0 = 0.05
> theta = 0.05
> sigma = 0.02
> T = 1
> N = 252
> dt = T / N
>
> # Diferentes velocidades de revers√£o √† m√©dia
> kappas = [0.1, 0.3, 0.5]
>
> # Fun√ß√£o de simula√ß√£o (a mesma do exemplo anterior)
> def simulate_vasicek(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         r[t] = r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * dz
>     return r
>
> # Simular e plotar as trajet√≥rias para cada kappa
> plt.figure(figsize=(10, 6))
> for kappa in kappas:
>     r = simulate_vasicek(r0, kappa, theta, sigma, dt, N)
>     plt.plot(r, label=f'kappa = {kappa}')
>
> plt.xlabel('Tempo')
> plt.ylabel('Taxa de Juros')
> plt.title('Impacto da Velocidade de Revers√£o √† M√©dia (Modelo de Vasicek)')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este c√≥digo simula o modelo de Vasicek com diferentes valores de $\kappa$ e plota as trajet√≥rias resultantes. Observando o gr√°fico, pode-se notar que quanto maior o valor de $\kappa$, mais rapidamente a taxa de juros retorna ao n√≠vel de revers√£o √† m√©dia ($\theta$). Valores menores de $\kappa$ resultam em trajet√≥rias mais lentas e suaves.

Outro modelo popular √© o modelo de Cox-Ingersoll-Ross (CIR), que garante que a taxa de juros permane√ßa n√£o negativa. A equa√ß√£o diferencial estoc√°stica para o modelo CIR √© dada por:

$$ dr_t = \kappa (\theta - r_t) dt + \sigma \sqrt{r_t} dz $$

> üí° **Exemplo Num√©rico:**
>
> Simular e comparar os modelos de Vasicek e CIR para taxas de juros.
>
> Compare as trajet√≥rias das taxas de juros simuladas usando os modelos de Vasicek e CIR, destacando as diferen√ßas no comportamento e a garantia de n√£o negatividade do modelo CIR.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros base
> r0 = 0.05
> kappa = 0.3
> theta = 0.05
> sigma = 0.02
> T = 1
> N = 252
> dt = T / N
>
> # Fun√ß√£o de simula√ß√£o do modelo de Vasicek
> def simulate_vasicek(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         r[t] = r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * dz
>     return r
>
> # Fun√ß√£o de simula√ß√£o do modelo de CIR
> def simulate_cir(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         r[t] = max(0, r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * np.sqrt(r[t-1]) * dz)  # Garante n√£o negatividade
>     return r
>
> # Simular as trajet√≥rias
> r_vasicek = simulate_vasicek(r0, kappa, theta, sigma, dt, N)
> r_cir = simulate_cir(r0, kappa, theta, sigma, dt, N)
>
> # Plotar as trajet√≥rias
> plt.figure(figsize=(10, 6))
> plt.plot(r_vasicek, label='Modelo de Vasicek')
> plt.plot(r_cir, label='Modelo de CIR')
>
> plt.xlabel('Tempo')
> plt.ylabel('Taxa de Juros')
> plt.title('Compara√ß√£o dos Modelos de Vasicek e CIR')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este c√≥digo simula as trajet√≥rias de taxas de juros usando os modelos de Vasicek e CIR. A principal diferen√ßa entre os modelos √© que o modelo CIR garante que as taxas de juros permane√ßam n√£o negativas, o que √© uma caracter√≠stica importante para a modelagem de taxas de juros. O gr√°fico mostra como as trajet√≥rias dos dois modelos se comparam, destacando a n√£o negatividade do modelo CIR.
>
> üí° **Observa√ß√£o:** Em algumas simula√ß√µes do modelo de Vasicek, as taxas de juros podem se tornar negativas, especialmente com alta volatilidade. O modelo CIR evita essa situa√ß√£o.

> üí° **Exemplo Num√©rico:**
>
> Simular uma trajet√≥ria de taxas de juros usando o modelo de Vasicek com os seguintes par√¢metros:
>
> *   Taxa de juros inicial ($r_0$): 0.05 (5%)
> *   Velocidade de revers√£o √† m√©dia ($\kappa$): 0.3
> *   N√≠vel de revers√£o √† m√©dia ($\theta$): 0.05 (5%)
> *   Volatilidade ($\sigma$): 0.02 (2%)
> *   Horizonte de tempo (T): 1 ano
> *   N√∫mero de passos de tempo (N): 252 (simulando dias √∫teis)
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> r0 = 0.05       # Taxa de juros inicial
> kappa = 0.3     # Velocidade de revers√£o √† m√©dia
> theta = 0.05    # N√≠vel de revers√£o √† m√©dia
> sigma = 0.02    # Volatilidade
> T = 1           # Horizonte de tempo (anos)
> N = 252         # N√∫mero de passos de tempo
> dt = T / N      # Tamanho do passo de tempo
>
> # Simula√ß√£o
> def simulate_vasicek(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))  # Incremento do processo de Wiener
>         r[t] = r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * dz
>     return r
>
> # Executar a simula√ß√£o
> r = simulate_vasicek(r0, kappa, theta, sigma, dt, N)
>
> # Plotar a trajet√≥ria das taxas de juros
> plt.plot(r)
> plt.xlabel('Tempo')
> plt.ylabel('Taxa de Juros')
> plt.title('Simula√ß√£o do Modelo de Vasicek')
> plt.grid(True)
> plt.show()
> ```

*   Este gr√°fico ilustra como as taxas de juros tendem a reverter para o n√≠vel de longo prazo $\theta$.

![Simula√ß√£o Modelo de Vasicek](./../images/figure_vasicek.png)

**Teorema 2** (Solu√ß√£o Exata do Modelo de Vasicek).
A solu√ß√£o exata para o modelo de Vasicek √©:

$$r_t = \theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$$

*Prova*.
I. Come√ßamos com a equa√ß√£o diferencial estoc√°stica para o modelo de Vasicek:
$dr_t = \kappa (\theta - r_t) dt + \sigma dW_t$.

II. Multiplicamos ambos os lados por $e^{\kappa t}$:
$e^{\kappa t} dr_t + \kappa e^{\kappa t} r_t dt = \kappa \theta e^{\kappa t} dt + \sigma e^{\kappa t} dW_t$.

III. O lado esquerdo √© a diferencial de $e^{\kappa t} r_t$:
$d(e^{\kappa t} r_t) = \kappa \theta e^{\kappa t} dt + \sigma e^{\kappa t} dW_t$.

IV. Integramos de 0 a $t$:
$\int_0^t d(e^{\kappa s} r_s) = \int_0^t \kappa \theta e^{\kappa s} ds + \int_0^t \sigma e^{\kappa s} dW_s$.

V. Calculamos as integrais:
$e^{\kappa t} r_t - r_0 = \theta (e^{\kappa t} - 1) + \sigma \int_0^t e^{\kappa s} dW_s$.

VI. Rearranjamos para obter a solu√ß√£o:
$r_t = r_0 e^{-\kappa t} + \theta (1 - e^{-\kappa t}) + \sigma e^{-\kappa t} \int_0^t e^{\kappa s} dW_s$.

VII. Reescrevemos a solu√ß√£o como:
$r_t = \theta + (r_0 - \theta) e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$. $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> C√°lculo da taxa de juros em um tempo espec√≠fico usando a solu√ß√£o exata do modelo de Vasicek.
>
> Usando os par√¢metros do exemplo anterior ($r_0 = 0.05$, $\kappa = 0.3$, $\theta = 0.05$, $\sigma = 0.02$, $T = 1$), calcule a taxa de juros no final do ano (t = 1) para uma √∫nica simula√ß√£o onde a integral estoc√°stica $\int_0^t e^{-\kappa (t-s)} dW_s$ resulta em um valor de 0.01.
>
> $$r_t = \theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$$
>
> $$r_1 = 0.05 + (0.05 - 0.05)e^{-0.3 \times 1} + 0.02 \times 0.01$$
>
> $$r_1 = 0.05 + (0)e^{-0.3} + 0.0002$$
>
> $$r_1 = 0.05 + 0 + 0.0002$$
>
> $$r_1 = 0.0502$$
>
> Este c√°lculo mostra que, para uma √∫nica trajet√≥ria onde $\int_0^t e^{-\kappa (t-s)} dW_s = 0.01$, a taxa de juros no final do ano √© 0.0502 ou 5.02%. Este valor, como no exemplo do GBM, √© uma √∫nica realiza√ß√£o de muitas poss√≠veis.

**Lema 2.1** (M√©dia e Vari√¢ncia Assint√≥tica do Modelo de Vasicek).
A m√©dia e a vari√¢ncia assint√≥tica do modelo de Vasicek s√£o:
$$\lim_{t \to \infty} E[r_t] = \theta$$
$$\lim_{t \to \infty} Var[r_t] = \frac{\sigma^2}{2\kappa}$$

> üí° **Exemplo Num√©rico:**
>
> C√°lculo da vari√¢ncia assint√≥tica para diferentes valores de $\sigma$ e $\kappa$.
>
> Vamos calcular a vari√¢ncia assint√≥tica do modelo de Vasicek para diferentes combina√ß√µes de $\sigma$ e $\kappa$ e interpretar os resultados.
>
> *   Caso 1: $\sigma = 0.02$, $\kappa = 0.3$
> *   Caso 2: $\sigma = 0.03$, $\kappa = 0.3$
> *   Caso 3: $\sigma = 0.02$, $\kappa = 0.5$
>
> A vari√¢ncia assint√≥tica √© dada por:
>
> $$Var[r_\infty] = \frac{\sigma^2}{2\kappa}$$
>
> *   Caso 1:
>
>     $$Var[r_\infty] = \frac{(0.02)^2}{2 \times 0.3} = \frac{0.0004}{0.6} = 0.000667$$
>
> *   Caso 2:
>
>     $$Var[r_\infty] = \frac{(0.03)^2}{2 \times 0.3} = \frac{0.0009}{0.6} = 0.0015$$
>
> *   Caso 3:
>
>     $$Var[r_\infty] = \frac{(0.02)^2}{2 \times 0.5} = \frac{0.0004}{1.0} = 0.0004$$
>
> Interpretando os resultados:
>
> *   A vari√¢ncia assint√≥tica aumenta com o aumento da volatilidade ($\sigma$). Isso significa que, quanto mais vol√°til a taxa de juros, maior a dispers√£o em torno do seu n√≠vel m√©dio de longo prazo no longo prazo.
> *   A vari√¢ncia assint√≥tica diminui com o aumento da velocidade de revers√£o √† m√©dia ($\kappa$). Isso significa que, quanto mais r√°pido a taxa de juros retorna ao seu n√≠vel m√©dio, menor a dispers√£o em torno desse n√≠vel no longo prazo.

**Proposi√ß√£o 3** (A esperan√ßa $E[r_t]$ no modelo de Vasicek). Dado o modelo de Vasicek, a esperan√ßa de $r_t$ condicional a $r_0$ √© dada por:

$$ E[r_t | r_0] = \theta + (r_0 - \theta)e^{-\kappa t} $$

*Prova*.
I. A partir da solu√ß√£o do modelo de Vasicek no Teorema 2:
$r_t = \theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$

II. Calculamos a esperan√ßa condicional $E[r_t | r_0]$:
$E[r_t | r_0] = E[\theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s | r_0]$

III. Como a integral estoc√°stica tem esperan√ßa zero:
$E\left[\int_0^t e^{-\kappa (t-s)} dW_s\right] = 0$

IV. Portanto:
$E[r_t | r_0] = \theta + (r_0 - \theta)e^{-\kappa t}$ $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> C√°lculo da esperan√ßa condicional da taxa de juros para diferentes valores de $t$.
>
> Usando os par√¢metros $r_0 = 0.05$, $\theta = 0.04$ e $\kappa = 0.2$, calcule a esperan√ßa condicional da taxa de juros para $t = 1$ e $t = 5$ anos.
>
> Para $t = 1$:
>
> $$E[r_1 | r_0] = \theta + (r_0 - \theta)e^{-\kappa t}$$
> $$E[r_1 | r_0] = 0.04 + (0.05 - 0.04)e^{-0.2 \times 1}$$
> $$E[r_1 | r_0] = 0.04 + 0.01 \times e^{-0.2}$$
> $$E[r_1 | r_0] = 0.04 + 0.01 \times 0.8187$$
> $$E[r_1 | r_0] = 0.04 + 0.008187$$
> $$E[r_1 | r_0] = 0.048187$$
>
> Para $t = 5$:
>
> $$E[r_5 | r_0] = \theta + (r_0 - \theta)e^{-\kappa t}$$
> $$E[r_5 | r_0] = 0.04 + (0.05 - 0.04)e^{-0.2 \times 5}$$
> $$E[r_5 | r_0] = 0.04 + 0.01 \times e^{-1}$$
> $$E[r_5 | r_0] =0.04 + 0.01 \times 0.367879$$
> $$E[r_5 | r_0] = 0.04 + 0.00367879$$
> $$E[r_5 | r_0] = 0.04367879$$
>
> Portanto, a taxa de juros esperada em $t=5$, dado que a taxa inicial $r_0$ √© 5%, √© aproximadamente 4.37%.
>
> ### Vari√¢ncia de $r_t$ dado $r_0$
>
> A vari√¢ncia de $r_t$ dado $r_0$ no modelo de Vasicek √© dada por:
>
> $$Var(r_t | r_0) = \frac{\sigma^2}{2\kappa}(1 - e^{-2\kappa t})$$
>
> Onde:
>
> *   $\sigma$ √© a volatilidade da taxa de juros.
>
> Vamos calcular a vari√¢ncia para $t = 5$:
>
> Dados:
>
> *   $\sigma = 0.02$
> *   $\kappa = 0.2$
> *   $t = 5$
>
> $$Var(r_5 | r_0) = \frac{(0.02)^2}{2 \times 0.2}(1 - e^{-2 \times 0.2 \times 5})$$
> $$Var(r_5 | r_0) = \frac{0.0004}{0.4}(1 - e^{-2})$$
> $$Var(r_5 | r_0) = 0.001 \times (1 - 0.135335)$$
> $$Var(r_5 | r_0) = 0.001 \times 0.864665$$
> $$Var(r_5 | r_0) = 0.000864665$$
>
> Portanto, a vari√¢ncia da taxa de juros em $t=5$, dado $r_0$, √© aproximadamente 0.000865.
>
> ### Desvio Padr√£o de $r_t$ dado $r_0$
>
> O desvio padr√£o √© a raiz quadrada da vari√¢ncia:
>
> $$SD(r_t | r_0) = \sqrt{Var(r_t | r_0)}$$
>
> Para $t = 5$:
>
> $$SD(r_5 | r_0) = \sqrt{0.000864665}$$
> $$SD(r_5 | r_0) = 0.029405$$
>
> O desvio padr√£o da taxa de juros em $t=5$, dado $r_0$, √© aproximadamente 2.94%.
>
> ### Simula√ß√£o de Monte Carlo
>
> Para realizar uma simula√ß√£o de Monte Carlo do modelo de Vasicek, podemos discretizar a equa√ß√£o diferencial estoc√°stica usando o esquema de Euler.
>
> A equa√ß√£o discretizada √©:
>
> $$r_{t+1} = r_t + \kappa(\theta - r_t)\Delta t + \sigma \sqrt{\Delta t} \epsilon_i$$
>
> Onde:
>
> *   $\Delta t$ √© o tamanho do passo de tempo.
> *   $\epsilon_i$ √© um n√∫mero aleat√≥rio retirado de uma distribui√ß√£o normal padr√£o.
>
> Vamos simular 1000 caminhos de taxas de juros para um per√≠odo de 5 anos, com passos de tempo mensais ($\Delta t = 1/12$).
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> r0 = 0.05
> theta = 0.04
> kappa = 0.2
> sigma = 0.02
> T = 5
> dt = 1/12
> N = int(T/dt)
> n_simulations = 1000
>
> # Inicializa√ß√£o
> np.random.seed(42)  # Para reproducibilidade
> rates = np.zeros((N + 1, n_simulations))
> rates[0, :] = r0
>
> # Simula√ß√£o de Monte Carlo
> for t in range(N):
>     dW = np.random.normal(0, np.sqrt(dt), n_simulations)
>     rates[t+1, :] = rates[t, :] + kappa * (theta - rates[t, :]) * dt + sigma * dW
>
> # Plot dos resultados
> time = np.linspace(0, T, N + 1)
> plt.figure(figsize=(12, 6))
> for i in range(n_simulations):
>     plt.plot(time, rates[:, i], alpha=0.1)
> plt.xlabel("Tempo (anos)")
> plt.ylabel("Taxa de Juros")
> plt.title("Simula√ß√£o de Monte Carlo do Modelo de Vasicek")
> plt.grid(True)
> plt.show()
>
> # C√°lculo de estat√≠sticas
> expected_rate = np.mean(rates[-1, :])
> std_rate = np.std(rates[-1, :])
>
> print(f"Taxa de juros esperada em T={T} anos: {expected_rate:.4f}")
> print(f"Desvio padr√£o da taxa de juros em T={T} anos: {std_rate:.4f}")
> ```
>
> Este c√≥digo realiza uma simula√ß√£o de Monte Carlo do modelo de Vasicek e plota os caminhos simulados das taxas de juros. Al√©m disso, calcula a taxa de juros esperada e o desvio padr√£o no final do per√≠odo de simula√ß√£o.
>
> ### Precifica√ß√£o de T√≠tulos de Renda Fixa (Bonds)
>
> No modelo de Vasicek, o pre√ßo de um t√≠tulo de renda fixa (bond) no tempo $t$ com vencimento em $T$ √© dado por:
>
> $$P(t, T) = A(t, T)e^{-B(t, T)r_t}$$
>
> Onde:
>
> $$B(t, T) = \frac{1 - e^{-\kappa(T-t)}}{\kappa}$$
>
> $$A(t, T) = e^{\frac{( \theta - \frac{\sigma^2}{2\kappa^2} ) (B(t, T) - (T-t)) - \frac{\sigma^2}{4\kappa}B(t, T)^2 }}{}}$$
>
> Vamos calcular $A(t, T)$ e $B(t, T)$ para precificar um t√≠tulo.
>
> Dados:
>
> *   $t = 0$ (tempo atual)
> *   $T = 5$ (vencimento em 5 anos)
> *   $r_0 = 0.05$ (taxa de juros atual)
> *   $\theta = 0.04$
> *   $\kappa = 0.2$
> *   $\sigma = 0.02$
>
> Primeiro, calculamos $B(0, 5)$:
>
> $$B(0, 5) = \frac{1 - e^{-0.2 \times 5}}{0.2}$$
> $$B(0, 5) = \frac{1 - e^{-1}}{0.2}$$
> $$B(0, 5) = \frac{1 - 0.367879}{0.2}$$
> $$B(0, 5) = \frac{0.632121}{0.2}$$
> $$B(0, 5) = 3.160605$$
>
> Agora, calculamos $A(0, 5)$:
>
> $$A(0, 5) = e^{\frac{(0.04 - \frac{(0.02)^2}{2 \times (0.2)^2}) (3.160605 - 5) - \frac{(0.02)^2}{4 \times 0.2}(3.160605)^2}{}}$$
> $$A(0, 5) = e^{\frac{(0.04 - \frac{0.0004}{0.08}) (-1.839395) - \frac{0.0004}{0.8}(9.989436)}{}}$$
> $$A(0, 5) = e^{\frac{(0.04 - 0.005) (-1.839395) - 0.0005(9.989436)}{}}$$
> $$A(0, 5) = e^{\frac{0.035 \times (-1.839395) - 0.004994718}{}}$$
> $$A(0, 5) = e^{\frac{-0.064378825 - 0.004994718}{}}$$
> $$A(0, 5) = e^{-0.069373543}$$
> $$A(0, 5) = 0.93295$$
>
> Finalmente, calculamos o pre√ßo do t√≠tulo:
>
> $$P(0, 5) = 0.93295 \times e^{-3.160605 \times 0.05}$$
> $$P(0, 5) = 0.93295 \times e^{-0.15803}$$
> $$P(0, 5) = 0.93295 \times 0.85365$$
> $$P(0, 5) = 0.79622$$
>
> Portanto, o pre√ßo do t√≠tulo de renda fixa √© aproximadamente 0.79622.
>
> ### Calibra√ß√£o do Modelo
>
> A calibra√ß√£o do modelo de Vasicek envolve a estima√ß√£o dos par√¢metros $\kappa$, $\theta$ e $\sigma$ a partir de dados de mercado. Existem v√°rias abordagens para isso, incluindo m√©todos de m√°xima verossimilhan√ßa e m√©todos baseados em momentos. A escolha do m√©todo depende da disponibilidade e qualidade dos dados, bem como das propriedades estat√≠sticas desejadas para os estimadores.
>
> ### Limita√ß√µes e Extens√µes
>
> O modelo de Vasicek tem algumas limita√ß√µes:
>
> 1.  **Taxas de juros negativas:** O modelo permite taxas de juros negativas, o que pode n√£o ser realista em todos os contextos.
> 2.  **Distribui√ß√£o normal:** Assume que os choques nas taxas de juros seguem uma distribui√ß√£o normal, o que pode n√£o capturar adequadamente caudas grossas ou assimetrias observadas em dados reais.
> 3.  **Par√¢metros constantes:** Assume que os par√¢metros $\kappa$, $\theta$ e $\sigma$ s√£o constantes ao longo do tempo, o que pode n√£o ser v√°lido na pr√°tica.
>
> Existem v√°rias extens√µes do modelo de Vasicek que tentam abordar essas limita√ß√µes. Algumas delas incluem:
>
> *   **Modelo de Cox-Ingersoll-Ross (CIR):** Este modelo restringe as taxas de juros a serem n√£o negativas.
> *   **Modelos de salto-difus√£o:** Incorporam saltos aleat√≥rios nas taxas de juros para capturar eventos inesperados e caudas grossas.
> *   **Modelos de estrutura a termo din√¢micos:** Permitem que os par√¢metros do modelo variem ao longo do tempo, capturando a din√¢mica da estrutura a termo.
>
> ### Conclus√£o
>
> O modelo de Vasicek √© uma ferramenta √∫til para modelar a din√¢mica das taxas de juros e precificar t√≠tulos de renda fixa. Embora tenha algumas limita√ß√µes, ele fornece uma estrutura simples e intuitiva que pode ser estendida e adaptada para atender a diferentes necessidades e contextos. A simula√ß√£o de Monte Carlo e a precifica√ß√£o de t√≠tulos s√£o aplica√ß√µes pr√°ticas importantes do modelo.
### Pr√≥ximos Passos e Considera√ß√µes Finais

O modelo de Black-Scholes √© uma ferramenta poderosa, mas √© crucial estar ciente de suas limita√ß√µes e suposi√ß√µes subjacentes. A volatilidade constante, a aus√™ncia de custos de transa√ß√£o e a negocia√ß√£o cont√≠nua s√£o idealiza√ß√µes que nem sempre se mant√™m na realidade.

#### Ajustes e Extens√µes do Modelo

V√°rios modelos foram desenvolvidos para mitigar as limita√ß√µes do modelo de Black-Scholes. Modelos de volatilidade estoc√°stica, como o modelo de Heston, permitem que a volatilidade varie aleatoriamente ao longo do tempo, tornando-os mais adequados para mercados vol√°teis. Modelos de salto-difus√£o, como o modelo de Merton, incorporam a possibilidade de saltos s√∫bitos no pre√ßo do ativo subjacente, capturando eventos de mercado inesperados.

#### Riscos e Oportunidades

A modelagem de op√ß√µes oferece oportunidades significativas para investidores e gestores de risco. Estrat√©gias como *covered calls*, *protective puts* e *straddles* podem ser implementadas usando op√ß√µes para gerenciar o risco e aumentar o retorno. No entanto, a negocia√ß√£o de op√ß√µes tamb√©m envolve riscos, como o risco de tempo, o risco de volatilidade e o risco de liquidez.

#### Aplica√ß√µes Adicionais

O modelo de Black-Scholes e suas extens√µes s√£o usados em uma variedade de aplica√ß√µes financeiras al√©m da precifica√ß√£o de op√ß√µes. Eles s√£o usados na avalia√ß√£o de garantias reais, na gest√£o de carteiras e na modelagem de risco de cr√©dito. A capacidade de quantificar o valor do tempo e da incerteza torna esses modelos indispens√°veis para a tomada de decis√µes financeiras.

### Gloss√°rio

*   **Ativo Subjacente:** O ativo no qual a op√ß√£o √© baseada, como a√ß√µes, t√≠tulos ou commodities.
*   **Call:** Uma op√ß√£o que d√° ao titular o direito, mas n√£o a obriga√ß√£o, de comprar o ativo subjacente a um pre√ßo especificado.
*   **Derivativo:** Um contrato financeiro cujo valor √© derivado de outro ativo.
*   **Dividendos:** Pagamentos feitos por uma empresa aos seus acionistas.
*   **Exerc√≠cio:** O ato de exercer o direito concedido por uma op√ß√£o.
*   **Op√ß√£o Americana:** Uma op√ß√£o que pode ser exercida a qualquer momento at√© a data de vencimento.
*   **Op√ß√£o Europeia:** Uma op√ß√£o que s√≥ pode ser exercida na data de vencimento.
*   **Paridade Put-Call:** Uma rela√ß√£o que descreve a rela√ß√£o entre os pre√ßos das op√ß√µes de compra e venda com o mesmo ativo subjacente, pre√ßo de exerc√≠cio e data de vencimento.
*   **Pr√™mio:** O pre√ßo pago para comprar uma op√ß√£o.
*   **Put:** Uma op√ß√£o que d√° ao titular o direito, mas n√£o a obriga√ß√£o, de vender o ativo subjacente a um pre√ßo especificado.
*   **Taxa Livre de Risco:** A taxa de retorno de um investimento sem risco, como um t√≠tulo do governo.
*   **Volatilidade:** Uma medida de quanto o pre√ßo de um ativo tende a flutuar.

### Refer√™ncias

*   Black, F., & Scholes, M. (1973). The Pricing of Options and Corporate Liabilities. *Journal of Political Economy, 81*(3), 637-654.
*   Hull, J. C. (2018). *Options, futures, and other derivatives*. Pearson Education.
*   Merton, R. C. (1973). Theory of Rational Option Pricing. *The Bell Journal of Economics and Management Science, 4*(1), 141-183.

<!-- END -->