### Modelos EstocÃ¡sticos em MÃ©todos de Monte Carlo: Movimento Browniano GeomÃ©trico e Processos de ReversÃ£o Ã  MÃ©dia

### IntroduÃ§Ã£o

Em continuidade aos capÃ­tulos anteriores sobre mÃ©todos de Monte Carlo [^1], este capÃ­tulo explora em profundidade a crucial etapa de escolha de modelos estocÃ¡sticos para simular a evoluÃ§Ã£o de preÃ§os de ativos financeiros, com foco especial no Movimento Browniano GeomÃ©trico (GBM) e em modelos que incorporam reversÃ£o Ã  mÃ©dia [^3]. A seleÃ§Ã£o do modelo estocÃ¡stico apropriado Ã© fundamental para garantir a precisÃ£o e a relevÃ¢ncia das simulaÃ§Ãµes de Monte Carlo, e por conseguinte, para a tomada de decisÃµes de gestÃ£o de risco e avaliaÃ§Ã£o de ativos [^1, 2]. Como visto anteriormente, as simulaÃ§Ãµes de Monte Carlo sÃ£o baseadas em sorteios aleatÃ³rios de variÃ¡veis com a distribuiÃ§Ã£o de probabilidade desejada [^1, 6, 7]. A escolha do modelo estocÃ¡stico dita a forma como esses sorteios aleatÃ³rios sÃ£o interpretados e como os preÃ§os dos ativos evoluem ao longo do tempo [^1, 2, 3, 4, 6, 7]. Complementando a introduÃ§Ã£o podemos dizer tambÃ©m que a escolha de modelos estocÃ¡sticos mais precisos e apropriados pode melhorar significativamente a validade das simulaÃ§Ãµes, e com isso, a anÃ¡lise de risco e a avaliaÃ§Ã£o de ativos no contexto do mÃ©todos de Monte Carlo [^1, 2, 3, 4, 6, 7].

### Conceitos Fundamentais

**Movimento Browniano GeomÃ©trico (GBM)**

Como mencionado anteriormente, o Movimento Browniano GeomÃ©trico (GBM) Ã© um modelo amplamente utilizado para simular a evoluÃ§Ã£o de preÃ§os de ativos, especialmente aÃ§Ãµes e outras classes de ativos com comportamento semelhante [^3]. O modelo assume que as variaÃ§Ãµes no preÃ§o do ativo sÃ£o independentes e identicamente distribuÃ­das (i.i.d.) ao longo do tempo, e que o logaritmo do preÃ§o do ativo segue um processo de Wiener (movimento Browniano) com *drift* [^3].

A equaÃ§Ã£o diferencial estocÃ¡stica que descreve o GBM Ã© dada por:

$$ dS_t = \mu S_t dt + \sigma S_t dz \quad (12.1) $$

onde:

*   $dS_t$ Ã© a variaÃ§Ã£o infinitesimal no preÃ§o do ativo no instante $t$.
*   $S_t$ Ã© o preÃ§o do ativo no instante $t$.
*   $\mu$ Ã© a taxa de retorno esperada (drift) do ativo.
*   $\sigma$ Ã© a volatilidade do ativo.
*   $dz$ Ã© um incremento de um processo de Wiener (movimento Browniano padrÃ£o), que Ã© uma variÃ¡vel aleatÃ³ria normalmente distribuÃ­da com mÃ©dia zero e variÃ¢ncia $dt$.

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> Simular uma trajetÃ³ria de preÃ§os usando o modelo GBM com os seguintes parÃ¢metros:
>
> *   PreÃ§o inicial do ativo ($S_0$): 100
> *   Taxa de retorno esperada ($\mu$): 0.1 (10% ao ano)
> *   Volatilidade ($\sigma$): 0.2 (20% ao ano)
> *   Horizonte de tempo (T): 1 ano
> *   NÃºmero de passos de tempo (N): 252 (simulando dias Ãºteis)
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros
> S0 = 100        # PreÃ§o inicial do ativo
> mu = 0.1        # Taxa de retorno esperada
> sigma = 0.2     # Volatilidade
> T = 1           # Horizonte de tempo (anos)
> N = 252         # NÃºmero de passos de tempo
> dt = T / N      # Tamanho do passo de tempo
>
> # SimulaÃ§Ã£o
> def simulate_gbm(S0, mu, sigma, dt, N):
>     S = np.zeros(N + 1)
>     S[0] = S0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))  # Incremento do processo de Wiener
>         S[t] = S[t-1] * np.exp((mu - 0.5 * sigma**2) * dt + sigma * dz)
>     return S
>
> # Executar a simulaÃ§Ã£o
> S = simulate_gbm(S0, mu, sigma, dt, N)
>
> # Plotar a trajetÃ³ria de preÃ§os
> plt.plot(S)
> plt.xlabel('Tempo')
> plt.ylabel('PreÃ§o do Ativo')
> plt.title('SimulaÃ§Ã£o de Movimento Browniano GeomÃ©trico')
> plt.grid(True)
> plt.show()
> ```
![SimulaÃ§Ã£o do Modelo GBM](./../images/figure_gbm.png)

> ðŸ’¡ **Exemplo NumÃ©rico:** AnÃ¡lise da distribuiÃ§Ã£o dos preÃ§os simulados.
>
> ApÃ³s simular vÃ¡rias trajetÃ³rias de preÃ§os usando o modelo GBM, podemos analisar a distribuiÃ§Ã£o dos preÃ§os no final do horizonte de tempo (T). Isso nos permite estimar a probabilidade de o preÃ§o do ativo estar acima ou abaixo de um determinado nÃ­vel.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros (os mesmos do exemplo anterior)
> S0 = 100
> mu = 0.1
> sigma = 0.2
> T = 1
> N = 252
> dt = T / N
> num_simulations = 1000  # NÃºmero de simulaÃ§Ãµes
>
> # FunÃ§Ã£o de simulaÃ§Ã£o (a mesma do exemplo anterior)
> def simulate_gbm(S0, mu, sigma, dt, N):
>     S = np.zeros(N + 1)
>     S[0] = S0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         S[t] = S[t-1] * np.exp((mu - 0.5 * sigma**2) * dt + sigma * dz)
>     return S
>
> # Simular vÃ¡rias trajetÃ³rias
> final_prices = []
> for _ in range(num_simulations):
>     S = simulate_gbm(S0, mu, sigma, dt, N)
>     final_prices.append(S[-1])
>
> # AnÃ¡lise da distribuiÃ§Ã£o
> final_prices = np.array(final_prices)
> mean_final_price = np.mean(final_prices)
> std_final_price = np.std(final_prices)
>
> # Plotar o histograma dos preÃ§os finais
> plt.hist(final_prices, bins=30, density=True, alpha=0.6, color='g')
> plt.xlabel('PreÃ§o Final do Ativo')
> plt.ylabel('Densidade')
> plt.title('DistribuiÃ§Ã£o dos PreÃ§os Finais (GBM)')
> plt.grid(True)
> plt.show()
>
> # Calcular a probabilidade de o preÃ§o estar acima de um certo valor (ex: 120)
> prob_above_120 = np.mean(final_prices > 120)
> print(f"PreÃ§o mÃ©dio final: {mean_final_price:.2f}")
> print(f"Desvio padrÃ£o dos preÃ§os finais: {std_final_price:.2f}")
> print(f"Probabilidade de o preÃ§o final ser maior que 120: {prob_above_120:.2f}")
> ```
>
> Este cÃ³digo simula 1000 trajetÃ³rias e mostra um histograma dos preÃ§os finais. Ele tambÃ©m calcula a probabilidade de o preÃ§o final ser maior que 120, fornecendo uma medida de risco. A anÃ¡lise da distribuiÃ§Ã£o permite entender a incerteza associada Ã  evoluÃ§Ã£o do preÃ§o do ativo e quantificar o risco de diferentes cenÃ¡rios.

**Teorema 1** (SoluÃ§Ã£o Exata do GBM).
A soluÃ§Ã£o da equaÃ§Ã£o diferencial estocÃ¡stica do GBM Ã© dada por:

$$ S_t = S_0 \exp\left( (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t \right) $$

onde $S_0$ Ã© o preÃ§o inicial do ativo e $W_t$ Ã© um processo de Wiener padrÃ£o no tempo $t$.

*Prova*.
I. Aplique o lema de Ito Ã  funÃ§Ã£o $f(S) = \ln(S)$.

II. As derivadas de $f(S)$ sÃ£o:
$$\frac{\partial f}{\partial S} = \frac{1}{S}, \quad \frac{\partial^2 f}{\partial S^2} = -\frac{1}{S^2}$$

III. Pelo lema de Ito, temos:
$$d(\ln(S_t)) = \left(\mu - \frac{1}{2}\sigma^2\right)dt + \sigma dW_t$$

IV. Integrando ambos os lados de 0 a t, obtemos:
$$\int_0^t d(\ln(S_u)) = \int_0^t \left(\mu - \frac{1}{2}\sigma^2\right)du + \int_0^t \sigma dW_u$$

V. Resolvendo as integrais, temos:
$$\ln(S_t) - \ln(S_0) = \left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma W_t$$

VI. Exponenciando ambos os lados, obtemos:
$$S_t = S_0 \exp\left( \left(\mu - \frac{1}{2}\sigma^2\right)t + \sigma W_t \right)$$

VII. Esta Ã© a soluÃ§Ã£o exata do GBM. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> CÃ¡lculo do preÃ§o do ativo em um tempo especÃ­fico usando a soluÃ§Ã£o exata do GBM.
>
> Usando os mesmos parÃ¢metros do exemplo anterior ($S_0 = 100$, $\mu = 0.1$, $\sigma = 0.2$, $T = 1$), calcule o preÃ§o do ativo no final do ano (t = 1) para uma Ãºnica simulaÃ§Ã£o onde o processo de Wiener $W_t$ resulta em um valor de 0.1.
>
> $$ S_t = S_0 \exp\left( (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t \right) $$
>
> $$ S_1 = 100 \exp\left( (0.1 - \frac{1}{2}(0.2)^2)(1) + 0.2 \times 0.1 \right) $$
>
> $$ S_1 = 100 \exp\left( (0.1 - 0.02) + 0.02 \right) $$
>
> $$ S_1 = 100 \exp\left( 0.08 + 0.02 \right) $$
>
> $$ S_1 = 100 \exp\left( 0.1 \right) $$
>
> $$ S_1 = 100 \times 1.10517 $$
>
> $$ S_1 = 110.52 $$
>
> Este cÃ¡lculo mostra que, para uma Ãºnica trajetÃ³ria onde $W_t = 0.1$, o preÃ§o do ativo no final do ano Ã© aproximadamente 110.52. Este valor Ã© uma Ãºnica realizaÃ§Ã£o de muitas possÃ­veis, refletindo a natureza estocÃ¡stica do modelo.

**Teorema 1.1** (DistribuiÃ§Ã£o de $S_t$ sob o GBM). Dado o Teorema 1, o preÃ§o do ativo $S_t$ no tempo $t$, condicional ao preÃ§o inicial $S_0$, segue uma distribuiÃ§Ã£o log-normal.

*Prova*.
I. Do Teorema 1, temos $S_t = S_0 \exp\left( (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t \right)$.
II. Tomando o logaritmo natural de ambos os lados, obtemos $\ln(S_t) = \ln(S_0) + (\mu - \frac{1}{2}\sigma^2)t + \sigma W_t$.
III. Como $W_t \sim N(0, t)$, entÃ£o $\ln(S_t)$ Ã© uma variÃ¡vel normal com mÃ©dia $\ln(S_0) + (\mu - \frac{1}{2}\sigma^2)t$ e variÃ¢ncia $\sigma^2 t$.
IV. Portanto, $S_t$ segue uma distribuiÃ§Ã£o log-normal. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> VerificaÃ§Ã£o da distribuiÃ§Ã£o log-normal dos preÃ§os simulados.
>
> Para verificar que os preÃ§os simulados no exemplo anterior (distribuiÃ§Ã£o dos preÃ§os simulados) seguem uma distribuiÃ§Ã£o log-normal, podemos ajustar uma distribuiÃ§Ã£o log-normal aos dados simulados e comparar os parÃ¢metros.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from scipy.stats import lognorm
>
> # ParÃ¢metros (os mesmos do exemplo anterior)
> S0 = 100
> mu = 0.1
> sigma = 0.2
> T = 1
> N = 252
> dt = T / N
> num_simulations = 1000
>
> # FunÃ§Ã£o de simulaÃ§Ã£o (a mesma do exemplo anterior)
> def simulate_gbm(S0, mu, sigma, dt, N):
>     S = np.zeros(N + 1)
>     S[0] = S0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         S[t] = S[t-1] * np.exp((mu - 0.5 * sigma**2) * dt + sigma * dz)
>     return S
>
> # Simular vÃ¡rias trajetÃ³rias
> final_prices = []
> for _ in range(num_simulations):
>     S = simulate_gbm(S0, mu, sigma, dt, N)
>     final_prices.append(S[-1])
>
> # Ajustar a distribuiÃ§Ã£o log-normal aos dados
> final_prices = np.array(final_prices)
> shape, loc, scale = lognorm.fit(final_prices)
>
> # ParÃ¢metros estimados da distribuiÃ§Ã£o log-normal
> print(f"Shape (sigma estimado): {shape:.2f}")
> print(f"Scale (exp(mu) estimado): {scale:.2f}")
>
> # Plotar o histograma dos preÃ§os finais e a distribuiÃ§Ã£o log-normal ajustada
> x = np.linspace(min(final_prices), max(final_prices), 100)
> pdf = lognorm.pdf(x, shape, loc, scale)
>
> plt.hist(final_prices, bins=30, density=True, alpha=0.6, color='g', label='PreÃ§os Simulados')
> plt.plot(x, pdf, 'k', linewidth=2, label='DistribuiÃ§Ã£o Log-Normal Ajustada')
> plt.xlabel('PreÃ§o Final do Ativo')
> plt.ylabel('Densidade')
> plt.title('Ajuste da DistribuiÃ§Ã£o Log-Normal aos PreÃ§os Finais (GBM)')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este cÃ³digo ajusta uma distribuiÃ§Ã£o log-normal aos preÃ§os finais simulados e imprime os parÃ¢metros estimados. Comparando esses parÃ¢metros com os parÃ¢metros de entrada do modelo GBM, podemos verificar se a distribuiÃ§Ã£o dos preÃ§os simulados Ã© consistente com a teoria. O grÃ¡fico tambÃ©m compara visualmente o histograma dos preÃ§os simulados com a funÃ§Ã£o densidade de probabilidade (PDF) da distribuiÃ§Ã£o log-normal ajustada.

**Modelos de ReversÃ£o Ã  MÃ©dia para Taxas de Juros**

Embora o GBM seja adequado para modelar a evoluÃ§Ã£o de preÃ§os de ativos, ele nÃ£o Ã© apropriado para modelar taxas de juros [^2, 3, 21]. As taxas de juros tendem a exibir um comportamento de *reversÃ£o Ã  mÃ©dia*, ou seja, elas tendem a retornar para um nÃ­vel mÃ©dio de longo prazo apÃ³s desvios [^21].

Um modelo comum para capturar essa caracterÃ­stica Ã© o modelo de Vasicek, que Ã© uma extensÃ£o do modelo de Ornstein-Uhlenbeck. A equaÃ§Ã£o diferencial estocÃ¡stica que descreve o modelo de Vasicek Ã© dada por:

$$ dr_t = \kappa (\theta - r_t) dt + \sigma dz \quad (12.10) $$

onde:

*   $dr_t$ Ã© a variaÃ§Ã£o infinitesimal na taxa de juros no instante $t$.
*   $r_t$ Ã© a taxa de juros no instante $t$.
*   $\kappa$ Ã© a velocidade de reversÃ£o Ã  mÃ©dia.
*   $\theta$ Ã© o nÃ­vel de reversÃ£o Ã  mÃ©dia de longo prazo.
*   $\sigma$ Ã© a volatilidade da taxa de juros.
*   $dz$ Ã© um incremento de um processo de Wiener (movimento Browniano padrÃ£o).

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> AnÃ¡lise do impacto da velocidade de reversÃ£o Ã  mÃ©dia ($\kappa$) no modelo de Vasicek.
>
> Simule trajetÃ³rias de taxas de juros usando o modelo de Vasicek com diferentes valores de $\kappa$ (0.1, 0.3, 0.5) e compare como a velocidade de reversÃ£o afeta o comportamento das taxas.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros base
> r0 = 0.05
> theta = 0.05
> sigma = 0.02
> T = 1
> N = 252
> dt = T / N
>
> # Diferentes velocidades de reversÃ£o Ã  mÃ©dia
> kappas = [0.1, 0.3, 0.5]
>
> # FunÃ§Ã£o de simulaÃ§Ã£o (a mesma do exemplo anterior)
> def simulate_vasicek(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         r[t] = r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * dz
>     return r
>
> # Simular e plotar as trajetÃ³rias para cada kappa
> plt.figure(figsize=(10, 6))
> for kappa in kappas:
>     r = simulate_vasicek(r0, kappa, theta, sigma, dt, N)
>     plt.plot(r, label=f'kappa = {kappa}')
>
> plt.xlabel('Tempo')
> plt.ylabel('Taxa de Juros')
> plt.title('Impacto da Velocidade de ReversÃ£o Ã  MÃ©dia (Modelo de Vasicek)')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este cÃ³digo simula o modelo de Vasicek com diferentes valores de $\kappa$ e plota as trajetÃ³rias resultantes. Observando o grÃ¡fico, pode-se notar que quanto maior o valor de $\kappa$, mais rapidamente a taxa de juros retorna ao nÃ­vel de reversÃ£o Ã  mÃ©dia ($\theta$). Valores menores de $\kappa$ resultam em trajetÃ³rias mais lentas e suaves.

Outro modelo popular Ã© o modelo de Cox-Ingersoll-Ross (CIR), que garante que a taxa de juros permaneÃ§a nÃ£o negativa. A equaÃ§Ã£o diferencial estocÃ¡stica para o modelo CIR Ã© dada por:

$$ dr_t = \kappa (\theta - r_t) dt + \sigma \sqrt{r_t} dz $$

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> Simular e comparar os modelos de Vasicek e CIR para taxas de juros.
>
> Compare as trajetÃ³rias das taxas de juros simuladas usando os modelos de Vasicek e CIR, destacando as diferenÃ§as no comportamento e a garantia de nÃ£o negatividade do modelo CIR.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros base
> r0 = 0.05
> kappa = 0.3
> theta = 0.05
> sigma = 0.02
> T = 1
> N = 252
> dt = T / N
>
> # FunÃ§Ã£o de simulaÃ§Ã£o do modelo de Vasicek
> def simulate_vasicek(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         r[t] = r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * dz
>     return r
>
> # FunÃ§Ã£o de simulaÃ§Ã£o do modelo de CIR
> def simulate_cir(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))
>         r[t] = max(0, r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * np.sqrt(r[t-1]) * dz)  # Garante nÃ£o negatividade
>     return r
>
> # Simular as trajetÃ³rias
> r_vasicek = simulate_vasicek(r0, kappa, theta, sigma, dt, N)
> r_cir = simulate_cir(r0, kappa, theta, sigma, dt, N)
>
> # Plotar as trajetÃ³rias
> plt.figure(figsize=(10, 6))
> plt.plot(r_vasicek, label='Modelo de Vasicek')
> plt.plot(r_cir, label='Modelo de CIR')
>
> plt.xlabel('Tempo')
> plt.ylabel('Taxa de Juros')
> plt.title('ComparaÃ§Ã£o dos Modelos de Vasicek e CIR')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este cÃ³digo simula as trajetÃ³rias de taxas de juros usando os modelos de Vasicek e CIR. A principal diferenÃ§a entre os modelos Ã© que o modelo CIR garante que as taxas de juros permaneÃ§am nÃ£o negativas, o que Ã© uma caracterÃ­stica importante para a modelagem de taxas de juros. O grÃ¡fico mostra como as trajetÃ³rias dos dois modelos se comparam, destacando a nÃ£o negatividade do modelo CIR.
>
> ðŸ’¡ **ObservaÃ§Ã£o:** Em algumas simulaÃ§Ãµes do modelo de Vasicek, as taxas de juros podem se tornar negativas, especialmente com alta volatilidade. O modelo CIR evita essa situaÃ§Ã£o.

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> Simular uma trajetÃ³ria de taxas de juros usando o modelo de Vasicek com os seguintes parÃ¢metros:
>
> *   Taxa de juros inicial ($r_0$): 0.05 (5%)
> *   Velocidade de reversÃ£o Ã  mÃ©dia ($\kappa$): 0.3
> *   NÃ­vel de reversÃ£o Ã  mÃ©dia ($\theta$): 0.05 (5%)
> *   Volatilidade ($\sigma$): 0.02 (2%)
> *   Horizonte de tempo (T): 1 ano
> *   NÃºmero de passos de tempo (N): 252 (simulando dias Ãºteis)
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros
> r0 = 0.05       # Taxa de juros inicial
> kappa = 0.3     # Velocidade de reversÃ£o Ã  mÃ©dia
> theta = 0.05    # NÃ­vel de reversÃ£o Ã  mÃ©dia
> sigma = 0.02    # Volatilidade
> T = 1           # Horizonte de tempo (anos)
> N = 252         # NÃºmero de passos de tempo
> dt = T / N      # Tamanho do passo de tempo
>
> # SimulaÃ§Ã£o
> def simulate_vasicek(r0, kappa, theta, sigma, dt, N):
>     r = np.zeros(N + 1)
>     r[0] = r0
>     for t in range(1, N + 1):
>         dz = np.random.normal(0, np.sqrt(dt))  # Incremento do processo de Wiener
>         r[t] = r[t-1] + kappa * (theta - r[t-1]) * dt + sigma * dz
>     return r
>
> # Executar a simulaÃ§Ã£o
> r = simulate_vasicek(r0, kappa, theta, sigma, dt, N)
>
> # Plotar a trajetÃ³ria das taxas de juros
> plt.plot(r)
> plt.xlabel('Tempo')
> plt.ylabel('Taxa de Juros')
> plt.title('SimulaÃ§Ã£o do Modelo de Vasicek')
> plt.grid(True)
> plt.show()
> ```

*   Este grÃ¡fico ilustra como as taxas de juros tendem a reverter para o nÃ­vel de longo prazo $\theta$.

![SimulaÃ§Ã£o Modelo de Vasicek](./../images/figure_vasicek.png)

**Teorema 2** (SoluÃ§Ã£o Exata do Modelo de Vasicek).
A soluÃ§Ã£o exata para o modelo de Vasicek Ã©:

$$r_t = \theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$$

*Prova*.
I. ComeÃ§amos com a equaÃ§Ã£o diferencial estocÃ¡stica para o modelo de Vasicek:
$dr_t = \kappa (\theta - r_t) dt + \sigma dW_t$.

II. Multiplicamos ambos os lados por $e^{\kappa t}$:
$e^{\kappa t} dr_t + \kappa e^{\kappa t} r_t dt = \kappa \theta e^{\kappa t} dt + \sigma e^{\kappa t} dW_t$.

III. O lado esquerdo Ã© a diferencial de $e^{\kappa t} r_t$:
$d(e^{\kappa t} r_t) = \kappa \theta e^{\kappa t} dt + \sigma e^{\kappa t} dW_t$.

IV. Integramos de 0 a $t$:
$\int_0^t d(e^{\kappa s} r_s) = \int_0^t \kappa \theta e^{\kappa s} ds + \int_0^t \sigma e^{\kappa s} dW_s$.

V. Calculamos as integrais:
$e^{\kappa t} r_t - r_0 = \theta (e^{\kappa t} - 1) + \sigma \int_0^t e^{\kappa s} dW_s$.

VI. Rearranjamos para obter a soluÃ§Ã£o:
$r_t = r_0 e^{-\kappa t} + \theta (1 - e^{-\kappa t}) + \sigma e^{-\kappa t} \int_0^t e^{\kappa s} dW_s$.

VII. Reescrevemos a soluÃ§Ã£o como:
$r_t = \theta + (r_0 - \theta) e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> CÃ¡lculo da taxa de juros em um tempo especÃ­fico usando a soluÃ§Ã£o exata do modelo de Vasicek.
>
> Usando os parÃ¢metros do exemplo anterior ($r_0 = 0.05$, $\kappa = 0.3$, $\theta = 0.05$, $\sigma = 0.02$, $T = 1$), calcule a taxa de juros no final do ano (t = 1) para uma Ãºnica simulaÃ§Ã£o onde a integral estocÃ¡stica $\int_0^t e^{-\kappa (t-s)} dW_s$ resulta em um valor de 0.01.
>
> $$r_t = \theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$$
>
> $$r_1 = 0.05 + (0.05 - 0.05)e^{-0.3 \times 1} + 0.02 \times 0.01$$
>
> $$r_1 = 0.05 + (0)e^{-0.3} + 0.0002$$
>
> $$r_1 = 0.05 + 0 + 0.0002$$
>
> $$r_1 = 0.0502$$
>
> Este cÃ¡lculo mostra que, para uma Ãºnica trajetÃ³ria onde $\int_0^t e^{-\kappa (t-s)} dW_s = 0.01$, a taxa de juros no final do ano Ã© 0.0502 ou 5.02%. Este valor, como no exemplo do GBM, Ã© uma Ãºnica realizaÃ§Ã£o de muitas possÃ­veis.

**Lema 2.1** (MÃ©dia e VariÃ¢ncia AssintÃ³tica do Modelo de Vasicek).
A mÃ©dia e a variÃ¢ncia assintÃ³tica do modelo de Vasicek sÃ£o:
$$\lim_{t \to \infty} E[r_t] = \theta$$
$$\lim_{t \to \infty} Var[r_t] = \frac{\sigma^2}{2\kappa}$$

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> CÃ¡lculo da variÃ¢ncia assintÃ³tica para diferentes valores de $\sigma$ e $\kappa$.
>
> Vamos calcular a variÃ¢ncia assintÃ³tica do modelo de Vasicek para diferentes combinaÃ§Ãµes de $\sigma$ e $\kappa$ e interpretar os resultados.
>
> *   Caso 1: $\sigma = 0.02$, $\kappa = 0.3$
> *   Caso 2: $\sigma = 0.03$, $\kappa = 0.3$
> *   Caso 3: $\sigma = 0.02$, $\kappa = 0.5$
>
> A variÃ¢ncia assintÃ³tica Ã© dada por:
>
> $$Var[r_\infty] = \frac{\sigma^2}{2\kappa}$$
>
> *   Caso 1:
>
>     $$Var[r_\infty] = \frac{(0.02)^2}{2 \times 0.3} = \frac{0.0004}{0.6} = 0.000667$$
>
> *   Caso 2:
>
>     $$Var[r_\infty] = \frac{(0.03)^2}{2 \times 0.3} = \frac{0.0009}{0.6} = 0.0015$$
>
> *   Caso 3:
>
>     $$Var[r_\infty] = \frac{(0.02)^2}{2 \times 0.5} = \frac{0.0004}{1.0} = 0.0004$$
>
> Interpretando os resultados:
>
> *   A variÃ¢ncia assintÃ³tica aumenta com o aumento da volatilidade ($\sigma$). Isso significa que, quanto mais volÃ¡til a taxa de juros, maior a dispersÃ£o em torno do seu nÃ­vel mÃ©dio de longo prazo no longo prazo.
> *   A variÃ¢ncia assintÃ³tica diminui com o aumento da velocidade de reversÃ£o Ã  mÃ©dia ($\kappa$). Isso significa que, quanto mais rÃ¡pido a taxa de juros retorna ao seu nÃ­vel mÃ©dio, menor a dispersÃ£o em torno desse nÃ­vel no longo prazo.

**ProposiÃ§Ã£o 3** (A esperanÃ§a $E[r_t]$ no modelo de Vasicek). Dado o modelo de Vasicek, a esperanÃ§a de $r_t$ condicional a $r_0$ Ã© dada por:

$$ E[r_t | r_0] = \theta + (r_0 - \theta)e^{-\kappa t} $$

*Prova*.
I. A partir da soluÃ§Ã£o do modelo de Vasicek no Teorema 2:
$r_t = \theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s$

II. Calculamos a esperanÃ§a condicional $E[r_t | r_0]$:
$E[r_t | r_0] = E[\theta + (r_0 - \theta)e^{-\kappa t} + \sigma \int_0^t e^{-\kappa (t-s)} dW_s | r_0]$

III. Como a integral estocÃ¡stica tem esperanÃ§a zero:
$E\left[\int_0^t e^{-\kappa (t-s)} dW_s\right] = 0$

IV. Portanto:
$E[r_t | r_0] = \theta + (r_0 - \theta)e^{-\kappa t}$ $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:**
>
> CÃ¡lculo da esperanÃ§a condicional da taxa de juros para diferentes valores de $t$.
>
> Usando os parÃ¢metros $r_0 = 0.05$, $\theta = 0.04$ e $\kappa = 0.2$, calcule a esperanÃ§a condicional da taxa de juros para $t = 1$ e $t = 5$ anos.
>
> Para $t = 1$:
>
> $$E[r_1 | r_0] = \theta + (r_0 - \theta)e^{-\kappa t}$$
> $$E[r_1 | r_0] = 0.04 + (0.05 - 0.04)e^{-0.2 \times 1}$$
> $$E[r_1 | r_0] = 0.04 + 0.01 \times e^{-0.2}$$
> $$E[r_1 | r_0] = 0.04 + 0.01 \times 0.8187$$
> $$E[r_1 | r_0] = 0.04 + 0.008187$$
> $$E[r_1 | r_0] = 0.048187$$
>
> Para $t = 5$:
>
> $$E[r_5 | r_0] = \theta + (r_0 - \theta)e^{-\kappa t}$$
> $$E[r_5 | r_0] = 0.04 + (0.05 - 0.04)e^{-0.2 \times 5}$$
> $$E[r_5 | r_0] = 0.04 + 0.01 \times e^{-1}$$
> $$E[r_5 | r_0] =0.04 + 0.01 \times 0.367879$$
> $$E[r_5 | r_0] = 0.04 + 0.00367879$$
> $$E[r_5 | r_0] = 0.04367879$$
>
> Portanto, a taxa de juros esperada em $t=5$, dado que a taxa inicial $r_0$ Ã© 5%, Ã© aproximadamente 4.37%.
>
> ### VariÃ¢ncia de $r_t$ dado $r_0$
>
> A variÃ¢ncia de $r_t$ dado $r_0$ no modelo de Vasicek Ã© dada por:
>
> $$Var(r_t | r_0) = \frac{\sigma^2}{2\kappa}(1 - e^{-2\kappa t})$$
>
> Onde:
>
> *   $\sigma$ Ã© a volatilidade da taxa de juros.
>
> Vamos calcular a variÃ¢ncia para $t = 5$:
>
> Dados:
>
> *   $\sigma = 0.02$
> *   $\kappa = 0.2$
> *   $t = 5$
>
> $$Var(r_5 | r_0) = \frac{(0.02)^2}{2 \times 0.2}(1 - e^{-2 \times 0.2 \times 5})$$
> $$Var(r_5 | r_0) = \frac{0.0004}{0.4}(1 - e^{-2})$$
> $$Var(r_5 | r_0) = 0.001 \times (1 - 0.135335)$$
> $$Var(r_5 | r_0) = 0.001 \times 0.864665$$
> $$Var(r_5 | r_0) = 0.000864665$$
>
> Portanto, a variÃ¢ncia da taxa de juros em $t=5$, dado $r_0$, Ã© aproximadamente 0.000865.
>
> ### Desvio PadrÃ£o de $r_t$ dado $r_0$
>
> O desvio padrÃ£o Ã© a raiz quadrada da variÃ¢ncia:
>
> $$SD(r_t | r_0) = \sqrt{Var(r_t | r_0)}$$
>
> Para $t = 5$:
>
> $$SD(r_5 | r_0) = \sqrt{0.000864665}$$
> $$SD(r_5 | r_0) = 0.029405$$
>
> O desvio padrÃ£o da taxa de juros em $t=5$, dado $r_0$, Ã© aproximadamente 2.94%.
>
> ### SimulaÃ§Ã£o de Monte Carlo
>
> Para realizar uma simulaÃ§Ã£o de Monte Carlo do modelo de Vasicek, podemos discretizar a equaÃ§Ã£o diferencial estocÃ¡stica usando o esquema de Euler.
>
> A equaÃ§Ã£o discretizada Ã©:
>
> $$r_{t+1} = r_t + \kappa(\theta - r_t)\Delta t + \sigma \sqrt{\Delta t} \epsilon_i$$
>
> Onde:
>
> *   $\Delta t$ Ã© o tamanho do passo de tempo.
> *   $\epsilon_i$ Ã© um nÃºmero aleatÃ³rio retirado de uma distribuiÃ§Ã£o normal padrÃ£o.
>
> Vamos simular 1000 caminhos de taxas de juros para um perÃ­odo de 5 anos, com passos de tempo mensais ($\Delta t = 1/12$).
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros
> r0 = 0.05
> theta = 0.04
> kappa = 0.2
> sigma = 0.02
> T = 5
> dt = 1/12
> N = int(T/dt)
> n_simulations = 1000
>
> # InicializaÃ§Ã£o
> np.random.seed(42)  # Para reproducibilidade
> rates = np.zeros((N + 1, n_simulations))
> rates[0, :] = r0
>
> # SimulaÃ§Ã£o de Monte Carlo
> for t in range(N):
>     dW = np.random.normal(0, np.sqrt(dt), n_simulations)
>     rates[t+1, :] = rates[t, :] + kappa * (theta - rates[t, :]) * dt + sigma * dW
>
> # Plot dos resultados
> time = np.linspace(0, T, N + 1)
> plt.figure(figsize=(12, 6))
> for i in range(n_simulations):
>     plt.plot(time, rates[:, i], alpha=0.1)
> plt.xlabel("Tempo (anos)")
> plt.ylabel("Taxa de Juros")
> plt.title("SimulaÃ§Ã£o de Monte Carlo do Modelo de Vasicek")
> plt.grid(True)
> plt.show()
>
> # CÃ¡lculo de estatÃ­sticas
> expected_rate = np.mean(rates[-1, :])
> std_rate = np.std(rates[-1, :])
>
> print(f"Taxa de juros esperada em T={T} anos: {expected_rate:.4f}")
> print(f"Desvio padrÃ£o da taxa de juros em T={T} anos: {std_rate:.4f}")
> ```
>
> Este cÃ³digo realiza uma simulaÃ§Ã£o de Monte Carlo do modelo de Vasicek e plota os caminhos simulados das taxas de juros. AlÃ©m disso, calcula a taxa de juros esperada e o desvio padrÃ£o no final do perÃ­odo de simulaÃ§Ã£o.
>
> ### PrecificaÃ§Ã£o de TÃ­tulos de Renda Fixa (Bonds)
>
> No modelo de Vasicek, o preÃ§o de um tÃ­tulo de renda fixa (bond) no tempo $t$ com vencimento em $T$ Ã© dado por:
>
> $$P(t, T) = A(t, T)e^{-B(t, T)r_t}$$
>
> Onde:
>
> $$B(t, T) = \frac{1 - e^{-\kappa(T-t)}}{\kappa}$$
>
> $$A(t, T) = e^{\frac{( \theta - \frac{\sigma^2}{2\kappa^2} ) (B(t, T) - (T-t)) - \frac{\sigma^2}{4\kappa}B(t, T)^2 }}{}}$$
>
> Vamos calcular $A(t, T)$ e $B(t, T)$ para precificar um tÃ­tulo.
>
> Dados:
>
> *   $t = 0$ (tempo atual)
> *   $T = 5$ (vencimento em 5 anos)
> *   $r_0 = 0.05$ (taxa de juros atual)
> *   $\theta = 0.04$
> *   $\kappa = 0.2$
> *   $\sigma = 0.02$
>
> Primeiro, calculamos $B(0, 5)$:
>
> $$B(0, 5) = \frac{1 - e^{-0.2 \times 5}}{0.2}$$
> $$B(0, 5) = \frac{1 - e^{-1}}{0.2}$$
> $$B(0, 5) = \frac{1 - 0.367879}{0.2}$$
> $$B(0, 5) = \frac{0.632121}{0.2}$$
> $$B(0, 5) = 3.160605$$
>
> Agora, calculamos $A(0, 5)$:
>
> $$A(0, 5) = e^{\frac{(0.04 - \frac{(0.02)^2}{2 \times (0.2)^2}) (3.160605 - 5) - \frac{(0.02)^2}{4 \times 0.2}(3.160605)^2}{}}$$
> $$A(0, 5) = e^{\frac{(0.04 - \frac{0.0004}{0.08}) (-1.839395) - \frac{0.0004}{0.8}(9.989436)}{}}$$
> $$A(0, 5) = e^{\frac{(0.04 - 0.005) (-1.839395) - 0.0005(9.989436)}{}}$$
> $$A(0, 5) = e^{\frac{0.035 \times (-1.839395) - 0.004994718}{}}$$
> $$A(0, 5) = e^{\frac{-0.064378825 - 0.004994718}{}}$$
> $$A(0, 5) = e^{-0.069373543}$$
> $$A(0, 5) = 0.93295$$
>
> Finalmente, calculamos o preÃ§o do tÃ­tulo:
>
> $$P(0, 5) = 0.93295 \times e^{-3.160605 \times 0.05}$$
> $$P(0, 5) = 0.93295 \times e^{-0.15803}$$
> $$P(0, 5) = 0.93295 \times 0.85365$$
> $$P(0, 5) = 0.79622$$
>
> Portanto, o preÃ§o do tÃ­tulo de renda fixa Ã© aproximadamente 0.79622.
>
> ### CalibraÃ§Ã£o do Modelo
>
> A calibraÃ§Ã£o do modelo de Vasicek envolve a estimaÃ§Ã£o dos parÃ¢metros $\kappa$, $\theta$ e $\sigma$ a partir de dados de mercado. Existem vÃ¡rias abordagens para isso, incluindo mÃ©todos de mÃ¡xima verossimilhanÃ§a e mÃ©todos baseados em momentos. A escolha do mÃ©todo depende da disponibilidade e qualidade dos dados, bem como das propriedades estatÃ­sticas desejadas para os estimadores.
>
> ### LimitaÃ§Ãµes e ExtensÃµes
>
> O modelo de Vasicek tem algumas limitaÃ§Ãµes:
>
> 1.  **Taxas de juros negativas:** O modelo permite taxas de juros negativas, o que pode nÃ£o ser realista em todos os contextos.
> 2.  **DistribuiÃ§Ã£o normal:** Assume que os choques nas taxas de juros seguem uma distribuiÃ§Ã£o normal, o que pode nÃ£o capturar adequadamente caudas grossas ou assimetrias observadas em dados reais.
> 3.  **ParÃ¢metros constantes:** Assume que os parÃ¢metros $\kappa$, $\theta$ e $\sigma$ sÃ£o constantes ao longo do tempo, o que pode nÃ£o ser vÃ¡lido na prÃ¡tica.
>
> Existem vÃ¡rias extensÃµes do modelo de Vasicek que tentam abordar essas limitaÃ§Ãµes. Algumas delas incluem:
>
> *   **Modelo de Cox-Ingersoll-Ross (CIR):** Este modelo restringe as taxas de juros a serem nÃ£o negativas.
> *   **Modelos de salto-difusÃ£o:** Incorporam saltos aleatÃ³rios nas taxas de juros para capturar eventos inesperados e caudas grossas.
> *   **Modelos de estrutura a termo dinÃ¢micos:** Permitem que os parÃ¢metros do modelo variem ao longo do tempo, capturando a dinÃ¢mica da estrutura a termo.
>
> ### ConclusÃ£o
>
> O modelo de Vasicek Ã© uma ferramenta Ãºtil para modelar a dinÃ¢mica das taxas de juros e precificar tÃ­tulos de renda fixa. Embora tenha algumas limitaÃ§Ãµes, ele fornece uma estrutura simples e intuitiva que pode ser estendida e adaptada para atender a diferentes necessidades e contextos. A simulaÃ§Ã£o de Monte Carlo e a precificaÃ§Ã£o de tÃ­tulos sÃ£o aplicaÃ§Ãµes prÃ¡ticas importantes do modelo.
### PrÃ³ximos Passos e ConsideraÃ§Ãµes Finais

O modelo de Black-Scholes Ã© uma ferramenta poderosa, mas Ã© crucial estar ciente de suas limitaÃ§Ãµes e suposiÃ§Ãµes subjacentes. A volatilidade constante, a ausÃªncia de custos de transaÃ§Ã£o e a negociaÃ§Ã£o contÃ­nua sÃ£o idealizaÃ§Ãµes que nem sempre se mantÃªm na realidade.

#### Ajustes e ExtensÃµes do Modelo

VÃ¡rios modelos foram desenvolvidos para mitigar as limitaÃ§Ãµes do modelo de Black-Scholes. Modelos de volatilidade estocÃ¡stica, como o modelo de Heston, permitem que a volatilidade varie aleatoriamente ao longo do tempo, tornando-os mais adequados para mercados volÃ¡teis. Modelos de salto-difusÃ£o, como o modelo de Merton, incorporam a possibilidade de saltos sÃºbitos no preÃ§o do ativo subjacente, capturando eventos de mercado inesperados.

#### Riscos e Oportunidades

A modelagem de opÃ§Ãµes oferece oportunidades significativas para investidores e gestores de risco. EstratÃ©gias como *covered calls*, *protective puts* e *straddles* podem ser implementadas usando opÃ§Ãµes para gerenciar o risco e aumentar o retorno. No entanto, a negociaÃ§Ã£o de opÃ§Ãµes tambÃ©m envolve riscos, como o risco de tempo, o risco de volatilidade e o risco de liquidez.

#### AplicaÃ§Ãµes Adicionais

O modelo de Black-Scholes e suas extensÃµes sÃ£o usados em uma variedade de aplicaÃ§Ãµes financeiras alÃ©m da precificaÃ§Ã£o de opÃ§Ãµes. Eles sÃ£o usados na avaliaÃ§Ã£o de garantias reais, na gestÃ£o de carteiras e na modelagem de risco de crÃ©dito. A capacidade de quantificar o valor do tempo e da incerteza torna esses modelos indispensÃ¡veis para a tomada de decisÃµes financeiras.

### GlossÃ¡rio

*   **Ativo Subjacente:** O ativo no qual a opÃ§Ã£o Ã© baseada, como aÃ§Ãµes, tÃ­tulos ou commodities.
*   **Call:** Uma opÃ§Ã£o que dÃ¡ ao titular o direito, mas nÃ£o a obrigaÃ§Ã£o, de comprar o ativo subjacente a um preÃ§o especificado.
*   **Derivativo:** Um contrato financeiro cujo valor Ã© derivado de outro ativo.
*   **Dividendos:** Pagamentos feitos por uma empresa aos seus acionistas.
*   **ExercÃ­cio:** O ato de exercer o direito concedido por uma opÃ§Ã£o.
*   **OpÃ§Ã£o Americana:** Uma opÃ§Ã£o que pode ser exercida a qualquer momento atÃ© a data de vencimento.
*   **OpÃ§Ã£o Europeia:** Uma opÃ§Ã£o que sÃ³ pode ser exercida na data de vencimento.
*   **Paridade Put-Call:** Uma relaÃ§Ã£o que descreve a relaÃ§Ã£o entre os preÃ§os das opÃ§Ãµes de compra e venda com o mesmo ativo subjacente, preÃ§o de exercÃ­cio e data de vencimento.
*   **PrÃªmio:** O preÃ§o pago para comprar uma opÃ§Ã£o.
*   **Put:** Uma opÃ§Ã£o que dÃ¡ ao titular o direito, mas nÃ£o a obrigaÃ§Ã£o, de vender o ativo subjacente a um preÃ§o especificado.
*   **Taxa Livre de Risco:** A taxa de retorno de um investimento sem risco, como um tÃ­tulo do governo.
*   **Volatilidade:** Uma medida de quanto o preÃ§o de um ativo tende a flutuar.

### ReferÃªncias

*   Black, F., & Scholes, M. (1973). The Pricing of Options and Corporate Liabilities. *Journal of Political Economy, 81*(3), 637-654.
*   Hull, J. C. (2018). *Options, futures, and other derivatives*. Pearson Education.
*   Merton, R. C. (1973). Theory of Rational Option Pricing. *The Bell Journal of Economics and Management Science, 4*(1), 141-183.

<!-- END -->