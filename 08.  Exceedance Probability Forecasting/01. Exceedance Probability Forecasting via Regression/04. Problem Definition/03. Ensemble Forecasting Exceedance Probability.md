## Métodos de Ensemble para Previsão de Probabilidade de Excedência

### Introdução

Em continuidade à definição do problema de previsão de séries temporais e, mais especificamente, à tarefa de **previsão de probabilidade de excedência** [^9], este capítulo aprofunda uma das abordagens estabelecidas para estimar a probabilidade $p_i$ de uma série temporal exceder um limiar pré-definido $\tau$ num instante futuro $i$ [^9]. Como mencionado anteriormente, esta tarefa é frequentemente relevante em domínios onde valores extremos são de grande importância [^2]. Enquanto modelos de classificação binária probabilística representam uma via comum para resolver este problema [^1], [^10], uma alternativa significativa reside na utilização de **métodos de ensemble** (conjunto) de previsões [^1], [^2], [^6]. Este capítulo detalha a fundamentação e aplicação de abordagens baseadas em ensemble para a estimativa da probabilidade de excedência, utilizando exclusivamente as informações e metodologias apresentadas no contexto fornecido. Focaremos em como múltiplos modelos de previsão podem ser combinados para derivar estimativas probabilísticas de excedência, contrastando implicitamente com a abordagem baseada na função de distribuição cumulativa (CDF) discutida em outras secções [^4], [^5].

### Conceitos Fundamentais

A previsão baseada em ensemble constitui uma alternativa robusta à utilização de modelos de classificação para a estimativa da probabilidade de excedência [^6], [^13]. Esta abordagem parte da construção de um conjunto, ou **ensemble**, de $M$ modelos de previsão individuais, denotado por $F = \\{f_1, f_2, ..., f_M\\}$ [^12]. Cada modelo $f_k \in F$ é tipicamente um modelo de regressão treinado para prever o valor pontual futuro da série temporal, $y_i$, com base em observações passadas $X_i$ e possíveis covariáveis $Z_i$, seguindo uma estratégia auto-regressiva [^12].

> A ideia central reside em agregar as previsões individuais dos membros do ensemble para obter uma estimativa da probabilidade de excedência. A metodologia predominante descrita no contexto é o **método direto baseado em ensemble** (*ensemble-based direct method*) [^13].

Neste método direto, a probabilidade de excedência $p_i$ é calculada como a proporção dos membros do ensemble cujas previsões individuais excedem o limiar crítico $\tau$ [^2], [^6], [^13]. Formalmente, a estimativa da probabilidade $p_i$ no instante $i$ é dada por:

$$\np_i = \frac{1}{M} \sum_{k=1}^{M} I(f_k(X_i, Z_i) \ge \tau)$$\n
onde $I(\cdot)$ representa a **função indicadora** (*indicator function*), que assume o valor 1 se a condição $f_k(X_i, Z_i) \ge \tau$ for verdadeira (ou seja, se a previsão do $k$-ésimo modelo exceder o limiar) e 0 caso contrário [^13]. Esta abordagem é frequentemente empregue em domínios como meteorologia e hidrologia [^6], [^13], onde os diferentes modelos do ensemble podem ser gerados, por exemplo, considerando diferentes condições iniciais [^6]. A aplicação desta técnica para múltiplos limiares $\tau$ permite a construção de curvas de probabilidade de excedência, que podem ser valiosas para a tomada de decisão [^7].

É importante distinguir este método direto para estimativa de probabilidade da utilização de ensembles para *previsão pontual*. O contexto menciona que os modelos em $F$ podem ser combinados para previsão pontual através de uma média uniformemente ponderada [^12]:

$$\hat{y}_i = \frac{1}{M} \sum_{k=1}^{M} f_k(X_i, Z_i)$$\n
Contudo, esta fórmula resulta numa estimativa do valor futuro $\hat{y}_i$, e não diretamente na probabilidade de excedência $p_i$, que é obtida através da contagem relativa de membros acima do limiar, como definido anteriormente [^13].

O contexto experimental fornecido oferece insights sobre a aplicação e desempenho deste método direto. Ele foi aplicado utilizando tanto ensembles homogêneos, como o **Random Forest Regressor (RFR)**, quanto ensembles heterogêneos, como o **Heterogeneous Regression Ensemble (HRE)** [^15], [^17]. As abordagens resultantes foram denotadas como **RFR+D** e **HRE+D**, respectivamente [^17], [^18]. Os resultados sugerem que a performance desta abordagem direta pode variar consideravelmente. Enquanto o RFR+D mostrou-se competitivo em relação a métodos de classificação padrão, o HRE+D apresentou estimativas de probabilidade de excedência consideradas pobres (*poor*) [^18].

> Uma observação relevante derivada dos experimentos é que *construir um ensemble com modelos fracos (RFR é um ensemble de árvores de decisão) pode ser melhor do que um ensemble de modelos fortes (como HRE) para a estimativa direta da probabilidade de excedência* [^19].

Adicionalmente, embora as abordagens baseadas em ensemble ofereçam flexibilidade semelhante à abordagem baseada em CDF no que concerne à definição do limiar $\tau$ (ao contrário dos classificadores, onde o limiar é fixado no treino) [^14], elas podem acarretar custos computacionais elevados e uma menor transparência, fatores que por vezes podem limitar a sua aplicação prática [^14]. A comparação geral indica que a abordagem proposta no estudo (baseada em CDF) demonstrou ser superior às abordagens de ensemble direto (RFR+D, HRE+D) nos experimentos realizados [^5], [^18], [^20].

### Conclusão

Este capítulo detalhou o **método direto baseado em ensemble** como uma abordagem estabelecida para a **previsão da probabilidade de excedência** [^13]. Fundamentado na utilização de um conjunto $F$ de $M$ modelos de previsão $f_k$, este método estima a probabilidade $p_i$ de exceder um limiar $\tau$ através da proporção de modelos individuais cujas previsões $f_k(X_i, Z_i)$ ultrapassam esse limiar [^13]. Vimos que esta técnica é aplicada em diversas áreas científicas [^13] e pode ser implementada com diferentes tipos de ensembles, como RFR e HRE [^17]. No entanto, a análise apresentada no contexto sugere que, embora viável, esta abordagem pode apresentar desafios, incluindo custos computacionais [^14] e uma performance potencialmente inferior a métodos alternativos, como a abordagem baseada em CDF [^5], [^18]. Além disso, a escolha dos modelos base (fracos vs. fortes) parece influenciar significativamente a eficácia do método direto para estimar a probabilidade de excedência [^19]. A compreensão desta abordagem é crucial para contextualizar e avaliar alternativas metodológicas no campo da previsão de probabilidade de excedência.

### Referências

[^1]: [Page 1, Abstract] Significant wave height forecasting is a key problem in ocean data analytics... This task is framed as an exceedance probability forecasting problem... This problem is usually solved using a probabilistic binary classification model or an ensemble of forecasts.
[^2]: [Page 2, Para 4] Ensemble-based forecasting (regression) approaches can also be applied, in which the exceedance probability is estimated according to the ratio of individual predictions that exceed the threshold.
[^3]: [Page 2, Para 4] Both approaches often model these events using lagged features, i.e., an auto-regressive type of modelling [41].
[^4]: [Page 3, Para 1] The proposed method does not rely on an ensemble-based forecasting model, though it could be one.
[^5]: [Page 3, Para 4] The results suggest that coupling a forecasting model with the proposed mechanism based on the CDF is better for exceedance probability forecasting relative to a classification method or an ensemble-based approach.
[^6]: [Page 5, Para 3] The alternative to using a classification approach to estimate the exceedance probability is to use an ensemble of forecasts. Accordingly, the probability is computed as the ratio of forecasts above the threshold. This type of approach is commonly used in fields such as meteorology [28], where different forecasts are obtained by considering different initial conditions [16]. Toth et al. [43] provide a comprehensive description of ensemble-based approaches listing their main properties.
[^7]: [Page 5, Para 3] Estimating the exceedance probability for different thresholds enables the construction of exceedance probability curves [25], which may be helpful for better decision-making.
[^8]: [Page 5, Para 4] On the other hand, in exceedance probability, the goal is simplified to predict whether or not a given threshold is exceeded, i.e., the magnitude of exceedance is not a major concern.
[^9]: [Page 6, Section 3.2 Title & Para 1] 3.2 Exceedance Probability Forecasting. The probability of exceedance $p_i$ denotes the probability that the value of a time series will exceed a predefined threshold $\tau$ in a given instant $i$. Typically, $p_i$ is modelled by resorting to a binary target variable $b_i$, which can be formalized as follows: $b_i = \\{1 \text{ if } y_i \ge \tau, 0 \text{ otherwise.}$ (1)
[^10]: [Page 6, Para 2] This naturally leads to a classification problem where the goal is to build a model $g$ of the form $b_i = g(X_i, Z_i)$. Accordingly, $p_i$ represents the conditional expectation of $b_i$ which we estimate based on Bernoulli density. Logistic regression is commonly used to this effect [42].
[^11]: [Page 6, Para 2] Since the exceedance events are rare, the number of cases for the positive class (i.e. when $b_i = 1$) is significantly smaller than the number of cases for the negative class ($b_i = 0$). This leads to an imbalanced classification problem, which hinders the learning process of algorithms [5].
[^12]: [Page 6, Para 3] The alternative to using a classification model is to use a forecasting ensemble F composed of a set of M models: $F = \\{f_1, f_2, ..., f_M\\}$. These models can be combined for forecasting using the uniformly weighted average as follows: $\hat{y}_i = \frac{1}{M} \sum_{k=1}^{M} f_k(X_i, Z_i)$.
[^13]: [Page 6, Para 4] We can also use the ensemble F to estimate the exceedance probability according to the ratio of ensemble members that forecast a value that exceeds the threshold $\tau$: $p_i = \frac{1}{M} \sum_{k=1}^{M} I(f_k(X_i, Z_i) \ge \tau)$ where I denotes the indicator function. Hereafter, we will refer to this approach as an ensemble-based direct method for exceedance probability. Ensemble-based approaches are commonly used in some fields related to environmental science, for example, meteorology or hydrology [43].
[^14]: [Page 8, Section 4.2] These advantages apply to an ensemble-based forecasting approach. However, the high computational costs and lack of transparency often preclude the application of these strategies [27,9].
[^15]: [Page 13, Section 6.2.2] We test four different regression approaches. Namely, a Random Forest regression method (RFR), a LASSO linear model, and a deep feed-forward neural network (NN)... The fourth approach is a heterogeneous regression ensemble (HRE).
[^16]: [Page 13, Section 6.2.2] Using a validation set we trimmed the ensemble by removing half of the models with worse performance.
[^17]: [Page 13, Section 6.2.2] We apply the regression approaches in two different ways to obtain the estimates for exceedance probability. The first is a Direct (abbreviated as D) approach: the exceedance probability $p$ is computed according to the the ratio of ensemble members which predicts a value above the threshold $\tau$. The Direct approach is only valid for ensembles, in this case, HRE (a heterogeneous ensemble) and RFR (a homogeneous ensemble).
[^18]: [Page 14, Para 2] We then evaluated all methods according to their ability to estimate exceedance probability... The results indicate that coupling a forecasting model with the mechanism based on the CDF for estimating exceedance probability provides a better performance relative to binary classification strategies (RFC, RFC+SMOTE, and LR) and ensemble-based approaches (RFR+D and HRE+D).
[^19]: [Page 14, Para 2] Another interesting result to note is that HRE+D provides poor estimates regarding exceedance probability, while RFR+D is competitive with classification methods. This outcome suggests that building an ensemble with weak models (RFR is an ensemble of decision trees) is better than an ensemble of strong models, such as HRE.
[^20]: [Page 15, Para 2] On the other hand, LASSO+CDF underperforms relative to the other methods, except for HRE+D.
[^21]: [Page 16, Fig 9 Caption] Classification methods (RFC+SMOTE, RFC, and LR) are represented with long dashed, ensemble direct methods (RFR+D, and HRE+D) are represented as dashed lines and CDF-based methods are denoted with solid lines.
[^22]: [Page 16, Para 2] NN+CDF outperforms other approaches, except for HRE+CDF. Notwithstanding, the ensemble HRE+CDF also follows the proposed approach for exceedance probability forecasting.
[^23]: [Page 18, Conclusion] This approach is an alternative to using a binary classification model or an ensemble-based approach.

<!-- END -->