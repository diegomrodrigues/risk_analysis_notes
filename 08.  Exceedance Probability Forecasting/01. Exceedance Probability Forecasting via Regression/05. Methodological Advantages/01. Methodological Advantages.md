## Capítulo 4: Vantagens Metodológicas da Previsão de Probabilidade de Excedência via Regressão

### Introdução

Nos capítulos anteriores, exploramos a formalização do problema de previsão de séries temporais e a tarefa específica de previsão de probabilidade de excedência, particularmente no contexto da **Significant Wave Height (SWH)**. Vimos como esta tarefa pode ser abordada através de modelos de classificação binária ou métodos baseados em ensembles de previsões. Este capítulo foca-se nas vantagens metodológicas inerentes à abordagem proposta neste trabalho, que utiliza um modelo de regressão para gerar previsões pontuais e, subsequentemente, deriva as probabilidades de excedência através da **Cumulative Distribution Function (CDF)**. Argumentaremos que esta abordagem oferece benefícios significativos em termos de integração da informação e flexibilidade na definição de limiares, tornando-a particularmente atraente em comparação com as alternativas tradicionais.

### Vantagens Metodológicas Chave

A preferência pela metodologia proposta, que combina um modelo de previsão (**forecasting model**) com a **CDF** para estimar a probabilidade de excedência, em detrimento de um classificador binário ou abordagens diretas baseadas em ensemble, fundamenta-se em duas razões principais, para além das considerações de desempenho que serão analisadas posteriormente (Seção 6).

#### Integração de Previsões Pontuais e Probabilísticas

A primeira vantagem reside na **integração** da informação. A abordagem proposta permite que o mesmo **modelo de previsão** seja utilizado tanto para prever os valores futuros da **SWH** quanto para estimar a probabilidade de excedência [^1]. Esta capacidade dual é extremamente valiosa para os operadores e decisores.

> A estimativa da probabilidade de excedência simplifica a informação fornecida ao utilizador final, o que pode ajudar um operador menos experiente na sua tomada de decisão. No entanto, a previsão numérica complementar oferece mais informação, que pode ser valiosa para operadores mais experientes. Por exemplo, se as previsões estiverem próximas do valor do limiar, a trajetória prevista oferece insights sobre como se espera que a variável mude [^1].

Conforme mencionado no resumo do trabalho, *computing both type of forecasts (binary probabilities and point forecasts) can be useful for decision-makers* [p1, Abstract]. Enquanto uma previsão binária probabilística simplifica a informação relativa a eventos de excedência, as previsões pontuais fornecem *additional insights into the upcoming future dynamics* [p1, Abstract]. Esta combinação, facilitada pela nossa metodologia onde $p_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)$ [^4], oferece um quadro informativo mais completo. O modelo único gera a previsão pontual $\hat{y}_i$ [^5], que serve de parâmetro de localização para a distribuição (e.g., Weibull [^6]), permitindo então o cálculo da probabilidade $p_i$ para um dado limiar $\tau$ [^4]. Ter um modelo capaz de ambos os tipos de previsões é, portanto, desejável para os operadores [^7].

#### Flexibilidade do Limiar (Threshold Flexibility)

A segunda vantagem significativa é a **flexibilidade do limiar** (**threshold flexibility**) [^2]. Abordagens baseadas em classificação tipicamente fixam o limiar $\tau$ durante a fase de treino do modelo. Uma vez treinado, o modelo está vinculado a esse limiar específico e não pode ser facilmente adaptado para avaliar a probabilidade de excedência relativamente a outros limiares durante a inferência [^2]. Esta rigidez pode ser uma limitação considerável em cenários operacionais onde diferentes níveis de risco (e, portanto, diferentes limiares) podem ser relevantes dependendo do contexto ou da operação marítima específica.

Em contraste, a abordagem baseada em regressão adota o que pode ser descrito como uma *lazy approach* em relação ao limiar [^2]. O modelo de previsão $f$ é treinado para prever o valor numérico da variável (e.g., $\hat{y}_i = f(X_i, Z_i)$ [^8]), independentemente de qualquer limiar específico. A avaliação da probabilidade de excedência $p_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)$ [^4] ocorre *a posteriori*, utilizando a previsão pontual $\hat{y}_i$ e os parâmetros da distribuição estimados ($\beta, \alpha$) [^6].

> Consequentemente, num dado instante, podemos usar o mesmo modelo para estimar a probabilidade de excedência para diferentes limiares - isto permite o traçado de **curvas de probabilidade de excedência** [^2].

Esta flexibilidade é crucial. Permite aos utilizadores avaliar dinamicamente o risco associado a múltiplos níveis críticos sem a necessidade de treinar modelos distintos. A capacidade de gerar **curvas de probabilidade de excedência** [^2], que mostram como a probabilidade $p_i$ varia em função do limiar $\tau$ para uma dada previsão $\hat{y}_i$, fornece uma visão muito mais rica da incerteza e do risco associado à previsão. Esta característica é particularmente relevante em domínios como a gestão de risco financeiro, onde métodos como o *triple barrier method* [^9] dependem da avaliação contra múltiplos limiares (positivos e negativos). A estimativa da probabilidade de excedência para diferentes limiares permite a construção destas curvas [^10], que podem ser úteis para uma melhor tomada de decisão [^10].

#### Comparação com Abordagens Baseadas em Ensemble

É importante notar que as vantagens de **integração** e **flexibilidade do limiar** também se aplicam, em teoria, a abordagens de previsão baseadas em ensemble (como **HRE** ou **RFR** mencionados no contexto [^11]), onde a probabilidade de excedência pode ser estimada pela proporção de membros do ensemble que excedem o limiar $\tau$ (a abordagem **Direct (D)** [^12]), $p_i = \frac{1}{M} \sum_{k=1}^{M} I(f_k(X_i, Z_i) \ge \tau)$ [^13]. No entanto, a aplicação prática destas estratégias baseadas em ensemble enfrenta frequentemente desafios relacionados com os *elevados custos computacionais* e a *falta de transparência* [^3], o que pode limitar a sua adoção. Além disso, os resultados experimentais apresentados (Figura 8 [^14]) sugerem que a abordagem proposta (**NN+CDF**, **RFR+CDF**, **HRE+CDF**) tende a superar as abordagens de ensemble diretas (**RFR+D**, **HRE+D**) na estimação da probabilidade de excedência [^14], indicando que o acoplamento explícito com a **CDF** pode ser mais eficaz do que simplesmente calcular a proporção de excedências no ensemble.

### Conclusão

Em suma, a metodologia de previsão de probabilidade de excedência baseada na combinação de um modelo de regressão com a **CDF** apresenta vantagens metodológicas claras sobre as alternativas. A **integração** da previsão pontual e probabilística num único modelo [^1] oferece uma riqueza de informação adaptável a diferentes perfis de utilizadores. A **flexibilidade do limiar** [^2] permite uma análise de risco mais dinâmica e a geração de **curvas de probabilidade de excedência** [^2], superando a rigidez dos modelos de classificação. Embora partilhe algumas destas vantagens com métodos de ensemble, a abordagem proposta pode ser computacionalmente mais eficiente e transparente [^3], e demonstrou empiricamente um desempenho superior às abordagens de ensemble diretas [^14]. Estas características posicionam a previsão de excedência via regressão e **CDF** como uma ferramenta poderosa e prática para problemas como a previsão de **SWH**.

### Referências

[^1]: Seção 4.2, Página 8: "The first reason is integration because the same forecasting model can be used to predict both the upcoming values of SWH and to estimate exceedance probability. The exceedance probability estimate simplifies the information being given to the end user, which may help a more inexperienced operator in their decision-making. Yet, complementary numeric forecast offers more information, which might be valuable for more experienced operators. For example, if the forecasts are near the threshold value, the predicted trajectory offers insights into how the variable is expected to change."
[^2]: Seção 4.2, Página 8: "The second reason is threshold flexibility: a classification approach fixes the threshold during training, and it cannot be changed during inference. Conversely, a regression model follows a lazy approach regarding the threshold. Therefore, in a given instant we can use the same model to estimate the exceedance probability for different thresholds - this enables the plotting of exceedance probability curves."
[^3]: Seção 4.2, Página 8: "These advantages apply to an ensemble-based forecasting approach. However, the high computational costs and lack of transparency often preclude the application of these strategies [27,9]."
[^4]: Equação (2), Seção 4.1.2, Página 7: "$p_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)$" e texto associado explicando que F é a CDF (Weibull neste caso) e representa a probabilidade de ser menor ou igual a $\tau$.
[^5]: Seção 4.1.1, Página 7: "...we denote the point forecast for the i-th observation as $\hat{y}_i$."
[^6]: Seção 4.1.2, Página 7: "We assume that $\hat{y}_i$ can be modeled according to a right-skewed Weibull distribution with a location parameter equal to the forecast $\hat{y}_i$. The scale $\beta$ and shape $\alpha$ parameters are estimated using the training data. We use the Weibull distribution as it provides an adequate fit to SWH data [31]."
[^7]: Seção 4.1, Página 7: "In effect, building a model capable of both types of forecasts is desirable for operators."
[^8]: Seção 3.1, Página 5: Formalização do modelo de regressão $y_i = f(X_i, Z_i)$. Embora aqui se refira a $y_i$, a previsão $\hat{y}_i$ é a saída do modelo $f$.
[^9]: Seção 7, Página 17: Referência ao "triple barrier method used in quantitative trading, e.g. [35]".
[^10]: Seção 2.2, Página 5: "Estimating the exceedance probability for different thresholds enables the construction of exceedance probability curves [25], which may be helpful for better decision-making."
[^11]: Seção 6.2.2, Página 13: Descrição dos métodos de regressão testados, incluindo RFR e HRE (ensemble heterogéneo).
[^12]: Seção 6.2.2, Página 13: Descrição da abordagem "Direct (abbreviated as D)" para ensembles.
[^13]: Seção 3.2, Página 6: Equação para calcular $p_i$ a partir de um ensemble F: $p_i = \frac{1}{M} \sum_{k=1}^{M} I(f_k(X_i, Z_i) \ge \tau)$.
[^14]: Seção 6.3, Página 14 e Figura 8, Página 16: Discussão dos resultados de AUC, indicando que NN+CDF, RFR+CDF, HRE+CDF superam RFR+D e HRE+D. "The results indicate that coupling a forecasting model with the mechanism based on the CDF for estimating exceedance probability provides a better performance relative to binary classification strategies (...) and ensemble-based approaches (RFR+D and HRE+D)."

<!-- END -->