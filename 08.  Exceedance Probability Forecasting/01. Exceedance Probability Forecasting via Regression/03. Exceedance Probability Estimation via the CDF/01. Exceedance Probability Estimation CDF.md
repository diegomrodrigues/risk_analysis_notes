## Estimativa de Probabilidade de Excedência via Função de Distribuição Acumulada a partir de Previsões Pontuais

### Introdução

A previsão da probabilidade de excedência, definida como a tarefa de estimar a probabilidade de uma série temporal ultrapassar um limiar predefinido num período futuro específico, é um problema crucial em diversas áreas, incluindo a análise de dados oceânicos [^1, ^2]. Particularmente no contexto da previsão da **Significant Wave Height (SWH)**, a capacidade de antecipar valores extremos é fundamental para a segurança de operações marítimas, como a gestão da passagem de navios, a proteção de conversores de energia das ondas e a prevenção de desastres costeiros [^3, ^4]. Tradicionalmente, esta tarefa é abordada utilizando modelos de classificação binária probabilística ou através de ensembles de previsões [^1]. No entanto, uma abordagem alternativa e inovadora, que constitui o foco deste capítulo, baseia-se na utilização de modelos de **point forecasting** [^1]. Especificamente, exploraremos como as previsões pontuais numéricas, que por si só fornecem *insights* valiosos sobre a dinâmica futura da variável [^5], podem ser convertidas em estimativas de probabilidade de excedência através da **Cumulative Distribution Function (CDF)** [^6]. Esta metodologia visa estimar a probabilidade $p$ de a SWH exceder um limiar crítico especificado $\tau$ [^7], alavancando as previsões numéricas geradas por um modelo de forecasting [^8].

### Conceitos Fundamentais

A tarefa preditiva central é estimar a probabilidade $p$ de que o valor de uma série temporal $Y$ num instante futuro $i$, denotado por $y_i$, exceda um limiar predefinido $\tau$, ou seja, $p_i = P(y_i > \tau)$ [^7]. A abordagem proposta neste capítulo difere fundamentalmente das técnicas de classificação binária, que modelam diretamente uma variável alvo binária $b_i$ (onde $b_i=1$ se $y_i \ge \tau$, e $b_i=0$ caso contrário [^9]), ou das abordagens baseadas em ensembles, que calculam a probabilidade como a proporção de previsões individuais que excedem $\tau$ [^10].

**A Metodologia Baseada em CDF e Previsões Pontuais**

A solução proposta articula-se em dois passos principais: a construção de um modelo de forecasting para obter previsões pontuais e a conversão dessas previsões em estimativas de probabilidade de excedência usando a CDF [^6].

Primeiramente, desenvolve-se um modelo de **forecasting** $f$, frequentemente baseado numa estratégia auto-regressiva, conforme formalizado na Secção 3.1 do trabalho de referência, onde o valor futuro $y_i$ é modelado com base nos seus lags passados e possivelmente covariáveis $Z_i$ [^11, ^12]. É importante notar que a metodologia é, em princípio, **agnóstica em relação ao modelo de forecasting** subjacente utilizado para gerar as previsões pontuais [^13]. Seja $\hat{y}_i$ a previsão pontual numérica para a observação $i$, produzida pelo modelo $f$ [^14].

O passo crucial da metodologia reside na suposição de que a previsão pontual $\hat{y}_i$ segue uma **distribuição de probabilidade contínua**, onde o próprio valor da previsão $\hat{y}_i$ funciona como o parâmetro de localização dessa distribuição [^5, ^15]. A escolha da distribuição específica deve ser informada pela natureza dos dados. No estudo de caso sobre SWH apresentado no contexto, recorre-se a uma distribuição **Weibull** desviada à direita (*right-skewed*), dado que esta demonstrou um ajuste adequado a dados de SWH em trabalhos anteriores [^15, ^16] e os dados em questão exibem um *positive skew* [^17]. No entanto, para outros estudos de caso, uma distribuição diferente pode ser mais apropriada [^16]. Os parâmetros restantes da distribuição, como os parâmetros de escala $\beta$ e forma $\alpha$ para a Weibull, são estimados utilizando os dados de treino ($Y_{train}$) [^15].

Uma vez definida a distribuição e estimados os seus parâmetros (à exceção do parâmetro de localização, que é a própria previsão $\hat{y}_i$), a probabilidade de excedência $p_i$ para o limiar $\tau$ no instante $i$ é calculada utilizando a **Cumulative Distribution Function (CDF)** correspondente, denotada por $F$ [^6]. A CDF $F(\tau; \hat{y}_i, \beta, \alpha)$ fornece a probabilidade de a variável aleatória assumir um valor menor ou igual a $\tau$. Portanto, a probabilidade de exceder $\tau$ é dada por [^8, ^18]:

$$\np_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)\n$$

> **Processo de Cálculo:**
> 1.  Ajustar os parâmetros da distribuição (e.g., $\beta, \alpha$ para Weibull) usando os dados de treino $Y_{train}$.
> 2.  Obter a previsão pontual $\hat{y}_i$ para o instante $i$ usando o modelo de forecasting $f$.
> 3.  Calcular a probabilidade de excedência $p_i$ usando a fórmula $p_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)$, onde $F$ é a CDF da distribuição escolhida avaliada no limiar $\tau$ [^19].

**Vantagens Metodológicas**

Esta abordagem apresenta vantagens significativas em relação às alternativas [^20]:

1.  **Integração da Informação:** O mesmo modelo de forecasting $f$ pode ser utilizado tanto para gerar previsões pontuais detalhadas de $y_i$, que oferecem *insights* sobre a trajetória futura da variável, quanto para estimar a probabilidade de excedência $p_i$, que simplifica a informação para a tomada de decisão [^5, ^21]. Esta capacidade dupla é desejável para os operadores [^11].
2.  **Flexibilidade do Threshold:** Ao contrário das abordagens de classificação, que fixam o limiar $\tau$ durante o treino e não permitem alterá-lo na inferência, a abordagem baseada em regressão e CDF adota uma estratégia *lazy* em relação ao limiar [^21]. O limiar $\tau$ só é utilizado no passo final de cálculo da probabilidade (Eq. 2). Isto significa que, para um dado instante $i$ e uma previsão $\hat{y}_i$, podemos usar o mesmo modelo para estimar a probabilidade de excedência para **diferentes limiares** $\tau$, permitindo, por exemplo, o traçado de curvas de probabilidade de excedência [^21, ^22].

Estas vantagens também se aplicam a abordagens baseadas em ensembles de forecasting [^22], mas a metodologia CDF proposta pode oferecer benefícios em termos de custos computacionais e transparência [^22]. O estudo de caso apresentado no contexto sugere que acoplar um modelo de forecasting (como uma rede neuronal *deep feedforward* ou Random Forest Regressor) com o mecanismo baseado na CDF resulta num melhor desempenho para estimar a probabilidade de excedência em comparação com estratégias de classificação binária (RFC, RFC+SMOTE, LR) e abordagens baseadas em ensembles (RFR+D, HRE+D) [^23, ^24, ^25].

### Conclusão

O método de estimativa da probabilidade de excedência através da conversão de previsões pontuais utilizando a Função de Distribuição Acumulada (CDF) representa uma alternativa poderosa e flexível às abordagens tradicionais. Ao alavancar um modelo de forecasting para gerar previsões numéricas $\hat{y}_i$ e, subsequentemente, usar a CDF de uma distribuição assumida (com $\hat{y}_i$ como parâmetro de localização) para calcular $p_i = 1 - F(\tau; \hat{y}_i, \text{parameters})$ [^8, ^18], esta metodologia oferece a vantagem de fornecer tanto previsões detalhadas quanto probabilidades de excedência simplificadas a partir de um único modelo [^5, ^21]. A flexibilidade inerente na escolha do limiar $\tau$ durante a inferência [^21, ^22] aumenta ainda mais a sua utilidade prática. Conforme demonstrado no estudo de caso de previsão de SWH [^1], esta abordagem, particularmente quando acoplada a modelos de forecasting robustos como redes neuronais profundas, pode superar alternativas de classificação e baseadas em ensembles [^25], abrindo caminho para a sua generalização noutros domínios de aplicação para além da previsão de SWH [^26]. A escolha apropriada da distribuição de probabilidade, no entanto, permanece uma consideração importante e dependente dos dados de entrada [^16, ^28].

### Referências

[^1]: Cerqueira, V., & Torgo, L. (Abstract). Exceedance Probability Forecasting via Regression: A Case Study of Significant Wave Height Prediction. *arXiv:2206.09821v4 [stat.ML]*.\n[^2]: Cerqueira, V., & Torgo, L. (Section 1, Introduction). Significant wave height (SWH) forecasting is a key problem in ocean data analytics...\n[^3]: Cerqueira, V., & Torgo, L. (Abstract). This task affects several maritime operations, such as managing the passage of vessels or estimating the energy production from waves.\n[^4]: Cerqueira, V., & Torgo, L. (Page 2, Paragraph 2). Predicting impending large values of SWH is important for coastal disaster prevention and protection of wave energy converters...\n[^5]: Cerqueira, V., & Torgo, L. (Abstract). While a probabilistic binary forecast streamlines information for end-users concerning exceedance events, the point forecasts can provide additional insights into the upcoming future dynamics.\n[^6]: Cerqueira, V., & Torgo, L. (Section 4.1, Paragraph 2). This work introduces a novel approach for exceedance probability forecasting based on a time series forecasting model. The proposed solution works in two main steps: Building a forecasting model and use it to obtain point forecasts; Converting point forecasts into exceedance probability estimates using the CDF.\n[^7]: Cerqueira, V., & Torgo, L. (Section 3.2, Exceedance Probability Forecasting). The probability of exceedance $p_i$ denotes the probability that the value of a time series will exceed a predefined threshold $\tau$ in a given instant $i$.\n[^8]: Cerqueira, V., & Torgo, L. (Page 7, Section 4.1). The predictive task is to estimate $p$, the probability that the SWH will exceed a specified threshold $\tau$. We tackle this task using a forecasting model that produces point forecasts... leveraging the numeric predictions produced by the forecasting model...\n[^9]: Cerqueira, V., & Torgo, L. (Section 3.2, Eq. 1). Typically, $p_i$ is modelled by resorting to a binary target variable $b_i$, which can be formalized as follows: $b_i = 1$ if $y_i \ge \tau$, $0$ otherwise.\n[^10]: Cerqueira, V., & Torgo, L. (Section 3.2, Page 6). We can also use the ensemble F to estimate the exceedance probability according to the ratio of ensemble members that forecast a value that exceeds the threshold $\tau$: $p_i = \frac{1}{M} \sum_{k=1}^{M} I(f_k(X_i, Z_i) \ge \tau)$.\n[^11]: Cerqueira, V., & Torgo, L. (Page 7, Section 4.1). The point forecasts, in addition to the exceedance probability estimates, can provide valuable information about the dynamics of the SWH. In effect, building a model capable of both types of forecasts is desirable for operators.\n[^12]: Cerqueira, V., & Torgo, L. (Section 4.1.1, Building a forecasting model). We build a forecasting model $f$ using auto-regression as formalized in Section 3.1.\n[^13]: Cerqueira, V., & Torgo, L. (Section 4.1.1). However, it is important to remark that the proposed methodology is agnostic to the underlying forecasting model.\n[^14]: Cerqueira, V., & Torgo, L. (Section 4.1.1). The proposed method leverages the numeric predictions produced by the forecasting model regarding the value of future observations. Here, we denote the point forecast for the i-th observation as $\hat{y}_i$.\n[^15]: Cerqueira, V., & Torgo, L. (Section 4.1.2, Computing exceedance probability estimates). We assume that $\hat{y}_i$ can be modeled according to a right-skewed Weibull distribution with a location parameter equal to the forecast $\hat{y}_i$. The scale $\beta$ and shape $\alpha$ parameters are estimated using the training data.\n[^16]: Cerqueira, V., & Torgo, L. (Section 4.1.2). We use the Weibull distribution as it provides an adequate fit to SWH data [31]. For other case studies, a different distribution may be more appropriate.\n[^17]: Cerqueira, V., & Torgo, L. (Page 9, Figure 3 caption). Histogram of the SWH time series distribution, which shows a positive skewness.\n[^18]: Cerqueira, V., & Torgo, L. (Section 4.1.2, Eq. 2). $p_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)$. Where F denotes the CDF of the Weibull distribution.\n[^19]: Cerqueira, V., & Torgo, L. (Page 8, Algorithm 1). Computing the exceedance probability estimate using point forecasts. Steps: Fit Weibull parameters, Compute forecast $\hat{y}_i$, Estimate $p_i = 1 - F(\tau; \hat{y}_i, \beta, \alpha)$.\n[^20]: Cerqueira, V., & Torgo, L. (Section 4.2, Methodological Advantages). Aside from performance considerations... the proposed method may be preferable relative to a classifier for two main reasons.\n[^21]: Cerqueira, V., & Torgo, L. (Section 4.2). The first reason is integration... The second reason is threshold flexibility...\n[^22]: Cerqueira, V., & Torgo, L. (Section 4.2). Therefore, in a given instant we can use the same model to estimate the exceedance probability for different thresholds - this enables the plotting of exceedance probability curves. These advantages apply to an ensemble-based forecasting approach. However, the high computational costs and lack of transparency often preclude the application of these strategies [27,9].\n[^23]: Cerqueira, V., & Torgo, L. (Section 6.2.1, Classification Methods). Lists Random Forest Classifier (RFC), Logistic Regression (LR), RFC+SMOTE.\n[^24]: Cerqueira, V., & Torgo, L. (Section 6.2.2, Forecasting Methods). We apply the regression approaches in two different ways... The first is a Direct (abbreviated as D) approach: the exceedance probability p is computed according to the ratio of ensemble members... valid for ensembles, in this case, HRE... and RFR...\n[^25]: Cerqueira, V., & Torgo, L. (Page 14, Paragraph after Table 1). The results indicate that coupling a forecasting model with the mechanism based on the CDF for estimating exceedance probability provides a better performance relative to binary classification strategies... and ensemble-based approaches...\n[^26]: Cerqueira, V., & Torgo, L. (Section 8, Conclusions). In future work, we will generalize the framework to other application domains besides SWH forecasting.\n[^27]: Cerqueira, V., & Torgo, L. (Section 6.2.2). We test four different regression approaches. Namely, a Random Forest regression method (RFR), a LASSO linear model, and a deep feed-forward neural network (NN). ... The fourth approach is a heterogeneous regression ensemble (HRE).\n[^28]: Cerqueira, V., & Torgo, L. (Section 8, Conclusions). The data shows a clear positive skew and previous works have modeled this type of data using distributions such as Weibull or Rayleigh [31]. However, the most appropriate distribution depends on the input data.
<!-- END -->