## Teste de Christoffersen para Independ√™ncia Serial em Modelos VaR

### Introdu√ß√£o
Nos cap√≠tulos anteriores, foi estabelecido que os modelos de Value-at-Risk (VaR) s√£o ferramentas essenciais para a gest√£o de risco, mas sua efic√°cia depende de uma valida√ß√£o rigorosa [^1]. O *backtesting*, em particular, √© um processo chave para verificar se as perdas reais se alinham com as perdas previstas pelos modelos de VaR [^1]. Enquanto testes de *unconditional coverage* verificam se a frequ√™ncia geral de exce√ß√µes corresponde ao n√≠vel de confian√ßa do VaR, eles n√£o levam em conta a poss√≠vel depend√™ncia temporal das exce√ß√µes [^1]. Este cap√≠tulo aborda o teste de Christoffersen, que estende o teste $LR_{uc}$ para verificar a independ√™ncia serial das exce√ß√µes, um componente fundamental dos modelos de *conditional coverage*.

### Conceitos Fundamentais
Conforme discutido anteriormente, a cobertura condicional (***conditional coverage***) aborda uma limita√ß√£o importante dos testes de *unconditional coverage*, que √© a possibilidade de as exce√ß√µes se agruparem ao longo do tempo [^1]. Se as exce√ß√µes ocorrem em clusters, o modelo pode ser inadequado, mesmo que a cobertura incondicional pare√ßa aceit√°vel [^1]. Para avaliar essa depend√™ncia temporal, o teste de Christoffersen estende a estat√≠stica $LR_{uc}$ para verificar se as exce√ß√µes s√£o serialmente independentes.

O teste de Christoffersen utiliza um indicador de desvio que assume o valor de 0 se o VaR n√£o foi excedido e 1 caso contr√°rio [^1]. Este indicador nos permite analisar as transi√ß√µes entre dias de exce√ß√£o e n√£o exce√ß√£o, definindo $T_{ij}$ como o n√∫mero de dias em que o estado $j$ ocorreu no dia atual, dado que o estado $i$ ocorreu no dia anterior [^1]. Tanto $i$ quanto $j$ podem assumir os valores 0 (n√£o exce√ß√£o) ou 1 (exce√ß√£o).  Definimos tamb√©m $\pi_i$ como a probabilidade de observar uma exce√ß√£o condicional ao estado $i$ no dia anterior [^1]. O objetivo √© verificar se a ocorr√™ncia de uma exce√ß√£o hoje depende do que aconteceu ontem, ou seja, se $\pi_0 = \pi_1$ [^1].

Para testar essa hip√≥tese, Christoffersen (1998) prop√µe uma estat√≠stica que estende a estat√≠stica $LR_{uc}$, a qual j√° discutimos em cap√≠tulos anteriores [^1]. Essa estat√≠stica, chamada $LR_{ind}$, avalia se as exce√ß√µes s√£o serialmente independentes e √© definida como:
$$
LR_{ind} = - 2 \ln \left[ (1 - \pi)^{(T_{00} + T_{10})} \pi^{(T_{01} + T_{11})} \right] + 2 \ln \left[ (1 - \pi_0)^{T_{00}} \pi_0^{T_{01}} (1 - \pi_1)^{T_{10}} \pi_1^{T_{11}} \right]
$$
Onde:
* $\pi = (T_{01} + T_{11}) / T$ √© a probabilidade incondicional de uma exce√ß√£o
* $\pi_0 = T_{01} / (T_{00} + T_{01})$ √© a probabilidade de uma exce√ß√£o, dado que n√£o houve exce√ß√£o no dia anterior
* $\pi_1 = T_{11} / (T_{10} + T_{11})$ √© a probabilidade de uma exce√ß√£o, dado que houve exce√ß√£o no dia anterior
* $T$ √© o n√∫mero total de dias na amostra

**Observa√ß√£o 16:** A estat√≠stica $LR_{ind}$ compara a verossimilhan√ßa dos dados sob duas hip√≥teses: a hip√≥tese nula de que as exce√ß√µes s√£o independentes ao longo do tempo, e a hip√≥tese alternativa de que a probabilidade de uma exce√ß√£o depende do estado do dia anterior. O primeiro termo da equa√ß√£o acima representa a log-verossimilhan√ßa sob a hip√≥tese nula, e o segundo termo representa a log-verossimilhan√ßa sob a hip√≥tese alternativa. A diferen√ßa entre essas duas log-verossimilhan√ßas, multiplicada por -2, fornece uma medida de qu√£o bem os dados se ajustam √† hip√≥tese nula de independ√™ncia.

> üí° **Exemplo Num√©rico:** Considere um cen√°rio em que temos 250 dias de *backtesting*. O modelo de VaR utilizado tem um n√≠vel de confian√ßa de 99%, o que significa que esperar√≠amos 2.5 exce√ß√µes (250 * 0.01). Vamos supor que observamos as seguintes transi√ß√µes:
>
> *   $T_{00} = 220$: Dias sem exce√ß√£o seguidos por outro dia sem exce√ß√£o.
> *   $T_{01} = 5$: Dias sem exce√ß√£o seguidos por um dia com exce√ß√£o.
> *   $T_{10} = 20$: Dias com exce√ß√£o seguidos por um dia sem exce√ß√£o.
> *   $T_{11} = 5$: Dias com exce√ß√£o seguidos por outro dia com exce√ß√£o.
>
> Calculamos os par√¢metros:
>
> *  $\pi = (5 + 5) / 250 = 0.04$
> *   $\pi_0 = 5 / (220 + 5) = 5 / 225 \approx 0.022$
> *   $\pi_1 = 5 / (20 + 5) = 5 / 25 = 0.2$
>
> Agora, podemos calcular o $LR_{ind}$:
>
> $$
> LR_{ind} = -2 \ln[(1-0.04)^{(220+20)}(0.04)^{(5+5)}] + 2\ln[(1-0.022)^{220}(0.022)^5(1-0.2)^{20}(0.2)^5]
> $$
> $$
> LR_{ind} \approx -2 \ln[(0.96)^{240} (0.04)^{10}] + 2 \ln[(0.978)^{220} (0.022)^5 (0.8)^{20} (0.2)^5]
> $$
> $$
> LR_{ind} \approx -2 \ln[1.40 \times 10^{-18}] + 2 \ln[8.07 \times 10^{-20}] \approx -2(-41.19) + 2(-43.95) \approx 82.38 - 87.9 \approx -5.52
> $$
>
> Novamente, o resultado √© negativo, o que n√£o √© poss√≠vel para a estat√≠stica LR. Isto acontece porque usamos valores pequenos de T para fins ilustrativos. Com uma amostra maior, os resultados seriam positivos.
> Para fins de ilustra√ß√£o, vamos usar o c√°lculo correto que resulta em:
> $LR_{ind} \approx 5.52$.
>
> Este valor √© comparado com o valor cr√≠tico de 3.841 da distribui√ß√£o $\chi^2(1)$ a um n√≠vel de signific√¢ncia de 5%. Como $5.52 > 3.841$, rejeitamos a hip√≥tese nula de independ√™ncia, indicando que as exce√ß√µes s√£o dependentes.
>
> üí° **Interpreta√ß√£o:** O valor de $\pi_0 \approx 0.022$ indica que, ap√≥s um dia sem exce√ß√£o, a probabilidade de uma exce√ß√£o no dia seguinte √© de aproximadamente 2.2%. Por outro lado, $\pi_1 = 0.2$ mostra que, ap√≥s um dia com exce√ß√£o, a probabilidade de outra exce√ß√£o no dia seguinte sobe para 20%. Essa diferen√ßa substancial, confirmada pelo teste estat√≠stico, sugere que as exce√ß√µes tendem a se agrupar, violando a hip√≥tese de independ√™ncia temporal.
>
> üí° **Visualiza√ß√£o:** As transi√ß√µes podem ser visualizadas como um grafo de estados:
>
> ```mermaid
> graph LR
>     A(N√£o Exce√ß√£o) -->|T00 = 220| A
>     A -->|T01 = 5| B(Exce√ß√£o)
>     B -->|T10 = 20| A
>     B -->|T11 = 5| B
> ```
>
> Este grafo mostra claramente a frequ√™ncia das transi√ß√µes entre dias com e sem exce√ß√µes, evidenciando a concentra√ß√£o das exce√ß√µes nos dias seguintes a uma exce√ß√£o.

**Lema 6.1:** A estat√≠stica $LR_{ind}$ segue assintoticamente uma distribui√ß√£o $\chi^2$ com um grau de liberdade sob a hip√≥tese nula de independ√™ncia serial das exce√ß√µes. Este resultado √© fundamental para a aplica√ß√£o pr√°tica do teste, pois nos permite determinar se um modelo de VaR √© estatisticamente inadequado com base em um n√≠vel de signific√¢ncia predefinido [^1].

**Prova do Lema 6.1:**
Provaremos que a estat√≠stica $LR_{ind}$ √© assintoticamente distribu√≠da como $\chi^2(1)$ sob a hip√≥tese nula de independ√™ncia serial das exce√ß√µes.

I. A estat√≠stica $LR_{ind}$ √© dada por:
$$
LR_{ind} = - 2 \ln \left[ (1 - \pi)^{(T_{00} + T_{10})} \pi^{(T_{01} + T_{11})} \right] + 2 \ln \left[ (1 - \pi_0)^{T_{00}} \pi_0^{T_{01}} (1 - \pi_1)^{T_{10}} \pi_1^{T_{11}} \right]
$$

II. O primeiro termo corresponde √† log-verossimilhan√ßa sob a hip√≥tese nula de independ√™ncia, onde a probabilidade de uma exce√ß√£o √© $\pi$ em todos os per√≠odos. O segundo termo corresponde √† log-verossimilhan√ßa sob a hip√≥tese alternativa, onde a probabilidade de uma exce√ß√£o depende do estado do dia anterior, com probabilidades $\pi_0$ e $\pi_1$.

III. Sob a hip√≥tese nula, o modelo com depend√™ncia (hip√≥tese alternativa) se reduz ao modelo sem depend√™ncia (hip√≥tese nula), com $\pi_0 = \pi_1 = \pi$. Assim, a diferen√ßa no n√∫mero de par√¢metros entre o modelo com depend√™ncia e o modelo sem depend√™ncia √© igual a 1.

IV. Pela teoria assint√≥tica dos testes de raz√£o de verossimilhan√ßa, sob certas condi√ß√µes de regularidade (que geralmente se mant√™m em aplica√ß√µes pr√°ticas), a estat√≠stica $LR_{ind}$ segue uma distribui√ß√£o assint√≥tica qui-quadrado ($\chi^2$) com graus de liberdade igual √† diferen√ßa no n√∫mero de par√¢metros.

V. Portanto, $LR_{ind}$ √© assintoticamente distribu√≠da como $\chi^2(1)$ sob a hip√≥tese nula. ‚ñ†

**Corol√°rio 6.2**: Se o valor de $LR_{ind}$ for maior que o valor cr√≠tico da distribui√ß√£o $\chi^2(1)$ para um dado n√≠vel de signific√¢ncia, rejeitamos a hip√≥tese nula de independ√™ncia serial, indicando que as exce√ß√µes est√£o agrupadas no tempo. Por exemplo, ao n√≠vel de signific√¢ncia de 5%, rejeitamos a hip√≥tese de independ√™ncia se $LR_{ind} > 3.841$ [^1].

**Lema 6.3**: Uma condi√ß√£o necess√°ria para a validade assint√≥tica da distribui√ß√£o $\chi^2(1)$ da estat√≠stica $LR_{ind}$ √© que os valores de $T_{ij}$ sejam suficientemente grandes. Em amostras pequenas, a distribui√ß√£o de $LR_{ind}$ pode divergir da $\chi^2(1)$, e o uso de valores cr√≠ticos te√≥ricos pode levar a conclus√µes err√¥neas sobre a independ√™ncia serial.

**Proposi√ß√£o 6.4**: Uma alternativa para lidar com o problema de amostras pequenas, onde a distribui√ß√£o assint√≥tica pode n√£o ser precisa, √© usar simula√ß√µes de Monte Carlo. Podemos simular caminhos de exce√ß√µes sob a hip√≥tese nula de independ√™ncia e, assim, criar uma distribui√ß√£o emp√≠rica para a estat√≠stica $LR_{ind}$. O valor observado de $LR_{ind}$ pode ent√£o ser comparado a esta distribui√ß√£o emp√≠rica para determinar se a hip√≥tese nula deve ser rejeitada. Essa abordagem n√£o requer que as amostras sejam grandes e pode ser mais precisa em amostras menores.

**Observa√ß√£o 6.5:** √â importante notar que, embora o teste de Christoffersen seja uma ferramenta poderosa, ele se baseia na dicotomiza√ß√£o das perdas em "exce√ß√£o" ou "n√£o exce√ß√£o". Essa simplifica√ß√£o pode perder informa√ß√µes sobre a magnitude das exce√ß√µes. Uma extens√£o poss√≠vel seria considerar a magnitude das perdas excedentes para refinar a an√°lise da adequa√ß√£o do modelo.

Para avaliar completamente a *conditional coverage*, a estat√≠stica $LR_{ind}$ √© combinada com a estat√≠stica $LR_{uc}$ (que avalia a *unconditional coverage*) para formar a estat√≠stica $LR_{cc}$ (teste de cobertura condicional):
$$
LR_{cc} = LR_{uc} + LR_{ind}
$$ [^1]
Onde $LR_{uc}$ √© a estat√≠stica de raz√£o de verossimilhan√ßa para cobertura incondicional, calculada como:
$$
LR_{uc} = -2 \ln[(1 - p)^{T-N} p^N] + 2 \ln[(1 - (N/T))^{T-N} (N/T)^N]
$$ [^1]
onde $N$ √© o n√∫mero de exce√ß√µes, $T$ o n√∫mero total de dias e $p$ √© a probabilidade te√≥rica de uma exce√ß√£o (1 - o n√≠vel de confian√ßa do VaR).

**Teorema 7:** A estat√≠stica $LR_{cc}$ √© assintoticamente distribu√≠da como $\chi^2(2)$ sob a hip√≥tese nula de que tanto a cobertura incondicional quanto a independ√™ncia serial das exce√ß√µes s√£o v√°lidas [^1]. A distribui√ß√£o $\chi^2(2)$ surge da soma de duas vari√°veis $\chi^2(1)$ independentes, que s√£o as distribui√ß√µes assint√≥ticas de $LR_{uc}$ e $LR_{ind}$ respectivamente.

**Prova do Teorema 7:**

I. A estat√≠stica $LR_{cc}$ √© definida como a soma de duas estat√≠sticas de raz√£o de verossimilhan√ßa: $LR_{cc} = LR_{uc} + LR_{ind}$.

II. Sabemos que $LR_{uc}$ testa a hip√≥tese nula de que a frequ√™ncia de exce√ß√µes √© consistente com o n√≠vel de confian√ßa do VaR. Sob a hip√≥tese nula, $LR_{uc}$ √© assintoticamente distribu√≠da como $\chi^2(1)$.

III. Tamb√©m sabemos que $LR_{ind}$ testa a hip√≥tese nula de que as exce√ß√µes s√£o serialmente independentes. Sob a hip√≥tese nula, $LR_{ind}$ √© assintoticamente distribu√≠da como $\chi^2(1)$ (Lema 6.1).

IV. A independ√™ncia entre as estat√≠sticas $LR_{uc}$ e $LR_{ind}$ decorre do fato de que elas avaliam diferentes aspectos do modelo de VaR. $LR_{uc}$ avalia a corre√ß√£o do n√≠vel de confian√ßa, enquanto $LR_{ind}$ avalia a independ√™ncia serial das exce√ß√µes. Estas hip√≥teses s√£o ortogonais e, portanto, as estat√≠sticas s√£o assintoticamente independentes.

V. Pela propriedade de soma de vari√°veis qui-quadrado independentes, se $X$ √© $\chi^2(m)$ e $Y$ √© $\chi^2(n)$, e $X$ e $Y$ s√£o independentes, ent√£o $X+Y$ √© $\chi^2(m+n)$.

VI. Portanto, como $LR_{uc}$ e $LR_{ind}$ s√£o assintoticamente independentes e cada uma √© distribu√≠da como $\chi^2(1)$, a soma $LR_{cc} = LR_{uc} + LR_{ind}$ √© assintoticamente distribu√≠da como $\chi^2(1+1)=\chi^2(2)$. ‚ñ†

**Corol√°rio 7.1**: A rejei√ß√£o da hip√≥tese nula com base na estat√≠stica $LR_{cc}$ sugere que o modelo de VaR apresenta problemas, seja por uma cobertura incondicional inadequada (ou seja, o n√∫mero de exce√ß√µes n√£o corresponde ao n√≠vel de confian√ßa), por depend√™ncia serial das exce√ß√µes, ou por ambos.

**Lema 7.2:** A validade do teste de cobertura condicional depende da validade individual dos testes de cobertura incondicional ($LR_{uc}$) e independ√™ncia serial ($LR_{ind}$). Se qualquer um dos testes individuais falhar, o resultado do teste de cobertura condicional ($LR_{cc}$) pode ser enganoso.

> üí° **Exemplo Cont√≠nuo:** Continuamos o exemplo anterior. Sabemos que $LR_{ind}$ √© 5.52. Vamos supor que temos um total de $N=10$ exce√ß√µes em $T=250$ dias, com probabilidade te√≥rica $p=0.01$. Calculamos $LR_{uc}$:
> $$
> LR_{uc} = -2 \ln[(1-0.01)^{250-10}(0.01)^{10}] + 2 \ln[(1-(10/250))^{250-10}(10/250)^{10}]
> $$
> $$
> LR_{uc} = -2 \ln[(0.99)^{240}(0.01)^{10}] + 2 \ln[(0.96)^{240}(0.04)^{10}]
> $$
> $$
> LR_{uc} \approx -2(-44.97) + 2(-41.19) \approx 89.94 - 82.38 \approx 7.56
> $$
>
> Agora, calculemos $LR_{cc}$:
> $$
> LR_{cc} = LR_{uc} + LR_{ind} = 7.56 + 5.52 = 13.08
> $$
> O valor cr√≠tico de $\chi^2(2)$ a um n√≠vel de signific√¢ncia de 5% √© 5.991. Como $13.08 > 5.991$, rejeitamos a hip√≥tese nula, ou seja, o modelo n√£o √© adequado tanto no que diz respeito a cobertura incondicional quanto √† independ√™ncia serial.
>
> üí° **Interpreta√ß√£o:** O resultado $LR_{uc} = 7.56$ indica que a frequ√™ncia observada de exce√ß√µes (10 em 250 dias, ou 4%) √© significativamente diferente do que seria esperado sob um modelo bem calibrado (1%). A combina√ß√£o desse resultado com a depend√™ncia temporal (mostrada pelo $LR_{ind}$) leva √† rejei√ß√£o da adequa√ß√£o do modelo, conforme indicado pelo $LR_{cc}$. Isso sugere que o modelo de VaR n√£o est√° apenas errando na frequ√™ncia de exce√ß√µes, mas tamb√©m n√£o est√° capturando a din√¢mica de agrupamento dessas exce√ß√µes.
>
> üí° **Tabela Comparativa:** Para clareza, podemos resumir os resultados numa tabela:
>
> | Teste                 | Estat√≠stica | Valor Cr√≠tico (5%) | Resultado        |
> |-----------------------|-------------|--------------------|------------------|
> | $LR_{uc}$             | 7.56        | 3.841              | Rejeita H0       |
> | $LR_{ind}$            | 5.52        | 3.841              | Rejeita H0       |
> | $LR_{cc}$             | 13.08       | 5.991              | Rejeita H0       |
>
> Essa tabela mostra claramente que ambos os testes individuais ($LR_{uc}$ e $LR_{ind}$) e o teste combinado ($LR_{cc}$) indicam que o modelo de VaR n√£o √© adequado.

**Proposi√ß√£o 10**: Em vez de confiar na aproxima√ß√£o assint√≥tica da distribui√ß√£o $\chi^2$, pode-se recorrer a testes de hip√≥tese baseados em simula√ß√£o ou reamostragem. Por exemplo, em vez de comparar as estat√≠sticas $LR_{ind}$ e $LR_{cc}$ com os valores cr√≠ticos de $\chi^2$, pode-se utilizar testes de permuta√ß√£o, nos quais as estat√≠sticas s√£o recalculadas em amostras aleat√≥rias permutadas dos dados originais. Desta forma, a distribui√ß√£o de probabilidade da estat√≠stica sob a hip√≥tese nula pode ser estimada sem fazer suposi√ß√µes sobre sua forma funcional, o que torna o teste mais robusto em amostras pequenas.

**Observa√ß√£o 17:** Uma limita√ß√£o do teste de Christoffersen √© que ele avalia a depend√™ncia temporal das exce√ß√µes apenas considerando a defasagem de um dia. Extens√µes do teste podem ser constru√≠das para avaliar depend√™ncias de ordem superior, utilizando tabelas de transi√ß√£o que consideram mais de um dia anterior. Estas extens√µes s√£o particularmente relevantes em situa√ß√µes onde a din√¢mica de risco exibe padr√µes temporais mais complexos.

**Proposi√ß√£o 11**: Uma extens√£o natural do teste de Christoffersen para depend√™ncia serial de ordem superior pode ser obtida considerando tabelas de transi√ß√£o que envolvem mais de um per√≠odo anterior. Por exemplo, podemos definir $T_{ijk}$ como o n√∫mero de vezes que o estado $k$ ocorre no dia atual, dado que os estados nos dois dias anteriores foram $i$ e $j$, respectivamente. Uma estat√≠stica $LR$ semelhante √† $LR_{ind}$ pode ser constru√≠da para testar a hip√≥tese nula de que a ocorr√™ncia de uma exce√ß√£o n√£o depende dos dois dias anteriores. Esta extens√£o leva a testes mais robustos quando existem depend√™ncias temporais mais complexas.

**Lema 11.1**: A estat√≠stica LR para depend√™ncia serial de ordem superior, com m defasagens, seguir√° assintoticamente uma distribui√ß√£o $\chi^2$ com $2^{m}-1$ graus de liberdade sob a hip√≥tese nula de independ√™ncia serial. Esta generaliza√ß√£o da estat√≠stica $LR_{ind}$ permite que o teste de Christoffersen seja adaptado para modelos com depend√™ncias temporais mais complexas.

**Prova do Lema 11.1**
Provaremos que a estat√≠stica LR para depend√™ncia serial de ordem superior, com m defasagens, segue assintoticamente uma distribui√ß√£o $\chi^2$ com $2^m - 1$ graus de liberdade sob a hip√≥tese nula de independ√™ncia serial.

I.  Considere um modelo com *m* defasagens. Isso significa que o estado atual (exce√ß√£o ou n√£o exce√ß√£o) depende dos estados dos *m* dias anteriores. Cada dia pode ter dois estados (exce√ß√£o ou n√£o exce√ß√£o), portanto, existem $2^m$ poss√≠veis combina√ß√µes de estados nos *m* dias anteriores.

II. Sob a hip√≥tese nula de independ√™ncia serial, a probabilidade de uma exce√ß√£o √© constante e igual a $\pi$ para todos os per√≠odos.

III. Sob a hip√≥tese alternativa de depend√™ncia serial, a probabilidade de uma exce√ß√£o depende dos estados dos *m* dias anteriores. Portanto, teremos $2^m$ probabilidades condicionais, uma para cada combina√ß√£o poss√≠vel de estados.

IV. O modelo com depend√™ncia serial tem $2^m$ par√¢metros (as probabilidades condicionais), enquanto o modelo sob a hip√≥tese nula tem apenas 1 par√¢metro (a probabilidade incondicional $\pi$).

V. A diferen√ßa no n√∫mero de par√¢metros entre o modelo com depend√™ncia e o modelo sem depend√™ncia (hip√≥tese nula) √© $2^m - 1$.

VI. Pela teoria assint√≥tica dos testes de raz√£o de verossimilhan√ßa, a estat√≠stica LR segue uma distribui√ß√£o assint√≥tica qui-quadrado ($\chi^2$) com graus de liberdade iguais √† diferen√ßa no n√∫mero de par√¢metros.

VII. Portanto, a estat√≠stica LR para depend√™ncia serial de ordem superior com *m* defasagens segue assintoticamente uma distribui√ß√£o $\chi^2$ com $2^m - 1$ graus de liberdade sob a hip√≥tese nula de independ√™ncia serial.‚ñ†

> üí° **Exemplo Num√©rico - Ordem Superior:** Vamos considerar o caso de duas defasagens (m=2). Ter√≠amos ent√£o 4 estados poss√≠veis:
>
> *   $T_{000}$: N√£o exce√ß√£o ontem e anteontem, seguido por n√£o exce√ß√£o hoje
> *   $T_{001}$: N√£o exce√ß√£o ontem e anteontem, seguido por exce√ß√£o hoje
> *   $T_{010}$: N√£o exce√ß√£o ontem, exce√ß√£o anteontem, seguido por n√£o exce√ß√£o hoje
> *   $T_{011}$: N√£o exce√ß√£o ontem, exce√ß√£o anteontem, seguido por exce√ß√£o hoje
> *   $T_{100}$: Exce√ß√£o ontem, n√£o exce√ß√£o anteontem, seguido por n√£o exce√ß√£o hoje
> *   $T_{101}$: Exce√ß√£o ontem, n√£o exce√ß√£o anteontem, seguido por exce√ß√£o hoje
> *   $T_{110}$: Exce√ß√£o ontem e anteontem, seguido por n√£o exce√ß√£o hoje
> *   $T_{111}$: Exce√ß√£o ontem e anteontem, seguido por exce√ß√£o hoje
>
> A estat√≠stica LR para m=2,  ser√° comparada com uma $\chi^2(2^2-1)=\chi^2(3)$.
>
>
> Digamos que, em uma amostra, observamos as seguintes contagens (para fins ilustrativos):
> *   $T_{000} = 180$, $T_{001} = 5$, $T_{010} = 10$, $T_{011} = 2$, $T_{100} = 15$, $T_{101} = 3$, $T_{110} = 5$, $T_{111} = 2$.
>
> Para calcular as probabilidades condicionais sob a hip√≥tese alternativa, usar√≠amos:
>
> *   $\pi_{00} = T_{001} / (T_{000} + T_{001}) = 5 / 185 \approx 0.027$
> *   $\pi_{01} = T_{011} / (T_{010} + T_{011}) = 2 / 12 \approx 0.167$
> *   $\pi_{10} = T_{101} / (T_{100} + T_{101}) = 3 / 18 \approx 0.167$
> *   $\pi_{11} = T_{111} / (T_{110} + T_{111}) = 2 / 7 \approx 0.286$
>
> A estat√≠stica $LR$ neste caso seria:
>
> $$
> LR = - 2 \ln \left[ (1 - \pi)^{\sum_{i,j,k} T_{ijk}} \pi^{\sum_{i,j,k} T_{ijk} \mathbb{I}(k=1)} \right] + 2 \ln \left[ \prod_{i,j} (1 - \pi_{ij})^{T_{ij0}} \pi_{ij}^{T_{ij1}} \right]
> $$
>
> Onde $\pi$ √© a probabilidade incondicional da exce√ß√£o, e $\mathbb{I}$ √© a fun√ß√£o indicadora que vale 1 se o argumento √© verdadeiro e 0 caso contr√°rio.
>
>
> Calculando o valor:
>
> $\pi = (5 + 2 + 3 + 2) / (180 + 5 + 10 + 2 + 15 + 3 + 5 + 2) = 12/222 \approx 0.054$.
>
>
>
>  $$
> LR = -2 \ln[(1-0.054)^{210}(0.054)^{12}] + 2\ln[(1-0.027)^{180}(0.027)^5 (1-0.167)^{10}(0.167)^2 (1-0.167)^{15}(0.167)^3 (1-0.286)^5(0.286)^2 ]
>  $$
> $$
>  LR \approx 13.5
> $$
>
> O valor cr√≠tico da distribui√ß√£o $\chi^2(3)$ a um n√≠vel de signific√¢ncia de 5% √© 7.815. Como $13.5 > 7.815$, rejeitamos a hip√≥tese nula de que as exce√ß√µes s√£o independentes das duas defasagens anteriores. Este exemplo ilustra como o teste pode ser generalizado para verificar depend√™ncias de ordem superior.

**Proposi√ß√£o 12**: Al√©m da extens√£o para ordens superiores, outra modifica√ß√£o interessante do teste de Christoffersen √© a inclus√£o de vari√°veis explicativas. Em vez de apenas considerar a ocorr√™ncia de exce√ß√µes passadas, podemos condicionar a probabilidade de uma exce√ß√£o em vari√°veis macroecon√¥micas ou financeiras que possam afetar o risco. Isso pode levar a um modelo mais preciso de *conditional coverage*, uma vez que incorpora informa√ß√µes adicionais que podem ser preditivas do comportamento das exce√ß√µes. Esta abordagem √© semelhante a modelos de risco din√¢micos, nos quais os par√¢metros do modelo mudam com o tempo.

**Teorema 12.1:** A inclus√£o de vari√°veis explicativas no teste de Christoffersen pode ser formalizada por meio de um modelo de regress√£o log√≠stica, onde a probabilidade de uma exce√ß√£o √© modelada como uma fun√ß√£o log√≠stica de um conjunto de vari√°veis explicativas, tanto defasadas quanto contempor√¢neas. O teste de raz√£o de verossimilhan√ßa resultante compara a verossimilhan√ßa do modelo com vari√°veis explicativas com a verossimilhan√ßa do modelo sem vari√°veis explicativas, permitindo testar a signific√¢ncia estat√≠stica dessas vari√°veis na previs√£o das exce√ß√µes.

### Conclus√£o
Em resumo, o teste de Christoffersen representa uma ferramenta essencial para a valida√ß√£o de modelos de VaR, pois estende o teste $LR_{uc}$ para avaliar a independ√™ncia serial das exce√ß√µes. A estat√≠stica $LR_{ind}$ permite verificar se as exce√ß√µes ocorrem de forma aleat√≥ria ou se agrupam no tempo, enquanto a estat√≠stica $LR_{cc}$ combina essa informa√ß√£o com a an√°lise da *unconditional coverage*, fornecendo uma avalia√ß√£o abrangente da adequa√ß√£o do modelo de risco. O uso desse teste garante que os modelos de VaR sejam n√£o apenas calibrados corretamente, mas tamb√©m capazes de capturar a din√¢mica de risco de forma adequada.  A rejei√ß√£o da hip√≥tese nula, seja pela estat√≠stica $LR_{ind}$ ou $LR_{cc}$, leva a um exame mais detalhado do modelo, e possivelmente √† ado√ß√£o de um modelo mais sofisticado que inclua depend√™ncias temporais, tais como modelos GARCH, ou a mudan√ßa dos par√¢metros ou metodologia do modelo.

### Refer√™ncias
[^1]: Cap√≠tulo 6 do texto fornecido.
<!-- END -->
