## Parametric Value at Risk (VAR) and the Cutoff Return

### IntroduÃ§Ã£o
Este capÃ­tulo aprofunda a metodologia paramÃ©trica para o cÃ¡lculo do **Value at Risk (VAR)**, construindo sobre o conceito jÃ¡ introduzido de que o VAR pode ser derivado tanto da distribuiÃ§Ã£o empÃ­rica quanto por aproximaÃ§Ãµes paramÃ©tricas [^1]. Em particular, focamos na relaÃ§Ã£o entre o valor de corte do portfÃ³lio ($W^*$) e o retorno de corte ($R^*$), e como este Ãºltimo se relaciona com um desvio padrÃ£o normal ($\alpha$). Exploraremos como essa estrutura permite calcular o VAR usando a distribuiÃ§Ã£o normal padrÃ£o e os parÃ¢metros de um portfÃ³lio, expandindo o conhecimento prÃ©vio sobre o tema.

### Conceitos Fundamentais

Como vimos anteriormente, a abordagem paramÃ©trica do VAR se baseia na suposiÃ§Ã£o de que os retornos do portfÃ³lio seguem uma distribuiÃ§Ã£o conhecida, como a distribuiÃ§Ã£o normal [^6]. Esta premissa permite simplificar o cÃ¡lculo do VAR, derivando-o diretamente do desvio padrÃ£o do portfÃ³lio atravÃ©s de um fator multiplicativo associado ao nÃ­vel de confianÃ§a desejado. Para realizar essa simplificaÃ§Ã£o, traduzimos a distribuiÃ§Ã£o geral dos retornos *$f(w)$* em uma distribuiÃ§Ã£o normal padrÃ£o *$\Phi(\epsilon)$*, onde *$\epsilon$* tem mÃ©dia zero e desvio padrÃ£o igual a um [^6].

Central para essa transformaÃ§Ã£o Ã© o conceito de um **valor de corte do portfÃ³lio** (*$W^*$*), que representa o pior valor possÃ­vel do portfÃ³lio em um determinado nÃ­vel de confianÃ§a. Este valor de corte estÃ¡ associado ao **retorno de corte** (*$R^*$*), com a relaÃ§Ã£o $W^* = W_0(1+R^*)$, onde $W_0$ Ã© o investimento inicial [^6]. Ã‰ importante notar que o retorno de corte *$R^*$* geralmente Ã© negativo, representando uma perda no valor do portfÃ³lio, e pode ser escrito como -|$R^*$|[6].

AlÃ©m disso, o retorno de corte (*$R^*$*) pode ser associado a um desvio normal padrÃ£o (*$\alpha$* > 0) atravÃ©s da seguinte relaÃ§Ã£o [^6]:

$$-\alpha = \frac{-|R^*| - \mu}{\sigma}$$

Onde *$\mu$* e *$\sigma$* sÃ£o, respectivamente, a mÃ©dia e o desvio padrÃ£o dos retornos do portfÃ³lio [^6]. Essa equaÃ§Ã£o estabelece uma ponte crucial entre os parÃ¢metros do portfÃ³lio e a distribuiÃ§Ã£o normal padrÃ£o, permitindo usar esta Ãºltima para calcular o VAR. Essa relaÃ§Ã£o pode ser reescrita como:

$$R^* = \mu - \alpha \sigma$$

Onde o retorno de corte R* depende da mÃ©dia ($\mu$), do desvio padrÃ£o ($\sigma$), e do desvio normal padrÃ£o ($\alpha$). Esta relaÃ§Ã£o Ã© fundamental para o cÃ¡lculo do VAR usando a distribuiÃ§Ã£o normal padrÃ£o, pois ela permite expressar o retorno de corte R* em termos de um quantil da distribuiÃ§Ã£o normal [Lema 1.1, Lema 1.2].

> ðŸ’¡ **Exemplo NumÃ©rico:** Suponha que um portfÃ³lio tenha um retorno mÃ©dio anual de $\mu = 0.10$ (10%) e um desvio padrÃ£o de $\sigma = 0.20$ (20%). Para um nÃ­vel de confianÃ§a de 95%, o valor de $\alpha$ Ã© aproximadamente 1.645 (como explicado later). O retorno de corte *$R^*$* Ã© entÃ£o calculado como:
>
> $R^* = 0.10 - 1.645 \times 0.20 = 0.10 - 0.329 = -0.229$
>
> Isso significa que, com 95% de confianÃ§a, a perda mÃ¡xima esperada do portfÃ³lio Ã© de 22.9% do investimento inicial.

**Lema 1.1** *O retorno de corte R* Ã© uma funÃ§Ã£o linear dos parÃ¢metros da distribuiÃ§Ã£o normal de retornos, dado pela sua mÃ©dia $\mu$ e desvio padrÃ£o $\sigma$, e o desvio padrÃ£o normal $\alpha$, que representa o quantil correspondente ao nÃ­vel de confianÃ§a desejado.*

*Prova:*
I. A relaÃ§Ã£o $R^* = \mu - \alpha \sigma$ expressa diretamente que $R^*$ Ã© uma combinaÃ§Ã£o linear de $\mu$ e $\sigma$.
II. O termo $\alpha$ atua como um fator de escala para o desvio padrÃ£o, e o resultado Ã© subtraÃ­do do retorno mÃ©dio $\mu$.
III. Portanto, $R^*$ Ã© uma funÃ§Ã£o linear de $\mu$ e $\sigma$. $\blacksquare$

**Lema 1.2** *O valor de $\alpha$ corresponde ao quantil da distribuiÃ§Ã£o normal padrÃ£o associado ao nÃ­vel de confianÃ§a c, tal que $1-c = \int_{-\infty}^{-\alpha} \Phi(\epsilon)d\epsilon$.*

*Prova:*
I. Conforme definido nas referÃªncias, $\alpha$ Ã© o desvio normal padrÃ£o correspondente Ã  probabilidade $1-c$.
II. Isso significa que a probabilidade de que o valor aleatÃ³rio da distribuiÃ§Ã£o normal padrÃ£o seja menor que $-\alpha$ Ã© $1-c$.
III. Portanto, $-\alpha$ corresponde ao quantil de ordem $1-c$ da distribuiÃ§Ã£o normal padrÃ£o. $\blacksquare$

**Lema 2:** A probabilidade de que o valor do portfÃ³lio seja menor ou igual a *$W^*$* Ã© igual a 1-*c*, onde *c* Ã© o nÃ­vel de confianÃ§a. Isso pode ser expresso como $1-c = \int_{-\infty}^{W^*} f(w)dw$, que, por sua vez, Ã© equivalente a $1-c = \int_{-\infty}^{R^*} f(r)dr$, e por fim, $1-c = \int_{-\infty}^{-\alpha} \Phi(\epsilon)d\epsilon$ [^6].

*Prova:*
I. Por definiÃ§Ã£o, $1-c$ representa a probabilidade de que o valor do portfÃ³lio seja menor ou igual ao valor de corte *$W^*$*.
II. O lado esquerdo da igualdade, $1-c$, Ã© a probabilidade associada ao VAR, ou seja, a probabilidade de perda que nÃ£o Ã© excedida com a confianÃ§a *c*.
III. O primeiro integral, $\int_{-\infty}^{W^*} f(w)dw$, representa a probabilidade cumulativa atÃ© *$W^*$* na distribuiÃ§Ã£o geral *$f(w)$*.
IV. O segundo integral, $\int_{-\infty}^{R^*} f(r)dr$, representa a probabilidade cumulativa atÃ© o retorno de corte *$R^*$* na distribuiÃ§Ã£o dos retornos *$f(r)$*, que Ã© equivalente ao primeiro integral devido Ã  relaÃ§Ã£o entre *$W^*$* e *$R^*$*.
V. O terceiro integral, $\int_{-\infty}^{-\alpha} \Phi(\epsilon)d\epsilon$, representa a probabilidade cumulativa atÃ© -*$\alpha$* na distribuiÃ§Ã£o normal padrÃ£o *$\Phi(\epsilon)$*. Esta equivalÃªncia Ã© alcanÃ§ada atravÃ©s da transformaÃ§Ã£o da distribuiÃ§Ã£o de retorno para a normal padrÃ£o.
VI. Portanto, $1-c = \int_{-\infty}^{W^*} f(w)dw = \int_{-\infty}^{R^*} f(r)dr = \int_{-\infty}^{-\alpha} \Phi(\epsilon)d\epsilon$. $\blacksquare$

Essa equivalÃªncia Ã© crucial, pois permite que o cÃ¡lculo do VAR seja realizado no domÃ­nio da distribuiÃ§Ã£o normal padrÃ£o, onde as propriedades estatÃ­sticas sÃ£o bem conhecidas e tabeladas. Em outras palavras, encontrar o VAR se reduz a encontrar o desvio *$\alpha$* tal que a Ã¡rea Ã  esquerda dele na distribuiÃ§Ã£o normal padrÃ£o seja igual a 1-*c*. [^7]

**Teorema 3:** *Dado um nÃ­vel de confianÃ§a c, o Value at Risk (VAR) paramÃ©trico pode ser calculado como a perda potencial mÃ¡xima que nÃ£o serÃ¡ excedida com probabilidade c, e Ã© definido como a diferenÃ§a entre o valor inicial do portfÃ³lio W0 e o valor de corte do portfÃ³lio W*, ou seja, $VAR = W_0 - W^*$. Usando a relaÃ§Ã£o $W^* = W_0(1+R^*)$, podemos expressar o VAR em funÃ§Ã£o do retorno de corte R*, como $VAR = -W_0 R^*$. Substituindo R*, temos $VAR = W_0(\alpha\sigma - \mu)$.*

*Prova:*
I. Pela definiÃ§Ã£o de VAR, temos que $VAR = W_0 - W^*$.
II. Substituindo $W^*$ por $W_0(1+R^*)$, obtemos $VAR = W_0 - W_0(1+R^*) = -W_0 R^*$.
III. Usando a relaÃ§Ã£o $R^* = \mu - \alpha \sigma$, chegamos a $VAR = -W_0(\mu - \alpha \sigma) = W_0(\alpha\sigma - \mu)$. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:** Continuando o exemplo anterior, suponha que o investimento inicial seja $W_0 = 1000$. Usando o retorno de corte calculado anteriormente ($R^* = -0.229$), o VAR Ã©:
>
> $VAR = -1000 \times (-0.229) = 229$
>
> Assim, o VAR Ã© de 229, indicando que a perda mÃ¡xima esperada com 95% de confianÃ§a Ã© de \$229. Usando a fÃ³rmula direta do Teorema 3:
>
> $VAR = 1000 \times (1.645 \times 0.20 - 0.10) = 1000 \times (0.329 - 0.10) = 1000 \times 0.229 = 229$
>
> Ambas as abordagens fornecem o mesmo valor de VAR.

**Teorema 3.1:** *O VAR pode ser expresso como uma funÃ§Ã£o linear do desvio padrÃ£o do portfÃ³lio, ajustada pela mÃ©dia do retorno.*

*Prova:*
I. Do Teorema 3, temos que $VAR = W_0(\alpha\sigma - \mu)$.
II. Considerando que $W_0$, $\alpha$ (para um dado nÃ­vel de confianÃ§a) e $\mu$ sÃ£o constantes para um dado portfÃ³lio, podemos escrever $VAR = k_1 \sigma + k_2$ , onde $k_1 = W_0\alpha$ e $k_2=-W_0\mu$.
III. Portanto, o VAR Ã© uma funÃ§Ã£o linear de $\sigma$. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:** Mantendo $W_0 = 1000$ e $\alpha=1.645$, e supondo um $\mu=0.05$, podemos variar o desvio padrÃ£o $\sigma$ para ver como o VAR muda.
>
> Para $\sigma=0.10$: $VAR = 1000(1.645 * 0.10 - 0.05) = 1000(0.1645 - 0.05) = 114.5$
> Para $\sigma=0.20$: $VAR = 1000(1.645 * 0.20 - 0.05) = 1000(0.329 - 0.05) = 279$
> Para $\sigma=0.30$: $VAR = 1000(1.645 * 0.30 - 0.05) = 1000(0.4935 - 0.05) = 443.5$
>
> Podemos observar a relaÃ§Ã£o linear entre $\sigma$ e o VAR.

**Teorema 3.2:** *Se o retorno mÃ©dio do portfÃ³lio $\mu$ for zero, o VAR se torna diretamente proporcional ao desvio padrÃ£o do portfÃ³lio.*

*Prova:*
I. Se $\mu=0$, entÃ£o a expressÃ£o para o VAR, $VAR = W_0(\alpha\sigma - \mu)$, se reduz a $VAR = W_0\alpha\sigma$.
II. Como $W_0$ e $\alpha$ sÃ£o constantes para um dado nÃ­vel de confianÃ§a, o VAR Ã© diretamente proporcional a $\sigma$. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:** Se $\mu = 0$ e $W_0=1000$ e $\alpha=1.645$, o VAR se torna diretamente proporcional a $\sigma$:
>
> Para $\sigma=0.10$: $VAR = 1000 * 1.645 * 0.10 = 164.5$
> Para $\sigma=0.20$: $VAR = 1000 * 1.645 * 0.20 = 329$
> Para $\sigma=0.30$: $VAR = 1000 * 1.645 * 0.30 = 493.5$
>
> Aqui podemos ver claramente a relaÃ§Ã£o de proporcionalidade direta, onde dobrar o desvio padrÃ£o tambÃ©m dobra o VAR.

Para uma dada probabilidade *p*, o desvio *$\alpha$* pode ser obtido atravÃ©s das tabelas da funÃ§Ã£o de distribuiÃ§Ã£o normal cumulativa (N(x)), ou equivalentemente, pela funÃ§Ã£o inversa da distribuiÃ§Ã£o normal padrÃ£o $N^{-1}(p)$, tal que $p = N(x) = \int_{-\infty}^x \Phi(\epsilon)d\epsilon$ [^7]. Em outras palavras, *$\alpha$* pode ser encontrado como o quantil da distribuiÃ§Ã£o normal padrÃ£o que corresponde Ã  probabilidade *p* [Lema 1.2].

> ðŸ’¡ **Exemplo NumÃ©rico:** Para um nÃ­vel de confianÃ§a de 95%, a probabilidade *p* correspondente Ã© 5% ou 0.05. Encontramos o quantil correspondente na tabela ou usando a funÃ§Ã£o inversa da distribuiÃ§Ã£o normal padrÃ£o (por exemplo, `scipy.stats.norm.ppf(0.05)` em Python). O valor obtido, *z_0.05*, Ã© aproximadamente -1.645. Portanto, *$\alpha$* = 1.645.
```python
import scipy.stats as st
alpha_negative = st.norm.ppf(0.05)
alpha = abs(alpha_negative)
print(f"The value of z for 0.05 is: {alpha_negative:.3f}")
print(f"The value of alpha is: {alpha:.3f}")
```

**ObservaÃ§Ã£o:** *Ã‰ importante notar que o valor de z obtido da funÃ§Ã£o inversa da distribuiÃ§Ã£o normal padrÃ£o, corresponde a $-\alpha$, e que para o cÃ¡lculo do VAR utilizamos o valor positivo de $\alpha$*

**Lema 3:** *A funÃ§Ã£o inversa da distribuiÃ§Ã£o normal padrÃ£o, $N^{-1}(p)$, retorna o valor do quantil correspondente Ã  probabilidade p, de tal forma que, se $x = N^{-1}(p)$, entÃ£o $p = N(x)$.*

*Prova:*
I. A funÃ§Ã£o inversa $N^{-1}(p)$ Ã© definida como a funÃ§Ã£o que, quando aplicada a uma probabilidade cumulativa *p*, retorna o valor *x* para o qual a Ã¡rea sob a curva de densidade normal padrÃ£o da esquerda atÃ© *x* Ã© igual a *p*.
II. Isso segue diretamente da definiÃ§Ã£o de funÃ§Ã£o inversa. $\blacksquare$

**Lema 3.1:** *A funÃ§Ã£o $N(x)$ Ã© uma funÃ§Ã£o cumulativa nÃ£o decrescente, que varia de 0 a 1, ou seja, $0 \leq N(x) \leq 1$ para todo x, e $N(x_1) \leq N(x_2)$ para $x_1 \leq x_2$*

*Prova:*
I. A funÃ§Ã£o $N(x) = \int_{-\infty}^{x} \Phi(\epsilon)d\epsilon$ Ã© a integral da funÃ§Ã£o densidade normal padrÃ£o $\Phi(\epsilon)$, que Ã© nÃ£o negativa.
II. Como a integral de uma funÃ§Ã£o nÃ£o negativa Ã© nÃ£o decrescente, $N(x)$ Ã© nÃ£o decrescente.
III. AlÃ©m disso, como a integral sobre toda a reta real de $\Phi(\epsilon)$ Ã© 1, e a integral de $-\infty$ a um valor finito deve ser entre 0 e 1, $0 \leq N(x) \leq 1$. $\blacksquare$

A funÃ§Ã£o *N(x)* tambÃ©m Ã© fundamental no modelo de precificaÃ§Ã£o de opÃ§Ãµes de Black-Scholes, aumentando monotonicamente de 0 (quando *x* = -âˆž) para 1 (quando *x* = +âˆž) e passando por 0.5 quando *x* = 0 [^7].

**ProposiÃ§Ã£o 4:** *O desvio *$\alpha$* corresponde ao valor absoluto do quantil da distribuiÃ§Ã£o normal padrÃ£o associado ao nÃ­vel de confianÃ§a *c*. Ou seja, $\alpha = |N^{-1}(1-c)|$*

*Prova:*
I. Pelo lema 1.2, sabemos que $1-c = \int_{-\infty}^{-\alpha} \Phi(\epsilon)d\epsilon$.
II. Assim, $-\alpha$ Ã© o quantil correspondente Ã  probabilidade $1-c$, ou seja, $-\alpha = N^{-1}(1-c)$.
III. Como $\alpha$ Ã© definido como um valor positivo, temos que $\alpha = |N^{-1}(1-c)|$. $\blacksquare$

**ProposiÃ§Ã£o 4.1:** *O desvio $\alpha$ pode ser interpretado como o nÃºmero de desvios padrÃµes que o retorno de corte estÃ¡ abaixo da mÃ©dia do retorno do portfÃ³lio, em termos da distribuiÃ§Ã£o normal padrÃ£o.*

*Prova:*
I. Da relaÃ§Ã£o $R^* = \mu - \alpha \sigma$, temos que $\alpha = \frac{\mu - R^*}{\sigma}$.
II. Como $R^*$ Ã© tipicamente menor que $\mu$, a quantidade $\mu - R^*$ Ã© positiva, e representa a distÃ¢ncia entre a mÃ©dia e o retorno de corte.
III. Dividindo essa distÃ¢ncia pelo desvio padrÃ£o $\sigma$, obtemos o nÃºmero de desvios padrÃµes dessa distÃ¢ncia, que corresponde a $\alpha$. $\blacksquare$

> ðŸ’¡ **Exemplo NumÃ©rico:** Usando novamente o exemplo do portfÃ³lio com $\mu = 0.10$, $\sigma = 0.20$, e $R^* = -0.229$ com um nÃ­vel de confianÃ§a de 95% $\alpha$ pode ser interpretado como:
>
> $\alpha = \frac{0.10 - (-0.229)}{0.20} = \frac{0.329}{0.20} = 1.645$
>
> Isso confirma que o retorno de corte estÃ¡ aproximadamente 1.645 desvios padrÃµes abaixo da mÃ©dia do retorno.

A partir do desvio *$\alpha$*, podemos calcular o retorno de corte *$R^*$*:

$$R^* = -\alpha\sigma + \mu$$

Essa expressÃ£o nos permite obter o retorno de corte utilizando o desvio padrÃ£o *$\alpha$* e os parÃ¢metros da distribuiÃ§Ã£o de retornos.

### ConclusÃ£o
Este capÃ­tulo aprofundou a relaÃ§Ã£o entre o valor de corte do portfÃ³lio (*$W^*$*) e o retorno de corte (*$R^*$*), mostrando como este Ãºltimo pode ser associado ao desvio normal padrÃ£o (*$\alpha$*), crucial para o cÃ¡lculo do VAR paramÃ©trico. A equivalÃªncia entre as integrais, demonstrada no Lema 2, permite utilizar as propriedades da distribuiÃ§Ã£o normal padrÃ£o para calcular o VAR. Essa abordagem oferece uma forma mais eficiente de calcular o VAR quando comparada Ã  abordagem nÃ£o paramÃ©trica, principalmente quando o nÃºmero de observaÃ§Ãµes Ã© limitado. AlÃ©m disso, foi detalhado o papel da funÃ§Ã£o de distribuiÃ§Ã£o normal cumulativa (N(x)) tanto na estimaÃ§Ã£o do VAR quanto no modelo de precificaÃ§Ã£o de opÃ§Ãµes de Black-Scholes. A conexÃ£o entre todos esses conceitos Ã© fundamental para a compreensÃ£o e aplicaÃ§Ã£o do VAR paramÃ©trico. A partir disso, podemos calcular o VAR relativo Ã  mÃ©dia, e tambÃ©m o VAR absoluto, e como o uso de cada uma dessas medidas pode afetar os resultados da anÃ¡lise de risco.

### ReferÃªncias
[^1]: *Section 5.1 shows how to derive VAR as a summary statistic of the entire probability density function of profits and losses. This can be done in two basic ways, either by considering the actual empirical distribution or by using a parametric approximation, such as the normal distribution. In the first case, VAR is derived from the sample quantile; in the second, from the standard deviation.*
[^6]: *The VAR computation can be simplified considerably if the distribution can be assumed to belong to a parametric family, such as the normal distribution. When this is the case, the VAR figure can be derived directly from the portfolio standard deviation using a multiplicative factor that depends on the confidence level. This approach is called parametric because it involves estimation of parameters, such as the standard deviation, instead of just reading the quantile off the empirical distribution. Say that we pick a normal distribution to fit the data. First, we need to translate the general distribution f(w) into a standard normal distribution Î¦(Îµ), where e has mean zero and standard deviation of unity. We associate W* with the cutoff return R* such that W*=Wo (1+R*). Generally, R* is negative and can be written as -|R*|. Further, we can associate R* with a standard normal deviate a > 0 by setting -Î± =  (-|R*|-Î¼)/Ïƒ. It is equivalent to set 1-c = âˆ«-âˆžW* f(w)dw = âˆ«-âˆžR* f(r)dr = âˆ«-âˆž-Î± Î¦(Îµ)dÎµ*
[^7]: *Thus the problem of finding VAR is equivalent to finding the deviate a such that the area to the left of it is equal to 1 â€“ c. For a defined probability p, the deviate a can be found from tables of the cumulative standard normal distribution function, that is, p = N(x) = âˆ«-âˆžx Î¦(Îµ)dÎµ. This function also plays a key role in the Black-Scholes option pricing model. It increases monotonically from 0 (for x = -âˆž) to 1 (for x = +âˆž), going through 0.5 as x passes through 0. From Table 4-2, the deviate that corresponds to a one-tailed level of 95 percent is a = 1.645. We then retrace our steps, back from the a we just found to the cutoff return R* and VAR. From Equation (5.6), the cutoff return is R* = âˆ’Î±Ïƒ + Î¼*
